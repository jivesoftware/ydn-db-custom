(function (name, definition, context) {if (typeof context['module'] !== 'undefined' && context['module']['exports']) {context['module']['exports'] = definition.apply(context);}else if (typeof context['define'] !== 'undefined' && context['define'] === 'function' && context['define']['amd']) {define(name, [], definition);}else {context[name] = definition();}})('ydn', function () {var h,m=this;function q(a){return void 0!==a}
function aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function v(a){return"array"==aa(a)}function w(a){var b=aa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function ba(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function z(a){return"function"==aa(a)}function B(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ca="closure_uid_"+(1E9*Math.random()>>>0),da=0;
function ea(a,b,c){return a.call.apply(a.bind,arguments)}function fa(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ga(a,b,c){ga=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ea:fa;return ga.apply(null,arguments)}
function ha(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var ia=Date.now||function(){return+new Date};function ka(a,b){var c=a.split("."),d=m;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&q(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}
function C(a,b){function c(){}c.prototype=b.prototype;a.o=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.zb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function la(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function ma(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function E(a){if(Error.captureStackTrace)Error.captureStackTrace(this,E);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}C(E,Error);E.prototype.name="CustomError";var oa;function pa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}var qa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
function ra(a){if(!sa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ta,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ua,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(va,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(wa,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(xa,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(ya,"&#0;"));return a}
var ta=/&/g,ua=/</g,va=/>/g,wa=/"/g,xa=/'/g,ya=/\x00/g,sa=/[\x00&<>"']/,za={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Aa={"'":"\\'"};
function Ba(a){a=String(a);if(!a.quote){for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=c+1,g;if(!(g=za[d])){if(!(31<e&&127>e))if(d in Aa)d=Aa[d];else if(d in za)d=Aa[d]=za[d];else{e=d;g=d.charCodeAt(0);if(31<g&&127>g)e=d;else{if(256>g){if(e="\\x",16>g||256<g)e+="0"}else e="\\u",4096>g&&(e+="0");e+=g.toString(16).toUpperCase()}d=Aa[d]=e}g=d}b[f]=g}b.push('"')}}function Da(a,b){return a<b?-1:a>b?1:0};function Ea(a,b){b.unshift(a);E.call(this,pa.apply(null,b));b.shift()}C(Ea,E);Ea.prototype.name="AssertionError";function Fa(a,b){throw new Ea("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Ga=Array.prototype,F=Ga.indexOf?function(a,b,c){return Ga.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ha=Ga.forEach?function(a,b,c){Ga.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ja=Ga.map?function(a,b,c){return Ga.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ka=Ga.some?function(a,b,c){return Ga.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function La(a,b){var c=Ma(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}function Ma(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function Na(a){if(!v(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Oa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Pa(a,b){if(!w(a)||!w(b)||a.length!=b.length)return!1;for(var c=a.length,d=Qa,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function Qa(a,b){return a===b};var Ra;a:{var Sa=m.navigator;if(Sa){var Ta=Sa.userAgent;if(Ta){Ra=Ta;break a}}Ra=""}function G(a){return-1!=Ra.indexOf(a)};function Ua(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Va(a,b){for(var c=w(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],q(a));c++);return a}var Wa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Wa.length;f++)c=Wa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}
function Ya(a){var b=arguments.length;if(1==b&&v(arguments[0]))return Ya.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};function Za(a){m.setTimeout(function(){throw a;},0)}var $a;
function ab(){var a=m.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&(a=function(){var a=document.createElement("iframe");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=ga(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},
this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!G("Trident")&&!G("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(q(c.next)){c=c.next;var a=c.Ea;c.Ea=null;a()}};return function(a){d.next={Ea:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=
null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){m.setTimeout(a,0)}};function db(a,b){eb||fb();gb||(eb(),gb=!0);hb.push(new ib(a,b))}var eb;function fb(){if(m.Promise&&m.Promise.resolve){var a=m.Promise.resolve();eb=function(){a.then(jb)}}else eb=function(){var a=jb;!z(m.setImmediate)||m.Window&&m.Window.prototype.setImmediate==m.setImmediate?($a||($a=ab()),$a(a)):m.setImmediate(a)}}var gb=!1,hb=[];[].push(function(){gb=!1;hb=[]});function jb(){for(;hb.length;){var a=hb;hb=[];for(var b=0;b<a.length;b++){var c=a[b];try{c.a.call(c.b)}catch(d){Za(d)}}}gb=!1}
function ib(a,b){this.a=a;this.b=b};function kb(a,b){this.b=lb;this.f=void 0;this.a=this.e=null;this.c=this.d=!1;try{var c=this;a.call(b,function(a){mb(c,nb,a)},function(a){try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}mb(c,ob,a)})}catch(d){mb(this,ob,d)}}var lb=0,nb=2,ob=3;kb.prototype.then=function(a,b,c){return pb(this,z(a)?a:null,z(b)?b:null,c)};la(kb);function qb(a,b){a.a&&a.a.length||a.b!=nb&&a.b!=ob||rb(a);a.a||(a.a=[]);a.a.push(b)}
function pb(a,b,c,d){var e={ha:null,Ia:null,Ja:null};e.ha=new kb(function(a,g){e.Ia=b?function(c){try{var e=b.call(d,c);a(e)}catch(n){g(n)}}:a;e.Ja=c?function(b){try{var e=c.call(d,b);a(e)}catch(n){g(n)}}:g});e.ha.e=a;qb(a,e);return e.ha}kb.prototype.g=function(a){this.b=lb;mb(this,nb,a)};kb.prototype.i=function(a){this.b=lb;mb(this,ob,a)};
function mb(a,b,c){if(a.b==lb){if(a==c)b=ob,c=new TypeError("Promise cannot resolve to itself");else{if(ma(c)){a.b=1;c.then(a.g,a.i,a);return}if(B(c))try{var d=c.then;if(z(d)){sb(a,c,d);return}}catch(e){b=ob,c=e}}a.f=c;a.b=b;rb(a);b!=ob||tb(a,c)}}function sb(a,b,c){function d(b){f||(f=!0,a.i(b))}function e(b){f||(f=!0,a.g(b))}a.b=1;var f=!1;try{c.call(b,e,d)}catch(g){d(g)}}function rb(a){a.d||(a.d=!0,db(a.j,a))}
kb.prototype.j=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;b++){var c=a[b],d=this.f;if(this.b==nb)c.Ia(d);else{if(c.ha)for(var e=void 0,e=this;e&&e.c;e=e.e)e.c=!1;c.Ja(d)}}}this.d=!1};function tb(a,b){a.c=!0;db(function(){a.c&&ub.call(null,b)})}var ub=Za;/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function H(a,b){this.g=[];this.L=b||null;this.b=this.c=!1;this.d=void 0;this.M=this.v=this.i=!1;this.e=0;this.f=null;this.D=0}h=H.prototype;h.ja=function(a,b){this.i=!1;vb(this,a,b)};function vb(a,b,c){a.c=!0;a.d=c;a.b=!b;a.xa()}function wb(a){if(a.c){if(!a.M)throw new xb;a.M=!1}}h.callback=function(a){wb(this);vb(this,!0,a)};h.l=function(a){wb(this);vb(this,!1,a)};h.H=function(a,b){return yb(this,a,null,b)};h.Qa=function(a,b){return yb(this,null,a,b)};h.Da=function(a,b){return yb(this,a,a,b)};
function yb(a,b,c,d){a.g.push([b,c,d]);a.c&&a.xa();return a}h.then=function(a,b,c){var d,e,f=new kb(function(a,b){d=a;e=b});yb(this,d,function(a){e(a)});return f.then(a,b,c)};la(H);function zb(a){return Ka(a.g,function(a){return z(a[1])})}
H.prototype.xa=function(){this.e&&this.c&&zb(this)&&(Ab(this.e),this.e=0);this.f&&(this.f.D--,delete this.f);for(var a=this.d,b=!1,c=!1;this.g.length&&!this.i;){var d=this.g.shift(),e=d[0],f=d[1],d=d[2];if(e=this.b?f:e)try{var g=e.call(d||this.L,a);q(g)&&(this.b=this.b&&(g==a||g instanceof Error),this.d=a=g);ma(a)&&(this.i=c=!0)}catch(k){a=k,this.b=!0,zb(this)||(b=!0)}}this.d=a;c&&(c=ga(this.ja,this,!0),g=ga(this.ja,this,!1),a instanceof H?(yb(a,c,g),a.v=!0):a.then(c,g));b&&(a=new Bb(a),Cb[a.ma]=
a,this.e=a.ma)};function Db(a){var b=new H;b.callback(a);return b}function xb(){E.call(this)}C(xb,E);xb.prototype.message="Deferred has already fired";xb.prototype.name="AlreadyCalledError";function Bb(a){this.ma=m.setTimeout(ga(this.b,this),0);this.a=a}Bb.prototype.b=function(){delete Cb[this.ma];throw this.a;};var Cb={};function Ab(a){var b=Cb[a];b&&(m.clearTimeout(b.ma),delete Cb[a])};function I(a){E.call(this,a);this.name="ydn.error.ArgumentException"}C(I,E);function Eb(a){E.call(this,a);this.name="ydn.error.TypeError"}C(Eb,E);function Fb(a){E.call(this,a);this.name="ydn.error.NotSupportedException"}C(Fb,E);function Gb(a){E.call(this,a);this.name="ydn.error.NotImplementedException"}C(Gb,E);function Hb(a){E.call(this,a);this.name="ydn.error.InvalidOperationException"}C(Hb,E);
function Ib(a){Error.captureStackTrace?Error.captureStackTrace(this,Ib):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Ib,Error);Ib.prototype.name="ydn.error.InternalError";var Jb="StopIteration"in m?m.StopIteration:Error("StopIteration");function Kb(){}Kb.prototype.next=function(){throw Jb;};Kb.prototype.X=function(){return this};function Lb(a){if(a instanceof Kb)return a;if("function"==typeof a.X)return a.X(!1);if(w(a)){var b=0,c=new Kb;c.next=function(){for(;;){if(b>=a.length)throw Jb;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function Mb(a,b,c){if(w(a))try{Ha(a,b,c)}catch(d){if(d!==Jb)throw d;}else{a=Lb(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(e){if(e!==Jb)throw e;}}}function Nb(a){if(w(a))return Oa(a);a=Lb(a);var b=[];Mb(a,function(a){b.push(a)});return b};function Ob(a,b){this.b={};this.a=[];this.d=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)Pb(this,arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof Ob)e=a.la(),d=a.Fa();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)Pb(this,e[c],d[c])}}h=Ob.prototype;h.Fa=function(){Qb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};
h.la=function(){Qb(this);return this.a.concat()};h.clear=function(){this.b={};this.d=this.c=this.a.length=0};function Qb(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Object.prototype.hasOwnProperty.call(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Object.prototype.hasOwnProperty.call(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}
function Pb(a,b,c){Object.prototype.hasOwnProperty.call(a.b,b)||(a.c++,a.a.push(b),a.d++);a.b[b]=c}h.forEach=function(a,b){for(var c=this.la(),d=0;d<c.length;d++){var e=c[d];a.call(b,Object.prototype.hasOwnProperty.call(this.b,e)?this.b[e]:void 0,e,this)}};h.clone=function(){return new Ob(this)};
h.X=function(a){Qb(this);var b=0,c=this.a,d=this.b,e=this.d,f=this,g=new Kb;g.next=function(){for(;;){if(e!=f.d)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw Jb;var g=c[b++];return a?g:d[g]}};return g};var Rb=G("Opera")||G("OPR"),Sb=G("Trident")||G("MSIE"),Tb=G("Gecko")&&-1==Ra.toLowerCase().indexOf("webkit")&&!(G("Trident")||G("MSIE")),Ub=-1!=Ra.toLowerCase().indexOf("webkit");Ub&&G("Mobile");G("Macintosh");G("Windows");G("Linux");var Vb=m.navigator||null;Vb&&(Vb.appVersion||"").indexOf("X11");G("Android");!G("iPhone")||G("iPod")||G("iPad");G("iPad");function Wb(){var a=m.document;return a?a.documentMode:void 0}
var Xb=function(){var a="",b;if(Rb&&m.opera)return a=m.opera.version,z(a)?a():a;Tb?b=/rv\:([^\);]+)(\)|;)/:Sb?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Ub&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(Ra))?a[1]:"");return Sb&&(b=Wb(),b>parseFloat(a))?String(b):a}(),Yb={};
function Zb(a){var b;if(!(b=Yb[a])){b=0;for(var c=qa(String(Xb)).split("."),d=qa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var t=l.exec(g)||["","",""],r=n.exec(k)||["","",""];if(0==t[0].length&&0==r[0].length)break;b=Da(0==t[1].length?0:parseInt(t[1],10),0==r[1].length?0:parseInt(r[1],10))||Da(0==t[2].length,0==r[2].length)||Da(t[2],r[2])}while(0==b)}b=Yb[a]=0<=b}return b}
var $b=m.document,ac=$b&&Sb?Wb()||("CSS1Compat"==$b.compatMode?parseInt(Xb,10):5):void 0;function bc(a){var b;b||(b=cc(a||arguments.callee.caller,[]));return b}
function cc(a,b){var c=[];if(0<=F(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(dc(a)+"(");for(var d=a.arguments,e=0;d&&e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=dc(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(cc(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function dc(a){if(ec[a])return ec[a];a=String(a);if(!ec[a]){var b=/function ([^\(]+)/.exec(a);ec[a]=b?b[1]:"[Anonymous]"}return ec[a]}var ec={};function fc(a,b,c,d,e){"number"==typeof e||gc++;this.f=d||ia();this.e=a;this.d=b;this.c=c;delete this.b;delete this.a}fc.prototype.b=null;fc.prototype.a=null;var gc=0;function hc(a){this.e=a;this.a=this.d=this.b=this.c=null}function ic(a,b){this.name=a;this.value=b}ic.prototype.toString=function(){return this.name};var jc=new ic("SHOUT",1200),kc=new ic("SEVERE",1E3),lc=new ic("WARNING",900),mc=new ic("INFO",800),nc=new ic("CONFIG",700),oc=new ic("FINE",500),pc=new ic("FINER",400),qc=new ic("FINEST",300),rc=[new ic("OFF",Infinity),jc,kc,lc,mc,nc,oc,pc,qc,new ic("ALL",0)],sc=null;hc.prototype.getName=function(){return this.e};
function tc(a){if(a.b)return a.b;if(a.c)return tc(a.c);Fa("Root logger has no level set.");return null}hc.prototype.log=function(a,b,c){if(a.value>=tc(this).value)for(z(b)&&(b=b()),a=this.f(a,b,c,hc.prototype.log),b="log:"+a.d,m.console&&(m.console.timeStamp?m.console.timeStamp(b):m.console.markTimeline&&m.console.markTimeline(b)),m.msWriteProfilerMark&&m.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=void 0;f=c.a[e];e++)f(d);b=b.c}};
hc.prototype.f=function(a,b,c,d){var e=new fc(a,String(b),this.e);if(c){var f;f=d||arguments.callee.caller;e.b=c;var g;try{var k;var l;c:{for(var n=["window","location","href"],t=m,r;r=n.shift();)if(null!=t[r])t=t[r];else{l=null;break c}l=t}if(x(c))k={message:c,name:"Unknown error",lineNumber:"Not available",fileName:l,stack:"Not available"};else{var p,u,n=!1;try{p=c.lineNumber||c.Ab||"Not available"}catch(A){p="Not available",n=!0}try{u=c.fileName||c.filename||c.sourceURL||m.$googDebugFname||l}catch(D){u=
"Not available",n=!0}k=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||"Not available",name:c.name||"UnknownError",lineNumber:p,fileName:u,stack:c.stack||"Not available"}}g="Message: "+ra(k.message)+'\nUrl: <a href="view-source:'+k.fileName+'" target="_new">'+k.fileName+"</a>\nLine: "+k.lineNumber+"\n\nBrowser stack:\n"+ra(k.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+ra(bc(f)+"-> ")}catch(ja){g="Exception trying to expose exception! You win, we lose. "+ja}e.a=g}return e};
var uc={},vc=null;function wc(){vc||(vc=new hc(""),uc[""]=vc,vc.b=nc)}function xc(){wc();return vc}function J(a){wc();var b;if(!(b=uc[a])){b=new hc(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=J(a.substr(0,c));c.d||(c.d={});c.d[d]=b;b.c=c;uc[a]=b}return b};function yc(a,b){a&&a.log(lc,b,void 0)}function zc(a,b){a&&a.log(oc,b,void 0)};function K(a,b){a&&a.log(qc,b,void 0)}function L(a,b){a&&a.log(pc,b,void 0)};function Ac(a,b){H.call(this,0,b);this.k=[]}C(Ac,H);Ac.prototype.Aa=function(a,b){this.k.push([a,b]);return this};Ac.prototype.callback=function(a){this.k.length=0;Ac.o.callback.call(this,a)};Ac.prototype.l=function(a){this.k.length=0;Ac.o.l.call(this,a)};Ac.prototype.Ba=function(){return this};var Bc={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},M=Bc.READ_ONLY,N=Bc.READ_WRITE,Cc=Bc.VERSION_CHANGE,Dc=m.indexedDB||m.mozIndexedDB||m.webkitIndexedDB||m.moz_indexedDB||m.msIndexedDB;H.prototype.done=H.prototype.H;H.prototype.fail=H.prototype.Qa;H.prototype.always=H.prototype.Da;Ac.prototype.then=Ac.prototype.then;function Ec(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=w(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],q(a));c++);return a}var Fc={};
function Gc(a){var b=[a];a=new Hc;for(var c=0,d,e;void 0!==(e=b.pop());){0===c%4&&12<c+4&&(a.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){b.push(Fc);for(d=e.length;d--;)b.push(e[d]);continue}else a.write(c);else if("number"===d)c+=1,a.write(c),Ic(a,e);else if(e instanceof Date)c+=2,a.write(c),Ic(a,e.valueOf());else if("string"===d){c+=3;a.write(c);c=a;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,
f>>2|255,(f|3)<<6)}c.write(0)}else if(e===Fc)a.write(0);else return"";c=0}for(b=a.a.length;"00"===a.a[--b];);a.a.length=++b;return a.toString()}
function Ic(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Kc(a){var b=Lc(a)|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=Lc(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(Lc(a)|0):Lc(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Mc(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=Lc(a);if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Nc(a){this.a=null;this.b=a;this.c=this.b.length-1;this.index=-1}function Lc(a){return a.a=a.index<a.c?parseInt(a.b.charAt(++a.index)+a.b.charAt(++a.index),16):null}
function Hc(){this.a=[];this.b=void 0}Hc.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};Hc.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Oc(a,b){var c=Gc(a),d=Gc(b);return c>d?1:c==d?0:-1};function Pc(a,b,c){Ac.call(this,0,c);this.r=a;this.k=[];this.j=[];this.pa=[];this.a=null;this.ba=""}C(Pc,Ac);h=Pc.prototype;h.ba="";h.logger=J("ydn.db.Request");function Qc(a,b,c){a.a=b;a.ba=c;L(a.logger,a+" BEGIN");if(b){for(c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b);a.j.length=0}}function Rc(a){L(a.logger,a+" END");a.a=null}h.Ra=function(){return!!this.a};
h.abort=function(){L(this.logger,this+" aborting "+this.a);if(this.a)if(z(this.a.abort))this.a.abort();else if(z(this.a.executeSql))this.a.executeSql("ABORT",[],function(){},function(){return!0});else throw new Fb;else throw new Sc(this+" No active transaction");};function O(a,b,c){var d=a.pa.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){O(a,b,c)}):c?a.l(b):a.callback(b)}function Tc(a,b,c){a.pa.push([b,c])}function P(a,b,c){a.a?b.call(c,a.a):a.j.push([b,c])}
h.callback=function(a){L(this.logger,this+" SUCCESS");Pc.o.callback.call(this,a)};h.l=function(a){L(this.logger,this+" ERROR");Pc.o.l.call(this,a)};h.state=function(){return this.c?this.b?"rejected":"resolved":"pending"};function Uc(a){var b="";a.ba&&(b=a.a?"*":"",b="["+a.ba+b+"]");return a.r+b}function Vc(a,b){var c=new Pc(a);O(c,b);return c}h.toString=function(){return"Request:"+Uc(this)};
h.xa=function(){this.e&&this.c&&zb(this)&&(Ab(this.e),this.e=0);this.f&&(this.f.D--,delete this.f);for(var a=this.d,b=!1;this.g.length&&!this.i;){var c=this.g.shift(),d=c[0],e=c[1],c=c[2];if(d=this.b?e:d)d=d.call(c||this.L,a),q(d)&&(this.b=this.b&&(d==a||d instanceof Error),this.d=a=d),ma(a)&&(this.i=b=!0)}this.d=a;b&&(b=ga(this.ja,this,!0),d=ga(this.ja,this,!1),a instanceof H?(yb(a,b,d),a.v=!0):a.then(b,d))};
h.toJSON=function(){var a=(this.ba||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.r?this.r.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var Q=Dc&&Dc.cmp?ga(Dc.cmp,Dc):Oc,Wc=[];function Xc(){0!=Yc&&(this[ca]||(this[ca]=++da));this.D=this.D;this.pa=this.pa}var Yc=0;Xc.prototype.D=!1;function Zc(a,b){this.type=a;this.target=b};function $c(a,b){Zc.call(this,a,b)}C($c,Zc);$c.prototype.a=function(){return this.n};function ad(a,b,c,d,e){Zc.call(this,a,b);this.version=c;this.Ma=d;this.Ha=e}C(ad,$c);h=ad.prototype;h.name="ReadyEvent";h.version=NaN;h.Ma=NaN;h.Ha=null;h.wb=function(){return this.version};h.Va=function(){return this.Ma};h.Ua=function(){return this.Ha};function bd(a,b,c){Zc.call(this,c||"error",a);this.error=b}C(bd,$c);bd.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};
bd.prototype.name="ErrorEvent";bd.prototype.error=null;bd.prototype.b=function(){return this.error};function cd(a,b){bd.call(this,a,b,"fail")}C(cd,bd);cd.prototype.name="FailEvent";function dd(a,b,c){var d;if(B(a))d=a.store,b=a.id,null!=a.parent&&(c=new dd(a.parent));else if(q(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new dd(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!q(b))throw Error("Invalid key value: "+a);this.n=d;this.a=b;this.parent=c||null}h=dd.prototype;h.toJSON=function(){var a={store:this.n,id:this.a};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.n+"^:"+this.a};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.pb=function(){return this.n};h.Ta=function(){return this.a};h.ob=function(){return this.parent};function ed(a){if(w(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function R(a,b,c,d){a>b&&(b=a=void 0);null===a&&(a=void 0);null===b&&(b=void 0);this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d}R.prototype.lower=void 0;R.prototype.upper=void 0;R.prototype.toJSON=function(){return fd(this)};R.only=function(a){return new R(a,a,!1,!1)};R.bound=function(a,b,c,d){return new R(a,b,c,d)};R.upperBound=function(a,b){return new R(void 0,a,void 0,!!b)};R.lowerBound=function(a,b){return new R(a,void 0,!!b,void 0)};
function gd(a){var b;if(v(a))b=Oa(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return R.only(a);return R.bound(a,b,!1,!0)}function fd(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function hd(a){return null!=a?null!=a.upper&&null!=a.lower?id.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?id.upperBound(a.upper,a.upperOpen):null!=a.lower?id.lowerBound(a.lower,a.lowerOpen):null:null}function jd(a){if(a instanceof R)return"";if(null!=a){if(B(a)){for(var b in a){var c;if(c=a.hasOwnProperty(b))c=!(0<=F(["lower","upper","lowerOpen","upperOpen"],b));if(c)return'invalid attribute "'+b+'" in key range object'}return""}return"key range must be an object"}return""}
function kd(a,b,c,d){var e,f,g,k;if("starts"==a||"^"==a)return gd(b);if("<"==a||"<="==a)e=b,g="<"==a;else if(">"==a||">="==a)f=b,k=">"==a;else if("="==a||"=="==a)e=f=b;else throw new I("invalid op: "+a);if("<"==c||"<="==c)e=d,g="<"==c;else if(">"==c||">="==c)f=d,k=">"==c;else if(q(c))throw new I("invalid op2: "+c);return R.bound(f,e,k,g)}var id=m.IDBKeyRange||m.webkitIDBKeyRange||R;function ld(a,b,c,d,e,f){q(e)||(e=v(a)?a.join(", "):a);if(null!=a&&!x(a)&&!w(a))throw new I("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);v(a)&&Object.freeze&&Object.freeze(a);!q(a)&&q(e)&&(a=e);this.keyPath=a;this.g=w(this.keyPath);this.b=e;this.type=md(b);if(q(b)){if(!q(this.type))throw new I("type invalid in index: "+this.b);if(v(this.keyPath))throw new I('composite key for store "'+this.b+'" must not specified type');}this.d=!!c;this.c=!!d;this.f=x(e)?e:v(a)?this.keyPath.join(","):
a;Ba(this.f);this.a=this.g?null:this.keyPath.split(".");this.e=f||null}function nd(a,b){if(null!=b){if(w(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=Ec(b,a.keyPath[d]);c[d]=f}return c}return Ec(b,a.keyPath)}}var od=["BLOB","DATE","INTEGER","NUMERIC","TEXT"];function md(a){if(x(a))return a=F(od,a),od[a]}h=ld.prototype;h.getName=function(){return this.b};h.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.d,multiEntry:this.c}};
h.clone=function(){var a=v(this.keyPath)?Oa(this.keyPath):this.keyPath;return new ld(a,this.type,this.d,this.c,this.b,this.e)};function pd(a,b){return null!=a||null!=b?null!=a?null!=b?w(a)&&w(b)?Pa(a,b)?null:"expect: "+a+", but: "+b:qd(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}h.hint=function(a){if(!a)return this;var b=v(this.keyPath)?Oa(this.keyPath):this.keyPath,c=this.type;q(a.type)||"TEXT"!=c||(c=void 0);return new ld(b,c,this.d,this.c,a.b)};
h.toString=function(){var a=this.c?"MultiEntry":"";this.a&&1<this.a.length&&(a+="Compound");return a+"Index:"+this.b};function rd(a,b,c,d,e,f,g,k){if(!x(a))throw new I("store name must be a string");this.b=a;this.keyPath=q(b)?b:null;this.e=w(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.e)throw new I("keyPath must be a string or array");if(null!=c&&!ba(c))throw new I('invalid autoIncrement value in store "'+a+'"');this.c=!!c;var l;if(null!=d){l=md(d);if(!q(l))throw new I('type "'+d+'" for primary key in store "'+this.b+'" is invalid.');if(this.e)throw new I('composite key for store "'+this.b+'" must not specified type');
}this.type=null!=l?l:this.c?"INTEGER":void 0;this.d=x(this.keyPath)?this.keyPath.split("."):[];this.a=e||[];this.J=!!f;this.Na=!!g;this.i=v(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";Ba(this.i);if(this.g=!!k){if(this.keyPath)throw new I('encrypted store "'+this.b+'" must not use inline key');if(this.c)throw new I('encrypted store "'+this.b+'" must not use key generator');}this.f=[]}h=rd.prototype;h.J=!1;h.Na=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.a.length;b++)a.push(this.a[b].toJSON());return{name:this.b,keyPath:this.keyPath,autoIncrement:this.c,type:this.type,indexes:a}};
function sd(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==F(b,c))throw new I('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(v(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==F(f,g))throw new I("Unknown field: "+g+" in "+S(e));e=new ld(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
q(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new rd(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}h.clone=function(){return sd(this.toJSON())};h.index=function(a){return this.a[a]||null};function td(a,b){return La(a.a,function(a){return a.getName()==b})}function ud(a,b){return b===a.keyPath?!0:Ka(a.a,function(a){return a.getName()==b})}h.getName=function(){return this.b};
function vd(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.e){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(Ec(b,a.keyPath[d]));return c}if(a.keyPath)return Va(b,a.d)}}function wd(a,b,c){for(var d=0;d<a.d.length;d++){var e=a.d[d];if(d==a.d.length-1){b[e]=c;break}q(b[e])||(b[e]={});b=b[e]}}
function xd(a,b){if(!b)return"missing store: "+a.b;if(a.b!=b.b)return"store name, expect: "+a.b+", but: "+b.b;var c=pd(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(q(a.c)&&q(b.c)&&a.c!=b.c)return"autoIncrement, expect:  "+a.c+", but: "+b.c;if(a.a.length!=b.a.length)return"indexes length, expect:  "+a.a.length+", but: "+b.a.length;if(q(a.type)&&q(b.type)&&(w(a.type)?!Pa(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.a.length;c++){var d=td(b,a.a[c].getName()),
e;e=a.a[c];if(d)if(e.b!=d.b)e="name, expect: "+e.b+", but: "+d.b;else{var f=pd(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.d&&null!=d.d&&e.d!=d.d?"unique, expect: "+e.d+", but: "+d.d:null!=e.c&&null!=d.c&&e.c!=d.c?"multiEntry, expect: "+e.c+", but: "+d.c:q(e.type)&&q(d.type)&&(w(e.type)?!Pa(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.b;if(0<e.length)return'index "'+a.a[c].getName()+'" '+e}return""}
function yd(a,b){if(b)for(var c=0;c<a.a.length;c++){var d=a.a[c],e=b;if(d.e){var f=d.e(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||v(f)){for(g=0;g<d.a.length-1;g++)B(e[d.a[g]])||(e[d.a[g]]={});e[d.a[d.a.length-1]]=f}}}}function zd(a,b,c,d,e){for(var f=0;f<a.f.length;f++)d!==f&&a.f[f].call(e,b,c)}h.toString=function(){return"Store:"+this.b+"["+this.a.length+"index]"};function Ad(a){return eval("("+a+")")}function Bd(){}
function Cd(a,b,c){switch(typeof b){case "string":Dd(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(v(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),Cd(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),Dd(e,c),c.push(":"),Cd(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var Ed={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Fd=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Dd(a,b){b.push('"',a.replace(Fd,function(a){if(a in Ed)return Ed[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Ed[a]=e+b.toString(16)}),'"')};J("ydn");function Gd(a){return!x(a)||/^[\s\xa0]*$/.test(a)?{}:"undefined"==typeof m.JSON?Ad(a):JSON.parse(a)}function Hd(a){var b;try{b=S(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function S(a){if("undefined"==typeof m.JSON){var b=[];Cd(new Bd,a,b);a=b.join("")}else a=JSON.stringify(a,void 0,void 0);return a};function Id(a,b){if(!a||/^[\s\xa0]*$/.test(a))throw new I("store_name must be provided for primary full text index");if(!b||/^[\s\xa0]*$/.test(b))throw new I("index_name must be provided for primary full text index");this.n=a};function Jd(a,b,c){this.name=a;this.a=b;this.b=c||"";if(-1==["","en","fr"].indexOf(this.b))throw new I('Unsupported lang "'+c+" for full text search index "+a);}Jd.prototype.getName=function(){return this.name};Jd.prototype.index=function(a){return this.a[a]};
function Kd(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==F(b,c))throw new I("Unknown field: "+c+" in "+S(a));if(!v(a.sources))throw new I("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==F(b,c))throw new I("Unknown field: "+c+" in "+Hd(a));return new Id(a.storeName,a.keyPath)});return new Jd(a.name,
b,a.lang)};function Ld(a,b){var c,d,e=b;if(B(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==F(c,f))throw new I("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!v(g))throw new I("stores must be array");for(f=0;f<g.length;f++){var k=sd(g[f]);if(-1!=Ma(e,function(a){return a.name==k.getName()}))throw new I('duplicate store name "'+k.getName()+'".');e.push(k)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(q(c)){if(!y(c)||0>c)throw new I("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(q(b)&&(!v(b)||0<b.length&&!(b[0]instanceof rd)))throw new I("stores");this.version=c;this.c=!q(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Kd(d.fullTextCatalogs[f]),c[f]=e,T(this,e.getName())||(g=[new ld("k","TEXT"),new ld("v","TEXT")],e=new rd(e.getName(),"id",!1,void 0,g,!1,!1,!1),this.stores.push(e));this.d=c}
Ld.prototype.toJSON=function(){var a=Ja(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;q(this.version)&&(b.version=this.version);return b};Ld.prototype.c=!1;Ld.prototype.a=function(){return!1};function Md(a){return Ja(a.stores,function(a){return a.getName()})}Ld.prototype.b=function(a){return this.stores[a]||null};function T(a,b){return La(a.stores,function(a){return a.getName()==b})}function Nd(a,b){return Ka(a.stores,function(a){return a.getName()==b})}
function Pd(a,b){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var c=0;c<a.stores.length;c++){var d=T(b,a.stores[c].getName());if(d){if(d=xd(a.stores[c],d),0<d.length)return'store: "'+a.stores[c].getName()+'" '+d}else return'missing object store "'+a.stores[c].getName()+'"'}return""};function Qd(a,b){Ld.call(this,a,b)}C(Qd,Ld);Qd.prototype.a=function(){return!0};function Rd(a){Error.captureStackTrace?Error.captureStackTrace(this,Rd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}C(Rd,Error);C(Rd,Error);function Sd(a){Error.captureStackTrace?Error.captureStackTrace(this,Sd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}C(Sd,Error);
function Td(a){Error.captureStackTrace?Error.captureStackTrace(this,Td):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Td,Error);Td.prototype.name="ydn.InternalError";function Ud(a){Error.captureStackTrace?Error.captureStackTrace(this,Ud):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}C(Ud,Error);Ud.prototype.name="ydn.error.ConstraintError";
function Vd(a){Error.captureStackTrace?Error.captureStackTrace(this,Vd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}C(Rd,Error);function Wd(a){Error.captureStackTrace?Error.captureStackTrace(this,Wd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}C(Wd,Error);function qd(a,b){var c;c=c||{};if(null!=a&&null!=b){if(w(a)&&w(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==La(b,function(b){return qd(b,a[d])}))return!1;return!0}if(w(a))return 1==a.length&&qd(a[0],b);if(w(b))return 1==b.length&&qd(b[0],a);if(B(a)&&B(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=qd(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=qd(a[e],b[e]),!f))return!1;return!0}return a===b}return!1};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function U(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==F(d,e))throw new I('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!v(c.mechanisms))throw new I("mechanisms attribute must be an array but "+aa(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!(0<=F(Xd,c.mechanisms[e])))throw new I('Invalid mechanism "'+c.mechanisms[e]+'"');}this.j=c.mechanisms||Xd;this.a=null;this.d=
[];this.na=!1;var f;if(b instanceof Ld)f=b;else if(B(b))for(c.autoSchema||!q(b.stores)?f=new Qd(b):f=new Ld(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=T(f,b.stores[e].name),b.stores[e].Sync&&yc(this.logger,"Synchronization option for "+d.getName()+" ignored.");else f=new Qd;this.c=f;for(e=0;e<this.c.stores.length;e++)if(this.c.b(e).g)throw Error("encryption option must be defined");q(a)&&this.i(a);this.e=new H}U.prototype.logger=J("ydn.db.con.Storage");
U.prototype.k=function(a){if(q(a)){var b=function(b){a(b.toJSON());a=void 0};if(this.a)Yd(this.a,b);else{var c=this;this.U(function(){Yd(c.a,b)},null,M)}}return this.c?this.c.toJSON():null};U.prototype.i=function(a){if(this.a)throw new Hb("Already connected with "+this.f);this.f=a;Zd(this)};U.prototype.getName=function(){return this.f};var Xd="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");h=U.prototype;h.wa=function(){return null};
function Zd(a){function b(b,e){b?(K(a.logger,a+": ready."),a.Ga=NaN,d.qb=function(){},d.rb=function(){a.a=null},d.$a=function(){},setTimeout(function(){$d(a,e);ae(a)},10),c.callback(e)):(yc(a.logger,a+": database connection fail "+e.name),setTimeout(function(){$d(a,new cd(a,e));if(a.d){var b=a.logger;for(b&&b.log(mc,"Purging "+a.d.length+" transactions request.",void 0);b=a.d.shift();)b.s&&b.s("error",e)}},10),c.l(e))}for(var c=new H,d=null,e=a.j,f=0;f<e.length;f++){var g=e[f].toLowerCase();if(d=
a.wa(g)){d=a.wa(g);break}}null===d?(e=new Ud("No storage mechanism found."),b(!1,new cd(a,e))):yb(be(d,a.f,a.c),function(a){this.a=d;b(!0,new ad("ready",this,parseFloat(d.b),parseFloat(a),null))},function(a){yc(this.logger,this+": opening fail");b(!1,a)},a)}h.fa=function(){if(this.a)return this.a.ea()};h.oa=function(a,b){this.e.Da(a,b)};function $d(a,b){setTimeout(function(){a.c.c&&a.e.c||(b instanceof bd?a.e.l(b.error):a.e.callback())},4)}function ce(a){return!!a.a&&!!a.a.c}
h.close=function(){this.a&&(this.a.close(),this.a=null,K(this.logger,this+" closed"))};h.sb=function(){return this.a?this.a.d||null:null};h.Ga=NaN;function ae(a){var b=a.d.shift();b&&(K(a.logger,"pop tx queue["+(a.d.length+1)+"]"),a.U(b.ka,b.bb,b.mode,b.s));a.Ga=ia()}
function de(a,b,c,d,e){K(a.logger,"push tx queue["+a.d.length+"]");a.d.push({ka:b,bb:c,mode:d,s:e});100<a.d.length&&0==a.d.length%100&&yc(a.logger,"Transaction queue stack size is "+a.d.length+". It is too large, possibility due to incorrect usage.")}h.na=!1;
h.U=function(a,b,c,d){var e=b;if(x(b))e=[b];else if(null!=b)if(w(b)){if(0==b.length)throw new I("number of store names must more than 0");for(var f=0;f<b.length;f++)if(!x(b[f]))throw new I("store name at "+f+" must be string but found "+typeof b[f]);}else throw new I("store names must be an array");else e=null;if(this.a&&this.a.c&&!this.na){var g=this,k=q(c)?c:M;k==Cc&&(this.na=!0);ee(this.a,function(b){a(b);a=null},function(a,b){z(d)&&(d(a,b),d=void 0);k==Cc&&(g.na=!1);ae(g)})}else de(this,a,e,c,
d)};h.toString=function(){return"Storage:"+this.a};U.prototype.close=U.prototype.close;U.prototype.getType=U.prototype.fa;U.prototype.getName=U.prototype.getName;U.prototype.getSchema=U.prototype.k;U.prototype.onReady=U.prototype.oa;U.prototype.setName=U.prototype.i;U.prototype.transaction=U.prototype.U;U.prototype.db=U.prototype.sb;ka("ydn.db.version","1.1.2");ka("ydn.db.cmp",Q);ka("ydn.db.deleteDatabase",function(a,b){for(var c,d=0;d<Wc.length;d++){var e=Wc[d](a,b);e&&(c=e)}return c||Vc("IDBVersionChangeEvent ",null)});ad.prototype.name=ad.prototype.name;
ad.prototype.getVersion=ad.prototype.wb;ad.prototype.getOldVersion=ad.prototype.Va;ad.prototype.getOldSchema=ad.prototype.Ua;bd.prototype.getError=bd.prototype.b;Pc.prototype.abort=Pc.prototype.abort;Pc.prototype.canAbort=Pc.prototype.Ra;Ac.prototype.progress=Ac.prototype.Aa;Ac.prototype.promise=Ac.prototype.Ba;function fe(a,b,c,d){Xc.call(this);this.Ba=c;this.n=c.getName();this.Z=void 0;this.g=!1;this.m=null;this.f=a;this.M=b;this.j=this.i=!1;this.Aa=d||4;this.d=this.b=this.a=void 0;this.e=function(){throw new Ib;};this.k=function(){throw new Ib;};this.L=function(){}}C(fe,Xc);
function ge(a,b,c,d,e){if(q(b)){var f=a.Ba,g,k=b;if(v(b)){a:{for(g=0;g<f.a.length;g++)if(!pd(f.a[g].keyPath,b)){g=f.a[g];break a}g=null}k=b.join(", ")}else g=td(f,b);if(!g)throw new I('require index "'+k+'" not found in store "'+f.getName()+'"');b=g.getName();a.Z=b}a.g=x(a.Z);a.m=c||null;a.i=!1;a.j=!1;a.reverse="prev"==d||"prevunique"==d;a.La="nextunique"==d||"prevunique"==d;a.za=e;a.a=void 0;a.b=void 0;a.d=void 0}h=fe.prototype;h.m=null;h.La=!1;h.reverse=!1;h.za=!0;h.logger=J("ydn.db.core.req.AbstractCursor");
h.toString=function(){return"Cursor:"+this.n+(q(this.Z)?":"+this.Z:"")+"["+(this.f?"":"~")+this.M+"]"};function he(a){null!=a.b?a.b=ed(a.b):a.b=void 0;null!=a.a?a.a=ed(a.a):a.a=void 0;a.L(a.j,a.a,a.b)}h.open=function(a,b,c,d){this.f=a;this.M=b;this.i=this.j=!1;this.a=c;this.b=d;ie(this,this.a,this.b)};function je(a){a.j=!0;K(a.logger,a+": exit");he(a)}h.ub=function(){return this.a};h.F=function(){return this.g?this.b:this.a};h.ga=function(){return this.za?this.F():this.d};h.va=function(){};h.Y=function(){};
function ke(a,b,c){K(a.logger,a+" restarting");a.i=!1;a.j=!1;ie(a,c,b)};function le(){};function V(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name must be a string, but "+a+" found.");this.c=a;this.d=b;this.f=g;this.g=!!this.d;if(q(d)&&!ba(d))throw new I("reverse value must be a boolean, but "+typeof d+" found");if(q(e)&&!ba(e))throw new I("unique value must be a boolean, but "+typeof e+" found");if(q(f)&&!ba(f))throw new I("key_only value must be a boolean, but "+typeof f+" found");this.a=q(f)?f:!!x(this.d);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.i=
a;if(d=jd(c))throw new I("Invalid key range: "+d);this.b=hd(c);this.e=me;this.r=NaN}C(V,le);V.prototype.a=!0;function ne(a,b,c){if(3<arguments.length)throw new I("too many argument");V.call(this,a,void 0,b,c,void 0,!0)}C(ne,V);function oe(a,b,c,d,e){if(!x(b))throw new I("index name must be string");V.call(this,a,b,c,d,e,!0)}C(oe,V);function pe(a,b,c){if(3<arguments.length)throw new I("too many argument");V.call(this,a,void 0,b,c,void 0,!1)}C(pe,V);
function qe(a,b,c,d,e){if(!x(b))throw new I("index name must be string");V.call(this,a,b,c,d,e,!1)}C(qe,V);var me="init";h=V.prototype;h.logger=J("ydn.db.Iterator");h.kb=function(){return this.c};h.gb=function(){return this.d};h.ib=function(){return this.b?this.b instanceof id?this.b:id.bound(this.b.lower,this.b.upper,this.b.lowerOpen,this.b.upperOpen):null};h.lb=function(){return this.a};h.Xa=function(){return this.g};
h.clone=function(){var a=new V(this.c,this.d,this.b,this.S(),this.ra(),this.a,this.f);a.r=this.r;return a};h.toJSON=function(){return{store:this.c,index:this.d,keyRange:this.b?fd(this.b):null,direction:this.i}};
h.toString=function(){var a=q(this.f)?":"+this.f.join(","):q(this.d)?":"+this.d:"",b;if(b=this.b){var c=b.lowerOpen?"(":"[";null!=b.lower&&(c+=b.lower+", ");null!=b.upper&&(c+=b.upper);b=c+=b.upperOpen?")":"]"}else b="";a+=b;this.e!=me&&(a+=this.e+"{"+this.j,this.g&&(a+=", "+this.k),a+="}");b=this.g?"Index":"";b+=this.a?"Key":"Value";return b+"Iterator:"+this.c+a};h.nb=function(a,b){var c=new V(this.c,this.d,this.b,this.S(),this.ra(),this.a,this.f);c.j=a;c.k=b;c.e="rest";return c};
h.reverse=function(){return new V(this.c,this.d,this.b,!this.S(),this.ra(),this.a,this.f)};h.S=function(){return"prev"===this.i||"prevunique"===this.i};h.ra=function(){return"nextunique"===this.i||"prevunique"===this.i};h.Wa=function(){return this.e};h.load=function(a){a=a[0];ge(a,this.f||this.d,this.b,this.i,this.a);this.e="busy";var b=this;a.L=function(a,d,e){b.j=d;b.k=e;b.e=a?"rest":"done"};ie(a,this.j,this.k);return a};h.hb=function(){return this.j};h.jb=function(){return this.k};
h.mb=function(a,b,c){a=a||me;"busy"==this.e?yc(this.logger,this+": resetting state to "+a+" ignore during iteration"):(this.j=b,this.k=c,this.e=a)};h.stores=function(){return[this.c]};function re(a,b,c,d){if("transaction"in a)this.g=a,this.c=this.e=null;else if("objectStore"in a){if(this.g=null,this.e=a.db,this.c=a,!this.c.db.objectStoreNames.contains(b))throw new Rd('store "'+b+'" not in transaction.');}else throw new Rd("storage instance require.");this.i=b;this.j=c;this.k=d;this.b=[];this.a=0;this.d=!1}re.prototype.logger=J("ydn.db.con.IdbCursorStream");re.prototype.d=!1;
function se(a,b){a.a++;b.onsuccess=function(b){if(b=b.target.result){if(z(a.k)){var d=b.value;a.k(b.primaryKey,null!=a.j?d[a.j]:d)}else yc(a.logger,"sink gone, dropping value for: "+b.primaryKey);if(b&&0<a.b.length)b["continue"](a.b.shift());else a.a--,0==a.a&&a.C&&a.C()}};b.onerror=function(){yc(a.logger,"seeking fail. "+("error"in b?b.error.name+":"+b.error.message:""));a.a--;0==a.a&&a.C&&a.C()}}function te(a,b){0==a.b.length&&0==a.a?b():a.C=b}
function ue(a){if(!a.d){var b=function(b,c){a.c=null;"complete"!==b&&yc(a.logger,c.name+":"+c.message);K(a.logger,a+" transaction "+b)},c=function(b){var c=a.b.shift();K(a.logger,a+" transaction started for "+c);b=b.objectStore(a.i);se(a,b.openCursor(c))};if(a.c)K(a.logger,a+" using existing tx."),c(a.c);else if(a.e)K(a.logger,a+" creating tx from IDBDatabase."),a.f=a.e.transaction([a.i],M),a.f.oncomplete=function(a){b("complete",a)},a.f.onerror=function(a){b("error",a)},a.f.onabort=function(a){b("abort",
a)};else if(a.g)K(a.logger,a+" creating tx from ydn.db.con.IStorage."),a.d=!0,a.g.U(function(b){a.d=!1;c(b)},[a.i],M,b);else throw new Td("no way to create a transaction provided.");}};function ve(a,b,c){a&&a instanceof U?this.ca=a:a&&a.db&&(this.ca=null,we(this,a));if(!x(b))throw new I("a store name required.");this.c=b;if(q(c)&&!x(c))throw new I("projection index name must be a string.");this.da=c;this.P=null;this.b=[];this.a=[];this.$=!1}h=ve.prototype;h.logger=J("ydn.db.Streamer");h.ca=null;h.Ca=null;h.P=null;h.cb=function(a){this.Ca=a};function we(a,b){if(b.db)a.P=new re(b,a.c,a.da,ga(a.C,a));else throw new I("Invalid IndexedDB Transaction.");}
function xe(a){var b=0<a.a.length;if(b&&!a.$&&z(a.Ca)){var c=function(){xe(a)},d=a.b.shift(),e=a.a.shift(),b=0<a.a.length,c=a.Ca(d,e,b?c:null);b&&!c&&xe(a)}}h.$=!1;h.Sa=function(a){if(this.P){this.$=!0;var b=this;te(this.P,function(){a(b.b,b.a);b.b=[];b.a=[];b.$=!1})}else a(this.b,this.a),this.b=[],this.a=[]};h.C=function(a,b){this.b.push(a);this.a.push(b);xe(this)};
h.push=function(a,b){if(this.$)throw new Wd("push not allowed after a collection is started");if(2<=arguments.length)this.C(a,b);else{if(!this.P){if(!this.ca)throw new Wd("Database connection is not setup.");var c=this.ca.fa();if(c)if("indexeddb"===c)this.P=new re(this.ca,this.c,this.da,ga(this.C,this));else throw new Sd(c);else throw new Wd("Database is not connected.");}c=this.P;c.b.push(a);ue(c)}};h.toString=function(){return"Streamer:"+this.c+(this.da||"")};function ye(a,b){if(null!=a&&!("push"in a))throw new Rd('output receiver object must have "push" method.');this.a=a||null;this.g=b;this.e=0;this.b=!1;this.d=a instanceof ve&&!!a.da}ye.prototype.logger=J("ydn.db.algo.AbstractSolver");
ye.prototype.f=function(a,b){this.b=b[0].S();for(var c=0;c<b.length;c++){if(!(b[c]instanceof V))throw new Eb("item at iterators "+c+" is not an iterator.");if(0<c&&this.b!=b[c].S())throw new Eb("iterator at "+c+" must "+(this.b?"be reverse":"not be reverse"));}this.a instanceof ve&&we(this.a,a);if(this.d&&(c=b[0].f)&&1<c.length&&c[c.length-1]!=this.a.da)throw new Wd("Output streamer projection field must be same as postfix field in the iterator");for(var d="{",c=0;c<b.length;c++)0<c&&(d+=", "),d+=
b.toString();d+="}";this.b&&(d+=" reverse");zc(this.logger,this+" begin "+d);return!1};function ze(a,b,c){var d,e=null!=d;if(!q(d)){d=c[0];for(var e=null!=d,f=1;e&&f<c.length;f++)null!=c[f]&&0==Q(c[f],d)||(e=!1)}return e&&(a.e++,a.a&&(a.d?a.a.push(d,void 0):a.a.push(d)),q(a.g)&&a.e>=a.g)?[]:b}ye.prototype.c=function(){return[]};function Ae(a){Error.captureStackTrace?Error.captureStackTrace(this,Ae):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}C(Ae,Error);Ae.prototype.name="ConstraintError";Ae.prototype.toString=function(){return this.name+": "+this.message};function Be(a){Error.captureStackTrace?Error.captureStackTrace(this,Be):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}C(Be,Error);Be.prototype.name="ydn.db.VersionError";
Be.prototype.toString=function(){return this.name+": "+this.message};function Sc(a){Error.captureStackTrace?Error.captureStackTrace(this,Sc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}C(Sc,Error);function Ce(a){Error.captureStackTrace?Error.captureStackTrace(this,Ce):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}C(Ce,Error);Ce.prototype.name="NotFoundError";Ce.prototype.toString=function(){return this.name+": "+this.message};
function De(a){Error.captureStackTrace?Error.captureStackTrace(this,De):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}C(De,Error);function Ee(a,b){this.a=b}Ee.prototype.logger=J("ydn.db.crud.req.RequestExecuto");Ee.prototype.toString=function(){return"RequestExecutor"};function Fe(a){this.c=a;this.a=null;this.b=0}Fe.prototype.logger=J("ydn.db.tr.Mutex");Fe.prototype.t=null;function Ge(a){return!!a.a&&!a.d}Fe.prototype.s=null;Fe.prototype.toString=function(){return"Mutex:"+("B"+this.c+"T"+this.b)+(this.a?"*":"")};function He(a,b,c,d,e,f){this.D=a;this.L=b;this.a=this.d=0;this.v=d;this.r=e;this.e=c||Ie;this.i=f||0}He.prototype.logger=J("ydn.db.tr.Thread");He.prototype.type=function(){return this.D.fa()};He.prototype.h=function(){return this.D};He.prototype.q=function(){return"B"+this.L+"T"+this.d};var Ie="single";function Je(a){if(a)if(z(a.abort))a.abort();else if(z(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Fb;else throw new Sc("No active transaction");};function Ke(a,b,c,d,e,f){He.call(this,a,b,c,d,e,f);this.c=[];this.f=[];this.g=null;this.b=new Fe(b);this.j=f||0;this.k=!1}C(Ke,He);h=Ke.prototype;h.logger=J("ydn.db.tr.Serial");
function Le(a,b,c){if("multi"==a.e)a:if(a=a.b,!a.t||!a.mode||c!=a.mode&&(a.mode!=N||c!=M)||b.length>a.t.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.t.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.e)a:if(a=a.b,a.t&&a.mode&&c==a.mode&&a.t.length==b.length){for(c=0;c<b.length;c++)if(-1==a.t.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.e?!0:!1;return b}function Me(a){var b=0<a.c.length?a.c[0].t:null,c=0<a.c.length?a.c[0].mode:null;return null!=b&&null!=c?Le(a,b,c):!1}
function Ne(a,b,c,d,e){K(a.logger,"push tx queue["+a.c.length+"]");a.c.push({ka:b,t:c,mode:d,s:e})}h.abort=function(){L(this.logger,this+": aborting");Je(this.g)};
h.N=function(a,b,c,d){var e=x(b)?[b]:b;if(w(e)){if(0==e.length)throw new I("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new I("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.M&&!(0<=F(this.M,e[f])))throw new I('store name "'+f+e[f]+'" in scope of '+this);}}else throw new I("store names must be an array");var g=q(c)?c:M,k=this;if(this.b.a||!ce(this.h())&&this.k)Ne(this,a,b,g,d);else{var l=this.q();d&&this.f.push(d);if(this.j&&
this.d>=this.j)throw new Hb("Exceed maximum number of transactions of "+this.j);this.k=!0;this.h().U(function(c){var d=k.b;d.a=c;d.d=!1;d.t=b;d.mode=g;d.b++;d.s=null;l=k.q();zc(k.logger,l+" BEGIN "+S(b)+" "+g);a(k);for(a=null;Me(k);)c=k.c.shift(),c.s&&k.f.push(c.s),K(k.logger,"pop tx queue"+(k.c.length+1)+" reusing T"+k.d),c.ka()},e,g,function(a,b){zc(k.logger,l+" "+a);var c=k.b;c.a?(c.a=null,c.t=null,c.mode=null,z(c.s)&&c.s(a,b),c.s=null):yc(c.logger,c+" has no TX to be unlocked for "+a);for(c=0;c<
k.f.length;c++)(0,k.f[c])(a,b);k.f.length=0;(c=k.c.shift())&&k.N(c.ka,c.t,c.mode,c.s);k.a=0})}};h.q=function(){var a=this.b;return"B"+a.c+"T"+a.b};h.request=function(a,b,c,d){function e(a,b){Rc(f);d&&d(a,b)}var f=new Pc(a);a=c||M;var g=this;Ge(this.b)&&Le(this,b,a)?(b=this.b.a,this.a++,Qc(f,b,this.q()+"R"+this.a),this.f.push(e)):g.N(function(){var a=g.b.a;g.a++;Qc(f,a,g.q()+"R"+g.a)},b,a,e);return f};
h.B=function(a,b,c,d,e){d=d||M;var f=this,g;if(Ge(f.b)&&Le(this,c,d)){var k=f.b.a;f.a++;g=f.q()+"R"+f.a;L(f.logger,g+" BEGIN");b(k,g,function(b,c){f.g=k;c?(L(f.logger,g+" ERROR"),a.l(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.g=null});L(f.logger,g+" END");b=null}else f.N(function(){var c=f.b.a;f.a++;g=f.q()+"R"+f.a;L(f.logger,g+" BEGIN");b(c,g,function(b,d){f.g=c;d?(L(f.logger,g+" ERROR"),a.l(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.g=null});L(f.logger,g+" END");b=null},c,d,e)};
h.getName=function(){return this.h().getName()};h.toString=function(){return"Serial:"+this.q()+(this.g?"*":"")};function Oe(a,b){Ke.call(this,a,b)}C(Oe,Ke);Oe.prototype.logger=J("ydn.db.tr.AtomicSerial");Oe.prototype.request=function(a,b,c){var d,e,f,g=Oe.o.request.call(this,a,b,c,function(a,b){Rc(g);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new De;O(g,c,!0)}});Tc(g,function(a,b,c){f=b;e=a;d=c});return g};
Oe.prototype.B=function(a,b,c,d,e){var f,g,k=new H;yb(k,function(a){g=!1;f=a},function(a){g=!0;f=a});Oe.o.B.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.l(c);else if(!0===g)a.l(f);else if(!1===g)a.callback(f);else{var d=new De;a.l(d)}e&&(e(b,c),e=void 0)})};Oe.prototype.toString=function(){return"Atomic"+Oe.o.toString.call(this)};function Pe(a,b,c){this.d=a;this.b=b;this.a=c;this.c=null}h=Pe.prototype;h.logger=J("ydn.db.tr.DbOperator");h.xb=function(){return this.a.d};h.abort=function(){this.a.abort()};function W(a){if(!a.c){var b;b=a.d;var c=b.fa();if("memory"==c||"localstorage"==c||"sessionstorage"==c)b=new Qe(0,b.c);else throw new Ib("No executor for "+c);a.c=b}return a.c}h.h=function(){return this.d};
function Re(a,b){var c=a.h(),d=b instanceof rd?b:sd(b),e=b.name,f=T(c.c,e);if(0==xd(d,f).length)Db(!1);else if(f=f?"update":"add",c.c instanceof Qd)c.c.stores.push(d),c.a?(c.a.close(),c.a=null,Zd(c)):Db(!1);else throw new Ud("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.h().getName()};function X(a,b,c){Pe.call(this,a,b,c)}C(X,Pe);h=X.prototype;h.logger=J("ydn.db.crud.DbOperator");
h.V=function(a,b,c,d){var e,f,g,k;if(null!=a)if(v(a)){if(q(c)||q(b))throw new I("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Nd(this.b,f[l]))throw new I('store name "'+f[l]+'" at '+l+" not found.");L(this.logger,"countStores: "+S(f));e=this.a.request("count",f);P(e,function(){Se(W(this),e,f)},this)}else if(x(a)){l=T(this.b,a);if(!l)throw new I('store name "'+a+'" not found.');if(q(d)&&!ba(d))throw new I('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,B(c)){var n=jd(c);if(n)throw new I("invalid key range: "+Hd(c)+" "+n);k=hd(c)}else{if(null!=c)throw new I("invalid key range: "+Hd(c)+" of type "+typeof c);k=null}else if(B(b)||null==b)if(B(b)){if(n=jd(b))throw new I("invalid key range: "+Hd(b)+" "+n);k=hd(b)}else{if(null!=b)throw new I("key range must be  an object but found "+Hd(b)+" of type "+typeof b);k=null}else throw new I('invalid second argument for count "'+Hd(c)+'" of type '+typeof b);L(this.logger,"countKeyRange: "+a+" "+(g?g:"")+S(k));
e=this.a.request("count",f);zd(l,e,arguments);P(e,function(){Te(W(this),e,f[0],k,g)},this)}else throw new I("Invalid store name or store names.");else yc(this.logger,"count method requires store name(s)"),l=Md(this.b),e=this.a.request("count",l),Tc(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),P(e,function(){Se(W(this),e,f)},this);return e};
h.G=function(a,b){var c=this,d;if(a instanceof dd){var e=a,f=e.n,g=T(this.b,f);if(!g){if(this.b.a()){if(ce(this.h()))return Vc("get",void 0);d=new Pc("get");this.h().oa(function(){yb(c.G(a,b),function(a){d.callback(a)},function(a){d.l(a)})});return d}throw new I("Store: "+f+" not found.");}var k=e.a;L(this.logger,"getByKey: "+f+":"+k);d=this.a.request("get:key",[f]);zd(g,d,arguments,void 0,this);P(d,function(){Ue(W(this),d,f,k)},this)}else if(x(a)&&q(b)){var l=a,g=T(this.b,l);if(!g){if(this.b.a()){if(ce(this.h()))return Vc("get",
void 0);d=new Pc("get");this.h().oa(function(){yb(c.G(a,b),function(a){d.callback(a)},function(a){d.l(a)})});return d}throw new I('Store name "'+l+'" not found.');}var n=b;L(this.logger,"getById: "+l+":"+n);d=this.a.request("get",[l]);zd(g,d,arguments,void 0,this);P(d,function(){Ue(W(this),d,l,n)},this)}else throw new I("get require valid input arguments.");return d};
h.Za=function(a,b,c,d,e){var f=T(this.b,a),g,k,l,n=null;if(B(b)){var t=jd(b);if(t)throw new I("invalid key range: "+b+" "+t);n=hd(b)}else if(null!=b)throw new I('expect key range object, but found "'+Hd(b)+'" of type '+typeof b);if(q(c))if(y(c))g=c;else throw new I("limit must be a number, but "+c+" is "+typeof c);else g=100;if(q(d))if(y(d))k=d;else throw new I("offset must be a number, but "+d+" is "+typeof d);else k=0;if(q(e))if(ba(e))l=e;else throw new I("reverse must be a boolean, but "+e+" is "+
typeof e);L(this.logger,"keysByKeyRange: "+a);var r=this.a.request("keys",[a]);zd(f,r,arguments);P(r,function(){Ve(W(this),r,2,a,null,n,g,k,l,!1)},this);return r};
h.Ya=function(a,b,c,d,e,f,g){var k,l,n,t,r,p=jd(c);if(p)throw new I("invalid key range: "+c+" "+p);p=T(this.b,a);k=hd(c);if(y(d))l=d;else{if(q(d))throw new I("limit must be a number");l=100}if(y(e))n=e;else{if(q(e))throw new I("offset must be a number");n=0}if(q(f))if(ba(f))t=f;else throw new I("reverse must be a boolean");if(q(g))if(ba(g))r=g;else throw new I("unique must be a boolean");L(this.logger,"keysByIndexKeyRange: "+a);var u=this.a.request("keys:iter:index",[a]);zd(p,u,arguments);P(u,function(){Ve(W(this),
u,2,a,b,k,l,n,t,r)},this);return u};h.keys=function(a,b,c,d,e,f,g){var k=T(this.b,a);if(!x(a))throw new I("store name must be a string, but "+a+" of type "+typeof a+" is not.");if(!this.b.a()){if(!k)throw new I('store name "'+a+'" not found.');if(x(b)&&!td(k,b))throw new I('index "'+b+'" not found in store "'+a+'".');}return this.b.a()&&!k?Vc("keys",[]):x(b)?this.Ya(a,b,c,d,e,f,g):this.Za(a,b,c,d,e)};
h.O=function(a,b,c,d,e,f,g){var k=this,l;if(x(a)){var n=a,t=T(this.b,n);if(!t){if(this.b.a()){if(ce(this.h()))return Vc("values",[]);l=new Pc("values");this.h().oa(function(){yb(k.O(a,b,c,d,e,f),function(a){l.callback(a)},function(a){l.l(a)})});return l}throw new Ce(n);}if(v(b)){if(q(c)||q(d))throw new I("too many input arguments");var r=b;L(this.logger,"listByIds: "+n+" "+r.length+" ids");l=this.a.request("values:array",[n]);zd(t,l,arguments,void 0,this);P(l,function(){var a=W(this);We(a,l,n,r)},
this)}else l=x(b)?this.eb(n,b,c,d,e,f,g):this.fb(n,b,c,d,e)}else if(v(a))if(a[0]instanceof dd){for(var t=[],p=a,u=0;u<p.length;u++){var A=p[u].n;if(!Nd(this.b,A)){if(this.b.a())return t=[],t[p.length-1]=void 0,Vc("get",t);throw new I("Store: "+A+" not found.");}0<=F(t,A)||t.push(A)}L(this.logger,"listByKeys: "+S(t)+" "+p.length+" keys");l=this.a.request("values:keys",t);P(l,function(){var a=W(this);We(a,l,null,p)},this)}else throw new I("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+
typeof a[0]+" found.");else throw new I("first argument "+a+" is invalid.");return l};
h.fb=function(a,b,c,d,e){var f=T(this.b,a),g,k,l,n=null;if(B(b)){var t=jd(b);if(t)throw new I("invalid key range: "+b+" "+t);n=hd(b)}else if(null!=b)throw new I('expect key range object, but found "'+Hd(b)+'" of type '+typeof b);if(q(c))if(y(c))g=c;else throw new I("limit must be a number, but "+c+" is "+typeof c);else g=100;if(q(d))if(y(d))k=d;else throw new I("offset must be a number, but "+d+" is "+typeof d);else k=0;if(q(e))if(ba(e))l=e;else throw new I("reverse must be a boolean, but "+e+" is "+
typeof e);L(this.logger,(n?"listByKeyRange: ":"listByStore: ")+a);var r=this.a.request("values",[a]);zd(f,r,arguments);P(r,function(){Ve(W(this),r,4,a,null,n,g,k,l,!1)},this);return r};
h.eb=function(a,b,c,d,e,f,g){var k=T(this.b,a),l,n,t,r;if(!ud(k,b))throw new I('index "'+b+'" not found in store "'+a+'"');var p=jd(c);if(p)throw new I("invalid key range: "+c+" "+p);var u=hd(c);if(q(d))if(y(d))l=d;else throw new I("limit must be a number.");else l=100;if(q(e))if(y(e))n=e;else throw new I("offset must be a number.");else n=0;if(ba(f))t=f;else if(q(f))throw new I("reverse must be a boolean, but "+f);if(q(g))if(ba(g))r=g;else throw new I("unique must be a boolean");L(this.logger,"listByIndexKeyRange: "+
a+":"+b);var A=this.a.request("values:iter:index",[a]);zd(k,A,arguments);P(A,function(){Ve(W(this),A,4,a,b,u,l,n,t,r)},this);return A};
h.ta=function(a,b,c){var d=x(a)?a:B(a)?a.name:void 0;if(!x(d))throw new I("store name "+d+" must be a string, but "+typeof d);var e=T(this.b,d);if(!e){if(!this.b.a())throw new I('store name "'+d+'" not found.');e=sd(B(a)?a:{name:d});L(this.logger,"Adding object store: "+d);Re(this,e)}else if(this.b.a()&&B(a)&&(a=sd(a),a=xd(e,a)))throw new Fb(a);var f;if(!e)throw new I('store name "'+d+'" not found.');if(x(e.keyPath)&&q(c))throw new I("key must not be provided while the store uses in-line key.");if(!e.keyPath&&
!e.c&&!q(c))throw new I("out-of-line key must be provided.");if(v(b)){L(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)yd(e,b[a]);f=this.a.request("add:array",[d],N);P(f,function(){Xe(W(this),f,!1,!1,d,b,c)},this);e.J&&f.H(function(){this.h();e.getName();this.h()},this)}else if(B(b))a="store: "+d+" key: "+vd(e,b,c),L(this.logger,"addObject: "+a),yd(e,b),f=this.a.request("add",[d],N),P(f,function(){Xe(W(this),f,!1,!0,d,[b],[c])},this),e.J&&f.H(function(){this.h();e.getName();
this.h()},this);else throw new I("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};function Ye(a,b){var c=x(b)?b:B(b)?b.name:void 0;if(!x(c))throw new I("store name must be a string");var d=T(a.b,c);if(!d){if(!a.b.a())throw new Ce(c);d=sd(B(b)?b:{name:c});L(a.logger,"Adding object store: "+c);Re(a,d)}else if(a.b.a()&&B(b)){var e=sd(b);if(e=xd(d,e))throw new Fb(e);}if(!d)throw new Ce(c);return d}
h.load=function(a){a=Ye(this,a).getName();var b=this.a.request("load",[a]),c=this;this.a.B(b,function(){W(c);throw new Gb("putData");},[a],N);return b};
h.W=function(a,b,c){var d,e=this;if(a instanceof dd){var f=a,g=f.n,k=T(this.b,g);if(!k)throw new I('store "'+g+'" not found.');if(k.keyPath){var l=vd(k,b);if(null!=l){if(0!=Q(l,f.a))throw new I("Inline key must be "+f+" but "+l+" found.");}else wd(k,b,f.a);return this.W(g,b)}return this.W(g,b,f.a)}if(v(a)){if(q(c))throw new I("too many arguments");var n=a;if(!q(b))throw new I("record values required");for(var t=b,f=[],g=0,k=n.length;g<k;g++){l=n[g].n;-1==F(f,l)&&f.push(l);var r=T(this.b,l);if(!r)throw new I('store "'+
l+'" not found.');r.keyPath&&wd(r,t[g],n[g].a)}L(this.logger,"putByKeys: to "+S(f)+" "+t.length+" objects");for(g=0;g<t.length;g++)yd(r,t[g]);d=this.a.request("put:keys",f,N);zd(r,d,arguments);P(d,function(){var a=W(e);Xe(a,d,!0,!1,null,t,n)},this)}else if(x(a)||B(a)){var r=Ye(this,a),p=r.getName();if(r.keyPath&&q(c))throw new I("key must not be provided while the store uses in-line key.");if(!r.keyPath&&!r.c&&!q(c))throw new I("out-of-line key must be provided.");if(v(b)){var u=b,A=c;L(this.logger,
"putObjects: "+p+" "+u.length+" objects");for(g=0;g<u.length;g++)yd(r,u[g]);d=this.a.request("put:array",[p],N);zd(r,d,arguments);P(d,function(){Xe(W(this),d,!0,!1,p,u,A)},this);r.J&&d.H(function(){this.h();this.h()},this)}else if(B(b)){var D=b,ja=c;L(this.logger,"putObject: "+p+" "+(q(ja)?ja:"(without-key)"));if(q(m.Blob)&&D instanceof Blob&&r.Na&&!r.keyPath&&0==r.a.length&&Ub)d=new Pc("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.a.request("put",[p],N);zd(r,c,[p,D,ja]);
P(c,function(){Xe(W(e),c,!0,!0,p,[b],[ja])},this);yb(c,function(a){d.callback(a)},function(a){d.l(a)})},f.onerror=function(a){d.l(a)},f.onabort=function(a){d.l(a)},f.readAsDataURL(D);else{yd(r,D);d=this.a.request("put",[p],N);var na=[p,D,ja];zd(r,d,na);P(d,function(){var a=q(ja)?[na[2]]:void 0;Xe(W(e),d,!0,!0,p,[na[1]],a)},this)}r.J&&d.H(function(){this.h();this.h()},this)}else throw new I("put record value must be Object or array of Objects");}else throw new I("the first argument of put must be store name, store schema or array of keys.");
return d};
h.clear=function(a,b,c){if(q(c))throw new I("too many input arguments");var d;if(x(a)){c=T(this.b,a);if(!c)throw new I('store name "'+a+'" not found.');if(B(b)){var e=hd(b);if(null===e)throw new I("clear method requires a valid non-null KeyRange object.");L(this.logger,"clearByKeyRange: "+a+":"+S(e));d=this.a.request("clear",[a],N);zd(c,d,[a,e]);P(d,function(){var b=W(this);Ze(b,d,a,e)},this)}else{if(q(b))throw new I("clear method requires a valid KeyRange object as second argument, but found "+b+
" of type "+typeof b);L(this.logger,"clearByStore: "+a);d=this.a.request("clear",[a],N);P(d,function(){$e(W(this),d,[a])},this)}}else if(!q(a)||v(a)&&x(a[0])){var f=a||Md(this.b);L(this.logger,"clearByStores: "+S(f));d=this.a.request("clear",f,N);P(d,function(){$e(W(this),d,f)},this)}else throw new I('first argument "'+a+'" is invalid.');return d};
h.ua=function(a,b,c){var d;if(x(a)){var e=T(this.b,a);if(!e)throw new I('store name "'+a+'" not found.');if(q(c))if(x(b)){var f=td(e,b);if(!f)throw new I("index: "+b+" not found in "+a);if(B(c)||null===c){var g=hd(c);L(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.a.request("rm:iter:index",[a],N);P(d,function(){af(W(this),d,a,f.getName(),g)},this)}else throw new I("key range "+c+' is invalid type "'+typeof c+'".');}else throw new I('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(x(b)||y(b)||w(b)||b instanceof Date){L(this.logger,"removeById: "+a+":"+b);d=this.a.request("rm",[a],N);var k=[a,b];zd(e,d,k);P(d,function(){bf(W(this),d,a,k[1])},this);e.J&&d.H(function(){this.h();this.h()},this)}else if(B(b))g=hd(b),L(this.logger,"removeByKeyRange: "+a+":"+S(g)),d=this.a.request("rm:iter",[a],N),zd(e,d,[a,g]),P(d,function(){Ze(W(this),d,a,g)},this),e.J&&d.H(function(){this.h();this.h()},this);else throw new I('Invalid key or key range "'+b+'" of type '+
typeof b);}else if(a instanceof dd){var l=a.n,e=T(this.b,l);d=this.a.request("rm",[l],N);var n=[l,a.a];zd(e,d,n);P(d,function(){bf(W(this),d,l,n[1])},this)}else if(v(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof dd))throw new I("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+Hd(a[c])+'" ('+aa(a[c])+") is not ydn.db.Key.");var t=a[c].n;-1==F(b,t)&&b.push(t)}if(1>b.length)throw new I('at least one valid key required in key list "'+Hd(a)+'"');d=this.a.request("rm:keys",b,N);
P(d,function(){cf(W(this),d,a)},this)}else throw new I('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+Hd(a)+'" ('+aa(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.h().getName()};function df(a,b,c){Pe.call(this,a,b,c)}C(df,X);h=df.prototype;h.logger=J("ydn.db.core.DbOperator");h.G=function(a,b){if(a instanceof V){var c=a.c,d=T(this.b,c);if(!d)throw new I('store "'+c+'" not found.');var e=a.d;if(q(e)&&!ud(d,e))throw new I('index "'+e+'" not found in store "'+c+'".');L(this.logger,"getByIterator:"+a);var f=this.a.request("get:iter",[c]);P(f,function(){ef(this,5,f,a,1)},this);return f}return df.o.G.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof V){var k=100;if(y(b)){if(k=b,1>k)throw new I("limit must be a positive value, but "+b);}else if(q(b))throw new I("limit must be a number,  but "+b);if(q(c))throw new I("offset must not be specified");L(this.logger,"keysByIterator:"+a);var l=this.a.request("keys:iter",[a.c]);P(l,function(){a.g?ef(this,1,l,a,k):ef(this,2,l,a,k)},this);return l}return df.o.keys.call(this,a,b,c,d,e,f,g)};
h.V=function(a,b,c,d){if(a instanceof V){if(q(b)||q(c))throw new I("too many arguments.");L(this.logger,"countIterator:"+a);var e=this.a.request("count",[a.c]);P(e,function(){ef(this,6,e,a)},this);return e}return df.o.V.call(this,a,b,c,d)};
h.O=function(a,b,c,d,e,f){if(a instanceof V){var g;if(y(b)){if(g=b,1>g)throw new I("limit must be a positive value, but "+g);}else if(q(b))throw new I("limit must be a number, but "+b);if(q(c))throw new I("offset must not be specified");L(this.logger,"listByIterator:"+a);var k=this.a.request("values:iter",[a.c]);P(k,function(){a.a?ef(this,2,k,a,g):ef(this,4,k,a,g)},this);return k}return df.o.O.call(this,a,b,c,d,e,f)};
h.Ka=function(a,b,c){if(!v(b))throw new I("iterators argument must be an array, but "+b+" of type "+typeof b+" found");for(var d=0;d<b.length;d++)if(!(b[d]instanceof V))throw new I("Iterator at "+d+" must be cursor range iterator.");c=c||M;for(var e=[],d=0;d<b.length;d++)for(var f=b[d].stores(),g=0;g<f.length;g++)0<=F(e,f[g])||e.push(f[g]);L(this.logger,this+": scan for "+b.length+" iterators on "+e);var k=this,d=this.a.request("scan",e);this.a.B(d,function(c,d,e){function f(){for(var a=0,e=0;e<b.length;e++){var t=
b[e],r=[ff(W(k),c,d,t.c)],t=t.load(r);t.k=g;t.e=ha(u,a);Ia[e]=t;na[a]=e;a++}ja=b.length}function g(a){for(var b=0;b<Ia.length;b++)je(Ia[b]);Na(Ia);L(k.logger,A+" error");e(a,!0)}function u(c,d){if(D)throw new Td;Jc++;var f=Jc===ja,g=na[c],l=b[g],n=Ia[g],g=n.F(),n=n.ga();Ca[c]=d;bb[c]=l.g?l.a?g:n:l.a?d:n;if(f){var r;a instanceof ye?r=a.c(Ca,bb):r=a(Ca,bb);f=[];l=[];g=[];n=[];if(v(r))for(var p=0;p<r.length;p++)!0===r[p]?g[p]=1:!1===r[p]?n[p]=!0:l[p]=r[p];else if(null===r)f=[];else if(q(r))if(B(r)){f=
["advance","continue","continuePrimary","restart"];for(p in r)if(!(0<=F(f,p)))throw new Hb('Unknown attribute "'+p+'" in cursor advancement object');f=r.continuePrimary||[];l=r["continue"]||[];g=r.advance||[];n=r.restart||[]}else throw new Hb("scan callback output");else for(f=[],p=0;p<b.length;p++)q(na[p])&&(g[p]=1);for(p=Jc=r=0;p<b.length;p++)null!=f[p]||q(l[p])||null!=n[p]||null!=g[p]||Jc++;for(p=0;p<b.length;p++)if(null!=f[p]||q(l[p])||null!=n[p]||null!=g[p]){var u=na[p];if(!q(u))throw new Vd(p+
" is not an iterator.");var u=b[u],cb=Ia[p];if(null==Ca[p]){var Od=p+"/"+b.length;if(null!=g[p])throw new Wd(cb+" "+Od+" must not advance "+g[p]+" steps");if(q(l[p]))throw new Wd(cb+" "+Od+" must not continue to key "+l[p]);if(null!=f[p])throw new Wd(cb+" "+Od+" must not continue to primary key "+f[p]);}Ca[p]=void 0;bb[p]=void 0;if(null!=n[p])ke(cb);else if(q(l[p]))cb.Y(l[p]);else if(null!=f[p])cb.va(f[p]);else if(null!=g[p])gf(cb);else throw new Td(u+": has no action");r++}if(0==r){for(r=0;r<Ia.length;r++)je(Ia[r]);
D=!0;Na(Ia);L(k.logger,"success "+A);e(void 0)}}}var A=d+" "+k+" scanning";K(k.logger,A);var D=!1,ja,na=[],Ca=[],bb=[],Ia=[],Jc=0;a instanceof ye?a.f(c,b,function(){f()})||f():f()},e,c);return d};
h.open=function(a,b,c,d){if(!(b instanceof V))throw new I("Second argument must be cursor range iterator.");for(var e=b.stores(),f=0;f<e.length;f++)if(!T(this.b,e[f]))throw new I('Store "'+e[f]+'" not found.');c=c||M;var g=this,k=this.a.request("open",b.stores(),c);L(this.logger,"open:"+c+" "+b);P(k,function(c){var e=Uc(k);L(g.logger,e+" iterating "+b);for(var f=b.stores(),r=[],p=0;p<f.length;p++)r[p]=ff(W(g),c,e,f[p]);var u=b.load(r);u.k=function(a){O(k,a,!0)};u.e=function(b){null!=b?(b=a.call(d,
u),!0===b?ke(u):B(b)?!0===b.restart?ke(u,b["continue"],b.continuePrimary):null!=b["continue"]?u.Y(b["continue"]):null!=b.continuePrimary?u.va(b.continuePrimary):(je(u),O(k,void 0)):null===b?(je(u),O(k,void 0)):null!=b?u.Y(b):gf(u)):(je(u),O(k,void 0))}},this);return k};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new I('Store "'+e+'" not found.');e=this.a.request("map",d);K(this.logger,"map:"+a);this.a.B(e,function(d,e,f){K(c.logger,e+" iterating "+a);for(var n=a.stores(),t=[],r=0;r<n.length;r++)t[r]=ff(W(c),d,e,n[r]);var p=a.load(t);p.k=function(a){f(a,!1)};p.e=function(c){if(null!=c){var d;a.g?a.a?d=c:d=p.F():a.a?d=c:d=p.ga();b(d);gf(p)}else f(void 0),b=null}},d,M);return e};
h.sa=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)if(!f)throw new I('Store "'+f+'" not found.');f=this.a.request("reduce",e);var k=B(c)?Gd(S(c)):c;L(this.logger,"reduce:"+a);this.a.B(f,function(c,e,f){for(var g=a.stores(),p=[],u=0;u<g.length;u++)p[u]=ff(W(d),c,e,g[u]);var A=a.load(p);A.k=function(a){f(a,!0)};var D=0;A.e=function(c){if(null!=c){var d;a.g?a.a?d=c:d=A.F():a.a?d=c:d=A.ga();k=b(k,d,D++);gf(A)}else f(k)}},e,M);return f};
function ef(a,b,c,d,e){var f=[],g=c.a,k=Uc(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);L(a.logger,l);for(var n=W(a),t=[],r=d.stores(),p=0;p<r.length;p++)t[p]=ff(n,g,k,r[p]);var u=d.load(t);u.k=function(a){je(u);O(c,a,!0)};var A=0,D=!1;u.e=function(d){D||(K(a.logger,l+" starting"),D=!0);null!=d?(A++,1==b?f.push(d):2==b?f.push(u.F()):3==b?f.push([d,u.F()]):6!=b&&f.push(u.ga()),5==b?(je(u),O(c,f[0])):6==b||!q(e)||A<e?u.Y():(L(a.logger,"success:"+l+" yields "+f.length+" records"),je(u),O(c,f))):
(L(a.logger,"success:"+l+" yields "+f.length+" records"),je(u),O(c,5==b?f[0]:6==b?A:f))}};function hf(a,b,c,d){this.d=a;this.e=b;this.a=Oa(c);this.b=d;this.c=[]}hf.prototype.d=null;function jf(a,b,c){if(a.d)c&&a.c.push(c),b(a.d);else throw new Ib("tx committed on ParallelTxExecutor");}hf.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.e+" mode:"+this.b+" scopes:"+S(this.a)};function kf(a,b,c,d,e,f){He.call(this,a,b,c,d,e,f);this.c=this.b=null}C(kf,He);h=kf.prototype;h.logger=J("ydn.db.tr.Parallel");h.abort=function(){L(this.logger,this+": aborting");Je(this.c)};
h.Oa=function(a,b){var c;if("multi"==this.e)a:if(c=this.b,!c.a||!c.b||b!=c.b&&(c.b!=N||b!=M)||a.length>c.a.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.e)a:if(c=this.b,c.a&&c.b&&b==c.b&&c.a.length==a.length){for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.e?!0:!1;return c};
h.N=function(a,b,c,d){function e(c){l.d++;n=new hf(c,l.d,b,k);g=l.q();zc(l.logger,g+" BEGIN "+S(b)+" "+k);l.b=n;jf(l.b,a,d)}function f(a,b){zc(l.logger,g+" "+a);if(n){for(var c=n,d=0;d<c.c.length;d++)c.c[d](a,b);c.c.length=0;c.d=null;c.a=null;c.c=null}l.a=0}var g;this.v&&(b=this.v);this.r&&(c=this.r);var k=q(c)?c:M,l=this,n;if(this.b&&this.b.d&&this.Oa(b,k))jf(this.b,a,d);else{if(this.i&&this.d>=this.i)throw new Hb("Exceed maximum number of transactions of "+this.i);this.h().U(e,b,k,f)}};
h.request=function(a,b,c,d){var e=new Pc(a),f=this;this.N(function(a){f.a++;Qc(e,a,f.q()+"R"+f.a)},b,c||M,function(a,b){Rc(e);d&&d(a,b)});return e};h.B=function(a,b,c,d,e){var f=this,g;this.N(function(c){f.a++;g=f.q()+"R"+f.a;L(f.logger,g+" BEGIN");b(c,g,function(b,d){f.c=c;g=f.q()+"R"+f.a;d?(L(f.logger,g+" ERROR"),a.l(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.c=null});b=null;L(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.e+":"+this.q()+(this.c?"*":"")};function lf(a,b){kf.call(this,a,b,Ie)}C(lf,kf);h=lf.prototype;h.logger=J("ydn.db.tr.AtomicParallel");h.Oa=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=lf.o.request.call(this,a,b,c,function(a,b){Rc(k);L(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new De;O(k,c,!0)}});Tc(k,function(a,b,c){f=b;e=a;d=c});return k};
h.B=function(a,b,c,d,e){var f,g,k=new H;yb(k,function(a){g=!1;f=a},function(a){g=!0;f=a});lf.o.B.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.l(c);else if(!0===g)a.l(f);else if(!1===g)a.callback(f);else{var d=new De;a.l(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+lf.o.toString.call(this)};function mf(a,b,c){U.call(this,a,b,c);this.T=0;a=!0;b=Ie;c&&(q(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=nf(this,b,a);this.g=nf(this,"atomic",!1);this.b=this.aa(c,this.g)}C(mf,U);h=mf.prototype;h.T=0;h.Pa=function(a,b,c,d,e,f){a=a||Ie;var g;"readonly"==d?g=M:"readwrite"==d&&(g=N);a=nf(this,a,b,c,g,e);return this.aa(a,f?null:this.g)};h.aa=function(a){return new Pe(this,this.c,a)};
function nf(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==Ie)return new Ke(a,a.T++,b,d,e,f);if("atomic"==b)return new Oe(a,a.T++);throw new I('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==Ie)return new kf(a,a.T++,b,d,e,f);if("atomic"==b)return new lf(a,a.T++);throw new I('Invalid requestType "'+b+'"');}
h.ab=function(a,b,c){if(3<arguments.length)throw new I("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.T++;var d=b||Md(this.c),e=M;if(c)if("readwrite"==c)e=N;else if("readonly"!=c)throw new I('Invalid transaction mode "'+c+'"');var f=nf(this,"all",!1,d,e,1),g=this.aa(f,this.g),k=new Pc("run"),l=this;f.N(function(b){K(l.logger,"executing run in transaction on "+f);Qc(k,b,f.q()+"R0");a(g)},d,e,function(a){Rc(k);O(k,f.d,"complete"!==a)});
return k};h.yb=function(){return this.b?this.b.a.d:NaN};function Y(a,b,c){mf.call(this,a,b,c);a=this.c;for(b=0;b<a.d.length;b++){c=a.d[b];var d=T(a,c.getName());if(d){if(!ud(d,"k"))throw new I('full text index store "'+d.getName()+'" must have "keyword" index');if(!ud(d,"v"))throw new I('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new I('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new I('full text index store "'+c.getName()+'" required.');for(d=0;d<c.a.length;d++){var e=
c.index(d),f=T(a,e.n);if(f)yc(this.logger,"Full text indexer option for "+f.getName()+" ignored.");else throw new I('full text source store "'+e.n+'" does not exist for full text index "'+c.getName()+'"');}}}C(Y,mf);h=Y.prototype;h.aa=function(a){return new X(this,this.c,a)};h.ta=function(a,b,c){return this.b.ta(a,b,c)};h.V=function(a,b,c,d){return this.b.V(a,b,c,d)};h.G=function(a,b){return this.b.G(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.b.keys(a,b,c,d,e,f,g)};
h.O=function(a,b,c,d,e,f){return this.b.O(a,b,c,d,e,f)};h.load=function(a,b,c){return this.b.load(a,b,c)};h.W=function(a,b,c){return this.b.W(a,b,c)};h.clear=function(a,b,c){return this.b.clear(a,b,c)};h.ua=function(a,b,c){return this.b.ua(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();ce(this)&&(a+=" ["+this.fa()+"]");return a};function of(a,b,c){Y.call(this,a,b,c)}C(of,Y);h=of.prototype;h.aa=function(a){return new df(this,this.c,a)};h.open=function(a,b,c,d){return this.b.open(a,b,c,d)};h.tb=function(a,b){return this.b.Ka(a,b)};h.map=function(a,b){return this.b.map(a,b)};h.sa=function(a,b,c){return this.b.sa(a,b,c)};function pf(){this.a=!1}pf.prototype.a=!1;pf.prototype.state=function(){return this.a};function qf(a,b,c,d){fe.call(this,a,b,c,d);this.d=this.b=this.a=void 0;this.r=this.c=null;this.v=new pf;this.qa=this.I=null}C(qf,fe);h=qf.prototype;h.logger=J("ydn.db.core.req.SimpleCursor");h.vb=function(a){rf(this.qa,this.F(),a);return Db()};function gf(a){function b(b){c++;if(!b||1<=c)return sf(a,b)}var c=a.c?-1:0;a.reverse?tf(a.I,b,a.c):uf(a.I,b,a.c)}
h.Y=function(a){if(null!=a){var b=this,c=new Z(a),d=function(c){b.c=c;if(!c)return sf(b,c);var d=Q(c.value.key,a);if(b.reverse){if(1!=d)return sf(b,c)}else if(-1!=d)return sf(b,c)};this.reverse?tf(this.I,d,c):uf(this.I,d,c)}else gf(this)};
function vf(a){setTimeout(function(){if(a.v.state()){a.v.a=!1;var b=a.a,c=a.b,d=a.d;null==b&&(L(a.logger,a+" finished."),a.i=!0);a.a=b;a.b=c;a.d=d;a.i?(K(a.logger,a+" DONE."),a.e(),he(a)):(K(a.logger,a+" new cursor position {"+(a.g?a.a+", "+a.b:a.a)+"}"),a.e(a.a));vf(a)}else a.r(),a.r=null},4)}
function sf(a,b){if(a.c=b){var c=b.value;if(a.m)if(a.reverse||null==a.m.upper)a.reverse&&null!=a.m.lower&&(d=Q(c.key,a.m.lower),-1==d||0==d&&a.m.lowerOpen)&&(a.c=null);else{var d=Q(c.key,a.m.upper);if(1==d||0==d&&a.m.upperOpen)a.c=null}if(a.c){if(a.La&&null!=a.a&&null!=c.key&&0==Q(a.a,c.key))return;a.a=c.key;a.b=a.g?c.a:a.a;4==a.Aa&&(a.za?a.d=a.b:a.d=wf(a.qa,a.b))}}a.c||(a.a=void 0,a.b=void 0,a.d=void 0);return a.v.a=!0}
function ie(a,b,c){var d=null;if(a.m)if(a.reverse){var e=a.g?"\uffff":void 0;null!=a.m.upper&&(d=new Z(a.m.upper,e))}else null!=a.m.lower&&(d=new Z(a.m.lower));null!=b&&(d=a.g?new Z(b,c):new Z(b));a.r=a.f.h(function(a){function c(a){var e=a.value,f=e.key;if(a&&null!=f)if(null!=b){if(0==xf(d,e))return}else if(this.m&&(!this.reverse&&this.m.lowerOpen&&null!=this.m.lower&&(e=Q(f,this.m.lower),0==e)||this.reverse&&this.m.upperOpen&&null!=this.m.upper&&(e=Q(f,this.m.upper),0==e)))return;return sf(this,
a)}this.qa=yf(a,this.n);this.I=zf(this.qa,this.Z);this.reverse?tf(this.I,ga(c,this),d):uf(this.I,ga(c,this),d);vf(this)},a)}h.clear=function(){throw new Gb;};h.va=function(){throw new Gb;};h.toString=function(){return"Simple"+qf.o.toString.call(this)};function Af(a,b,c){a=["ydn.db",a];q(b)&&(a.push(b),q(c)&&(a.push(c),q(void 0)&&a.push(Gc(void 0))));return a.join("^|")};function Z(a,b){this.key=a;this.a=b}Z.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")};function xf(a,b){var c=Q(a.key,b.key);return 0===c?null!=a.a?null!=b.a?Q(a.a,b.a):1:null!=b.a?-1:0:c};function Bf(a){this.u=a||Cf}function Cf(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=Bf.prototype;h.p=null;h.u=null;h.A=null;h.w=null;
function Df(a,b){if(null==a.p)a.p=new Ef(b),a.A=a.p,a.w=a.p;else{var c=null;Ff(a,function(a){var e=null,f=this.u(a.value,b);0<f?(e=a.left,null==a.left&&(c=new Ef(b,a),a.left=c,a==this.A&&(this.A=c))):0>f&&(e=a.right,null==a.right&&(c=new Ef(b,a),a.right=c,a==this.w&&(this.w=c)));return e});c&&(Ff(a,function(a){a.a++;return a.parent},c.parent),Gf(a,c.parent))}}function Hf(a,b){Ff(a,function(a){var d=null,e=this.u(a.value,b);0<e?d=a.left:0>e?d=a.right:If(this,a);return d})}
h.clear=function(){this.w=this.A=this.p=null};h.contains=function(a){var b=!1;Ff(this,function(c){var d=null,e=this.u(c.value,a);0<e?d=c.left:0>e?d=c.right:b=!0;return d});return b};h.indexOf=function(a){var b=-1,c=0;Ff(this,function(d){var e=this.u(d.value,a);if(0<e)return d.left;d.left&&(c+=d.left.a);if(0>e)return c++,d.right;b=c;return null});return b};h.Fa=function(){var a=[];Jf(this,function(b){a.push(b)});return a};
function Jf(a,b){if(a.p){var c,d=c=Kf(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Ff(a,b,c){for(c=c?c:a.p;c&&null!=c;)c=b.call(a,c)}
function Gf(a,b){Ff(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Lf(this,a.left),Mf(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Mf(this,a.right),Lf(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Lf(a,b){Nf(b)?(b.parent.left=b.right,b.right.parent=b.parent):Of(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.p=b.right,a.p.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.a=b.a;b.a-=(c.right?c.right.a:0)+1}
function Mf(a,b){Nf(b)?(b.parent.left=b.left,b.left.parent=b.parent):Of(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.p=b.left,a.p.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.a=b.a;b.a-=(c.left?c.left.a:0)+1}
function If(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Pf(a,b.left);Ff(a,function(a){a.a--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.w&&(a.w=d)}else{d=Kf(a,b.right);Ff(a,function(a){a.a--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=b.parent;
d.left=b.left;d.left&&(d.left.parent=d);b==a.A&&(a.A=d)}d.a=b.a;Nf(b)?b.parent.left=d:Of(b)?b.parent.right=d:a.p=d;Gf(a,c?c:d)}else Ff(a,function(a){a.a--;return a.parent},b.parent),Nf(b)?(b.parent.left=null,b==a.A&&(a.A=b.parent),Gf(a,b.parent)):Of(b)?(b.parent.right=null,b==a.w&&(a.w=b.parent),Gf(a,b.parent)):a.clear()}function Kf(a,b){if(!b)return a.A;var c=b;Ff(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Pf(a,b){if(!b)return a.w;var c=b;Ff(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Ef(a,b){this.value=a;this.parent=b?b:null;this.a=1}Ef.prototype.left=null;Ef.prototype.right=null;Ef.prototype.height=1;function Of(a){return!!a.parent&&a.parent.right==a}function Nf(a){return!!a.parent&&a.parent.left==a};function Qf(a){this.u=a||Cf}C(Qf,Bf);function uf(a,b,c){if(a.p){var d;if(c instanceof Ef)d=c;else if(c){if(Ff(a,function(a){var b=null;0<this.u(a.value,c)?(b=a.left,d=a):0>this.u(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Kf(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function tf(a,b,c){if(a.p){var d;if(c instanceof Ef)d=c;else if(c){if(Ff(a,ga(function(a){var b=null;0<this.u(a.value,c)?b=a.left:(0>this.u(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Pf(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Rf(a,b,c){this.e=a;this.storage=b;this.b=c;this.a={};a=this.b.keyPath;this.c=v(a)?a.join(","):a||"_ROWID_";this.a[this.c]=null;this.d=Af(this.e,this.b.getName(),this.c)+"^|"}
function zf(a,b){var c=b||a.c;if(!a.a[c]){a.a[c]=new Qf(xf);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&0==f.lastIndexOf(a.d,0)){for(var g,k=g=[],l=void 0,n=[],t=void 0,r=void 0,p=new Nc(f.substr(a.d.length));null!=Lc(p);)if(0===p.a)k=n.pop();else{if(null===p.a)break;do{for(var t=p.a/4|0,l=p.a%4,u=0;u<t;u++)r=[],k.push(r),n.push(k),k=r;if(0===l&&12<p.a+4)Lc(p);else break}while(1);1===l?k.push(Kc(p)):2===l?k.push(new Date(Kc(p))):3===l?k.push(Mc(p)):0===l&&(k=n.pop())}g=
g[0];if(c==a.c)Df(a.a[c],new Z(g));else if(k=a.storage.getItem(f),null!==k)if(f=td(a.b,c),k=Gd(k),k=nd(f,k),f.c){if(v(k))for(f=0;f<k.length;f++)Df(a.a[c],new Z(k[f],g))}else Df(a.a[c],new Z(k,g))}}}return a.a[c]}function Sf(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.c)Hf(e,new Z(b));else{var f=td(a.b,d),f=Ec(c,f.keyPath);Hf(e,new Z(b,f))}}}function Tf(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function rf(a,b,c,d){if(null==b&&(a.b.keyPath&&(b=vd(a.b,c)),a.b.c&&null==b)){b=a.d+Gc(void 0);var e=Gd(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,S(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.d+Gc(b)));if(d)return null;a.storage.setItem(a.d+Gc(b),S(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.c)Df(e,new Z(d));else{var g=td(a.b,f),g=Ec(c,g.keyPath);null!=g&&Df(e,new Z(d,g))}return b}
function Uf(a,b){var c=a.d+Gc(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=Gd(d);Sf(a,b,c);return 1}Rf.prototype.clear=function(){Tf(this);Vf(this)};function wf(a,b){var c=a.storage.getItem(a.d+Gc(b)),d=void 0;if(null!==c)for(var d=Gd(c),c=0,e=a.b.a.length;c<e;c++){var f=a.b.index(c);if("DATE"==f.type){var g=nd(f,d);if(g)for(var k=d,g=new Date(g),l=0;l<f.a.length;l++)l==f.a.length-1?k[f.a[l]]=g:B(k[f.a[l]])||(k[f.a[l]]={})}}return d}Rf.prototype.getName=function(){return this.b.getName()};
function Wf(a,b,c){b=b||a.c;a=zf(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new Z(c.lower)),null!=c.upper&&(e=new Z(c.upper)),g=c.lowerOpen,k=c.upperOpen);uf(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=Q(a.key,d.key))){if(null!=e&&(a=Q(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Vf(a,b){var c=zf(a,a.c),d=null,e=null,f=0,g=[],k=[],l=!1,n=!1;null!=b&&(null!=b.lower&&(d=new Z(b.lower)),null!=b.upper&&(e=new Z(b.upper)),l=b.lowerOpen,n=b.upperOpen);uf(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=xf(b,d))){if(null!=e){var c=xf(b,e);if(1===c||0===c&&n)return!0}var c=a.d+Gc(b.key),p=a.storage.getItem(c);null!==p&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(Gd(p))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Sf(a,g[c],k[c]);else Tf(a);return f}
function Xf(a,b,c,d,e,f,g,k,l){function n(c){if(c&&(ja++,!(ja<g))){var d=c.value;if(e){if(Ca&&null!=D&&(c=p?xf(d,D):Q(d.key,D.key),0==c))return;if(null!=A&&(c=p?xf(d,A):Q(d.key,A.key),-1==c||0==c&&na))return l&&(l[0]=void 0,l[1]=void 0),!0}else{if(na&&null!=A&&(c=p?xf(d,A):Q(d.key,A.key),0==c))return;if(null!=D&&(c=p?xf(d,D):Q(d.key,D.key),1==c||0==c&&Ca))return l&&(l[0]=void 0,l[1]=void 0),!0}c=d.key;if(!k||!u||null==r||0!=Q(r,c)){d=u?d.a:c;if(2==b)t.push(d);else if(1==b)t.push(c);else if(3==b)t.push([c,
d]);else if(4==b){var n=wf(a,d);t.push(n)}else t.push([c,d,wf(a,d)]);l&&(l[0]=c,l[1]=d)}r=c;if(q(f)&&t.length>=f)return!0}}var t=[],r,p=!!l&&null!=l[0];c=c||a.c;var u=c!=a.c;c=zf(a,c);var A=null,D=null;q(g)||(g=0);var ja=-1,na=!1,Ca=!1;null!=d&&(null!=d.lower&&(A=u&&e?new Z(d.lower,"\uffff"):new Z(d.lower)),null!=d.upper&&(D=u&&!e?new Z(d.upper,"\uffff"):new Z(d.upper)),na=!!d.lowerOpen,Ca=!!d.upperOpen);if(p){e?Ca=!0:na=!0;d=l[0];var bb=q(l[1])?l[1]:"\uffff";e?D=u?new Z(d,bb):new Z(d):A=u?new Z(d,
bb):new Z(d)}e?tf(c,n,D):uf(c,n,A);return t}Rf.prototype.la=function(a,b,c,d,e){return Xf(this,2,a,b,c,d,e)};Rf.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.e+":"+this.b.getName()};function Yf(){this.clear()}h=Yf.prototype;h.ia=function(){return this};h.setItem=function(a,b){q(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};h.getItem=function(a){return q(this.a[a])?this.a[a]:null};h.removeItem=function(a){delete this.a[a];var b=this.keys;a=F(b,a.toString());0<=a&&Ga.splice.call(b,a,1);this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return q(a)?this.a[a]:null};
h.clear=function(){this.a={};this.keys=[];this.length=0};function Zf(a){this.f=a||new Yf;this.e={}}function yf(a,b){var c=T(a.a,b);if(c)a.e[b]||(a.e[b]=new Rf(a.c,a.d,c));else throw new Ib('store name "'+b+'" not found.');return a.e[b]}function Yd(a,b){setTimeout(function(){var c=Af(a.c),c=a.d.getItem(c),c=new Ld(c);b(c)},10)};function $f(a,b){this.b=a;this.a=b}$f.prototype.h=function(a,b){var c=this.b;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.a("complete",null);d.a=null;d.b=null}};function ag(a,b){this.a=b}C(ag,Ee);ag.prototype.logger=J("ydn.db.crud.req.SimpleStore");
function Xe(a,b,c,d,e,f,g){K(a.logger,Uc(b)+" "+(c?"put":"add")+"Object"+(d?"":"s "+f.length+" objects"));var k=b.a.h(function(a){var n;if(d)n=yf(a,e),a=g?g[0]:void 0,a=rf(n,a,f[0],!c),null!=a?O(b,a):(n=Hd(a),n=new Ae(n),O(b,n,!0));else{for(var t=e,r=[],p=!1,u=g||{},A=0;A<f.length;A++){var D;e?D=u[A]:(t=g[A],D=t.a,t=t.n);n&&n.getName()==t||(n=yf(a,t));D=rf(n,D,f[A],!c);null!=D?r.push(D):(p=!0,r.push(new Ae))}O(b,r,p)}k();k=null},a)}
function Ue(a,b,c,d){var e=b.a.h(function(a){a=wf(yf(a,c),d);O(b,a);e();e=null},a)}function We(a,b,c,d){var e=b.a.h(function(a){for(var g=[],k=c,l,n=0;n<d.length;n++){var t=d[n];t instanceof dd&&(k=t,t=k.a,k=k.n);l&&l.getName()==k||(l=yf(a,k));t=wf(l,t);g[n]=t}O(b,g,!1);e();e=null},a)}function bf(a,b,c,d){var e=Uc(b)+" removeById "+c+" "+d;K(a.logger,e);var f=b.a.h(function(g){g=Uf(yf(g,c),d);L(a.logger,"success "+e+(0==g?" [not found]":""));O(b,g);f();f=null},a)}
function cf(a,b,c){K(a.logger,Uc(b)+" removeByKeys "+c.length+" keys");var d,e=0,f=b.a.h(function(a){for(var k=0;k<c.length;k++){var l=c[k].n,n=c[k].a;d&&d.getName()==l||(d=yf(a,l));e+=Uf(d,n)}O(b,e);f();f=null},a)}function Ze(a,b,c,d){var e=Uc(b)+" removeByKeyRange "+(d?S(d):"");K(a.logger,e);var f=b.a.h(function(g){g=Vf(yf(g,c),d);L(a.logger,e+" deleted "+g+" records.");O(b,g);f();f=null},a)}
function af(a,b,c,d,e){var f=Uc(b)+" removeByIndexKeyRange "+(e?S(e):"");K(a.logger,f);var g=b.a.h(function(a){a=yf(a,c);for(var f=a.la(d,e),n=f.length,t=0;t<n;t++)Uf(a,f[t]);O(b,n);g();g=null},a)}function $e(a,b,c){var d=Uc(b)+" clearByStores";K(a.logger,d);var e=b.a.h(function(a){for(var g=0;g<c.length;g++)yf(a,c[g]).clear();L(this.logger,"success "+d);O(b,c.length);e();e=null},a)}
function Se(a,b,c){var d=b.a.h(function(a){for(var f=[],g=0;g<c.length;g++){var k=yf(a,c[g]);f.push(Wf(k))}O(b,f);d();d=null},a)}function Te(a,b,c,d,e){var f=Uc(b)+" count"+(null!=e?"Index":"")+(null!=d?"KeyRange":"Store");K(a.logger,f);var g=b.a.h(function(a){a=Wf(yf(a,c),e,d);L(this.logger,"success "+f);O(b,a);g();g=null},a)}
function Ve(a,b,c,d,e,f,g,k,l,n){var t=Uc(b)+" "+d+" "+(f?Hd(f):"");K(a.logger,t);var r=b.a.h(function(a){a=Xf(yf(a,d),c,e,f,l,g,k,n,void 0);L(this.logger,t+" "+a.length+" records found.");O(b,a);r();r=null},a)};function Qe(a,b){this.a=b}C(Qe,ag);function ff(a,b,c,d){a=T(a.a,d);return new qf(b,c,a,void 0)};function bg(a){Zf.call(this,a);this.b=NaN}C(bg,Zf);h=bg.prototype;h.logger=J("ydn.db.con.SimpleStorage");
function be(a,b,c){function d(b,c){setTimeout(function(){c?(L(a.logger,a+" opening fail"),e.l(c)):(L(a.logger,a+" version "+a.b+" open"),e.callback(b))},10)}var e=new H;a.d=a.f.ia(b);a.c=b;a.a=c;b=Af(a.c);a.b=NaN;var f=Gd(a.d.getItem(b));q(f.version)&&!y(f.version)&&(f.version=NaN);if(f)if(c=new Ld(f),Pd(a.a,c))if(!a.a.c&&!isNaN(c.version)&&a.a.version>c.version)d(NaN,new Be("existing version "+c.version+" is larger than "+a.a.version));else{f=a.a.version;a.b=q(f)?f:c.version+1;for(f=0;f<a.a.stores.length;f++)var g=
a.a.b(f);if(a.a instanceof Qd)for(f=0;f<c.stores.length;f++)g=c.b(f),a.a.stores.push(g);f=a.a.toJSON();f.version=a.b||NaN;a.d.setItem(b,S(f));d(c.version||NaN)}else{for(f=0;f<a.a.stores.length;f++)g=a.a.b(f);a.b=c.version||NaN;d(a.b)}else c=c.toJSON(),a.b=1,c.version=a.b,a.d.setItem(b,S(c)),d(NaN);return e}h.rb=function(){};h.qb=function(){};h.$a=function(){};h.ea=function(){return"memory"};h.close=function(){};function ee(a,b,c){b(new $f(a,function(a,b){c(a,b)}))}
h.toString=function(){return"SimpleStorage:"+this.ea()+":"+(this.c+":"+this.b)};function cg(){bg.call(this,this)}C(cg,bg);cg.prototype.ia=function(){return window.localStorage};cg.prototype.ea=function(){return"localstorage"};Wc.push(function(a,b){if(!b||"localstorage"==b){var c=new cg,d=new Qd;be(c,a,d);Yd(c,function(a){for(var b=0;b<a.stores.length;b++)yf(c,a.stores[b].getName()).clear()})}});function dg(){bg.call(this,this)}C(dg,bg);dg.prototype.ia=function(){return window.sessionStorage};dg.prototype.ea=function(){return"sessionstorage"};
Wc.push(function(a,b){if(!b||"sessionstorage"==b){var c=new dg,d=new Qd;be(c,a,d);Yd(c,function(a){for(var b=0;b<a.stores.length;b++)yf(c,a.stores[b].getName()).clear()})}});function eg(){};function fg(){}C(fg,eg);fg.prototype.clear=function(){var a=Nb(this.X(!0)),b=this;Ha(a,function(a){b.a.removeAttribute(gg(a));hg(b)})};function ig(a,b){if(Sb&&!(Sb&&9<=ac)){jg||(jg=new Ob);this.a=Object.prototype.hasOwnProperty.call(jg.b,a)?jg.b[a]:void 0;this.a||(b?this.a=document.getElementById(b):(this.a=document.createElement("userdata"),this.a.addBehavior("#default#userData"),document.body.appendChild(this.a)),Pb(jg,a,this.a));this.b=a;try{this.a.load(this.b)}catch(c){this.a=null}}}C(ig,fg);var kg={".":".2E","!":".21","~":".7E","*":".2A","'":".27","(":".28",")":".29","%":"."},jg=null;ig.prototype.a=null;ig.prototype.b=null;
function gg(a){return"_"+encodeURIComponent(a).replace(/[.!~*'()%]/g,function(a){return kg[a]})}ig.prototype.X=function(a){var b=0,c=this.a.XMLDocument.documentElement.attributes,d=new Kb;d.next=function(){if(b>=c.length)throw Jb;var d=c[b++];if(a)return decodeURIComponent(d.nodeName.replace(/\./g,"%")).substr(1);d=d.nodeValue;if(!x(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};
ig.prototype.clear=function(){for(var a=this.a.XMLDocument.documentElement,b=a.attributes.length;0<b;b--)a.removeAttribute(a.attributes[b-1].nodeName);hg(this)};function hg(a){try{a.a.save(a.b)}catch(b){throw"Storage mechanism: Quota exceeded";}};function lg(){bg.call(this,this)}C(lg,bg);lg.prototype.ia=function(a){return new mg(a)};lg.prototype.ea=function(){return"userdata"};function mg(a){this.b=new ig(a);this.length=this.keys().length}h=mg.prototype;h.length=0;h.clear=function(){this.b.clear();this.a=[]};h.keys=function(){this.a||(this.a=[],Mb(this.b,function(a){this.a.push(a)},this));return this.a};h.key=function(a){return this.keys()[a]};h.setItem=function(a,b){this.a&&this.a.push(a);var c=this.b;c.a.setAttribute(gg(a),b);hg(c)};
h.getItem=function(a){a=this.b.a.getAttribute(gg(a));if(!x(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return q(a)?a:null};h.removeItem=function(a){this.a=null;var b=this.b;b.a.removeAttribute(gg(a));hg(b)};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
mf.prototype.wa=function(a){return"localstorage"==a&&window.localStorage?new cg:"sessionstorage"==a&&window.sessionStorage?new dg:"memory"==a?new bg:"userdata"==a?new lg:null};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
mf.prototype.branch=mf.prototype.Pa;mf.prototype.getTxNo=mf.prototype.yb;Pe.prototype.getTxNo=Pe.prototype.xb;mf.prototype.run=mf.prototype.ab;Y.prototype.branch=Y.prototype.Pa;Y.prototype.add=Y.prototype.ta;Y.prototype.get=Y.prototype.G;Y.prototype.keys=Y.prototype.keys;Y.prototype.values=Y.prototype.O;Y.prototype.put=Y.prototype.W;Y.prototype.clear=Y.prototype.clear;Y.prototype.remove=Y.prototype.ua;Y.prototype.count=Y.prototype.V;X.prototype.add=X.prototype.ta;X.prototype.get=X.prototype.G;X.prototype.keys=X.prototype.keys;X.prototype.values=X.prototype.O;X.prototype.put=X.prototype.W;X.prototype.clear=X.prototype.clear;
X.prototype.remove=X.prototype.ua;X.prototype.count=X.prototype.V;ka("ydn.db.Key",dd);dd.prototype.id=dd.prototype.Ta;dd.prototype.parent=dd.prototype.ob;dd.prototype.storeName=dd.prototype.pb;ka("ydn.db.KeyRange",R);R.upperBound=R.upperBound;R.lowerBound=R.lowerBound;R.bound=R.bound;R.only=R.only;R.starts=gd;$c.prototype.store_name=$c.prototype.n;$c.prototype.getStoreName=$c.prototype.a;function ng(a,b,c){Y.call(this,a,b,c)}C(ng,of);ka("ydn.db.Storage",ng);var og=new function(){this.a=ia()};var pg=Ya("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function qg(){this.a=rg}qg.prototype.R=!0;qg.prototype.K=function(){return""};qg.prototype.toString=function(){return"Const{}"};function sg(a){if(a instanceof qg&&a.constructor===qg&&a.a===rg)return"";Fa("expected object of type Const, got '"+a+"'");return"type_error:Const"}var rg={};function tg(){this.a="";this.b=ug}tg.prototype.R=!0;var ug={};tg.prototype.K=function(){return this.a};tg.prototype.toString=function(){return"SafeStyle{"+this.a+"}"};function vg(a){var b=new tg;b.a=a;return b}var wg=vg(""),xg=/^[-.%_!# a-zA-Z0-9]+$/;function yg(){this.a=zg}h=yg.prototype;h.R=!0;h.K=function(){return""};h.ya=!0;h.Q=function(){return 1};h.toString=function(){return"SafeUrl{}"};var zg={};function Ag(){this.a=Bg}h=Ag.prototype;h.R=!0;h.K=function(){return""};h.ya=!0;h.Q=function(){return 1};h.toString=function(){return"TrustedResourceUrl{}"};var Bg={};function Cg(){this.a="";this.c=Dg;this.b=null}h=Cg.prototype;h.ya=!0;h.Q=function(){return this.b};h.R=!0;h.K=function(){return this.a};h.toString=function(){return"SafeHtml{"+this.a+"}"};function Eg(a){if(a instanceof Cg&&a.constructor===Cg&&a.c===Dg)return a.a;Fa("expected object of type SafeHtml, got '"+a+"'");return"type_error:SafeHtml"}function Fg(a){if(a instanceof Cg)return a;var b=null;a.ya&&(b=a.Q());return Gg(ra(a.R?a.K():String(a)),b)}
function Hg(a){if(a instanceof Cg)return a;a=Fg(a);var b;b=Eg(a).replace(/  /g," &#160;").replace(/(\r\n|\r|\n)/g,"<br>");return Gg(b,a.Q())}var Ig=/^[a-zA-Z0-9-]+$/,Jg=Ya("action","cite","data","formaction","href","manifest","poster","src"),Kg=Ya("embed","iframe","link","script","style","template");
function Lg(a,b,c){if(!Ig.test(a))throw Error("Invalid tag name <"+a+">.");if(a.toLowerCase()in Kg)throw Error("Tag name <"+a+"> is not allowed for SafeHtml.");var d=null,e="<"+a;if(b)for(var f in b){if(!Ig.test(f))throw Error('Invalid attribute name "'+f+'".');var g=b[f];if(null!=g){var k,l=a;k=f;if(g instanceof qg)g=sg(g);else if("style"==k.toLowerCase()){if(!B(g))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof g+" given: "+g);if(!(g instanceof
tg)){var l="",n=void 0;for(n in g){if(!/^[-_a-zA-Z0-9]+$/.test(n))throw Error("Name allows only [-_a-zA-Z0-9], got: "+n);var t=g[n];null!=t&&(t instanceof qg?t=sg(t):xg.test(t)||(Fa("String value allows only [-.%_!# a-zA-Z0-9], got: "+t),t="zClosurez"),l+=n+":"+t+";")}g=l?vg(l):wg}g instanceof tg&&g.constructor===tg&&g.b===ug?g=g.a:(Fa("expected object of type SafeStyle, got '"+g+"'"),g="type_error:SafeStyle")}else{if(/^on/i.test(k))throw Error('Attribute "'+k+'" requires goog.string.Const value, "'+
g+'" given.');if(k.toLowerCase()in Jg)if(g instanceof Ag)g instanceof Ag&&g.constructor===Ag&&g.a===Bg?g="":(Fa("expected object of type TrustedResourceUrl, got '"+g+"'"),g="type_error:TrustedResourceUrl");else if(g instanceof yg)g instanceof yg&&g.constructor===yg&&g.a===zg?g="":(Fa("expected object of type SafeUrl, got '"+g+"'"),g="type_error:SafeUrl");else throw Error('Attribute "'+k+'" on tag "'+l+'" requires goog.html.SafeUrl or goog.string.Const value, "'+g+'" given.');}g.R&&(g=g.K());k=k+'="'+
ra(String(g))+'"';e=e+(" "+k)}}q(c)?v(c)||(c=[c]):c=[];!0===pg[a.toLowerCase()]?e+=">":(d=Mg(c),e+=">"+Eg(d)+"</"+a+">",d=d.Q());(a=b&&b.dir)&&(/^(ltr|rtl|auto)$/i.test(a)?d=0:d=null);return Gg(e,d)}function Mg(a){function b(a){v(a)?Ha(a,b):(a=Fg(a),d+=Eg(a),a=a.Q(),0==c?c=a:0!=a&&c!=a&&(c=null))}var c=0,d="";Ha(arguments,b);return Gg(d,c)}var Dg={};function Gg(a,b){var c=new Cg;c.a=a;c.b=b;return c}var Ng=Gg("",0);function Og(a){this.e=a||"";this.f=og}Og.prototype.c=!0;Og.prototype.a=!0;Og.prototype.b=!1;function Pg(a){a=new Date(a.f);return Qg(a.getFullYear()-2E3)+Qg(a.getMonth()+1)+Qg(a.getDate())+" "+Qg(a.getHours())+":"+Qg(a.getMinutes())+":"+Qg(a.getSeconds())+"."+Qg(Math.floor(a.getMilliseconds()/10))}function Qg(a){return 10>a?"0"+a:String(a)}function Rg(a,b){var c=(a.f-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Sg(a){Og.call(this,a)}C(Sg,Og);
Sg.prototype.b=!0;Sg.prototype.d=function(a){return a?Tg(this,a).K():""};
function Tg(a,b){var c;switch(b.e.value){case jc.value:c="dbg-sh";break;case kc.value:c="dbg-sev";break;case lc.value:c="dbg-w";break;case mc.value:c="dbg-i";break;default:c="dbg-f"}var d=[];d.push(a.e," ");a.a&&d.push("[",Pg(b),"] ");d.push("[",Rg(b,a.f.a),"s] ");d.push("[",b.c,"] ");var d=Hg(d.join("")),e=Ng;a.b&&b.b&&(e=Mg(Lg("br"),Hg(b.a||"")));var f=Hg(b.d);c=Lg("span",{"class":c},Mg(f,e));return a.c?Mg(d,c,Lg("br")):Mg(d,c)}function Ug(a){Og.call(this,a)}C(Ug,Og);
Ug.prototype.d=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Pg(a),"] ");b.push("[",Rg(a,this.f.a),"s] ");b.push("[",a.c,"] ");b.push(a.d);this.b&&a.b&&b.push("\n",a.a);this.c&&b.push("\n");return b.join("")};function Vg(){this.e=ga(this.f,this);this.a=new Ug;this.a.a=!1;this.a.b=!1;this.b=this.a.c=!1;this.c="";this.d={}}Vg.prototype.f=function(a){if(!this.d[a.c]){var b=this.a.d(a),c=Wg;if(c)switch(a.e){case jc:Xg(c,"info",b);break;case kc:Xg(c,"error",b);break;case lc:Xg(c,"warn",b);break;default:Xg(c,"debug",b)}else this.c+=b}};var Wg=m.console;function Xg(a,b,c){if(a[b])a[b](c);else a.log(c)};var Yg=!Sb||Sb&&9<=ac;!Tb&&!Sb||Sb&&Sb&&9<=ac||Tb&&Zb("1.9.1");Sb&&Zb("9");function Zg(a,b){Ua(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in $g?a.setAttribute($g[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var $g={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function ah(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!w(f)||B(f)&&0<f.nodeType?d(f):Ha(bh(f)?Oa(f):f,d)}}function bh(a){if(a&&"number"==typeof a.length){if(B(a))return"function"==typeof a.item||"string"==typeof a.item;if(z(a))return"function"==typeof a.item}return!1}function ch(a){this.a=a||m.document||document}
function dh(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
ch.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Yg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',ra(g.name),'"');if(g.type){f.push(' type="',ra(g.type),'"');var k={};Xa(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:v(g)?f.className=g.join(" "):Zg(f,g));2<e.length&&ah(d,f,e);return f};
ch.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function eh(a){Sb&&q(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"}
;function fh(a){this.e=ga(this.f,this);this.b=new Sg;this.c=this.b.a=!1;this.a=a;this.d=this.a.ownerDocument||this.a.document;a=(a=this.a)?new ch(9==a.nodeType?a:a.ownerDocument||a.document):oa||(oa=new ch);var b=null,c=a.a;Sb&&c.createStyleSheet?(b=c.createStyleSheet(),eh(b)):(c=dh(a,"head")[0],c||(b=dh(a,"body")[0],c=a.b("head"),b.parentNode.insertBefore(c,b)),b=a.b("style"),eh(b),c.appendChild(b));this.a.className+=" logdiv"}
fh.prototype.f=function(a){if(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.d.createElement("div");c.className="logmsg";a=Tg(this.b,a);c.innerHTML=Eg(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)}};fh.prototype.clear=function(){this.a&&(this.a.innerHTML=Eg(Ng))};Sb&&Zb("9");!Ub||Zb("528");Tb&&Zb("1.9b")||Sb&&Zb("8")||Rb&&Zb("9.5")||Ub&&Zb("528");Tb&&!Zb("8")||Sb&&Zb("9");var gh=null,hh=null;J("ydn.debug");ka("ydn.debug.log",function(a,b,c){a=a||"ydn";if(y(b))b=new ic("log",b);else if(x(b)){b=b.toUpperCase();if(!sc){sc={};for(var d=0,e;e=rc[d];d++)sc[e.value]=e,sc[e.name]=e}b=sc[b]||null}else b=oc;(d=J(a))?d.b=b:window.console.log("logger "+a+" not available.");q(c)?!hh&&(a=hh=new fh(c),1!=a.c&&(c=xc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.c=!0),a=xc())&&(a.b=lc):!gh&&!hh&&(a=gh=new Vg,1!=a.b&&(c=xc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.b=!0),a=xc())&&(a.b=lc)});of.prototype.scan=of.prototype.tb;of.prototype.map=of.prototype.map;of.prototype.reduce=of.prototype.sa;of.prototype.open=of.prototype.open;df.prototype.scan=df.prototype.Ka;df.prototype.map=df.prototype.map;df.prototype.reduce=df.prototype.sa;df.prototype.open=df.prototype.open;fe.prototype.getKey=fe.prototype.ub;fe.prototype.getPrimaryKey=fe.prototype.F;fe.prototype.getValue=fe.prototype.ga;fe.prototype.update=fe.prototype.vb;fe.prototype.clear=fe.prototype.clear;ka("ydn.db.Iterator",V);
ka("ydn.db.KeyIterator",ne);ka("ydn.db.ValueIterator",pe);ka("ydn.db.IndexIterator",oe);ka("ydn.db.IndexValueIterator",qe);V.prototype.getState=V.prototype.Wa;V.prototype.getKeyRange=V.prototype.ib;V.prototype.getIndexName=V.prototype.gb;V.prototype.getStoreName=V.prototype.kb;V.prototype.isReversed=V.prototype.S;V.prototype.isUnique=V.prototype.ra;V.prototype.isKeyIterator=V.prototype.lb;V.prototype.isIndexIterator=V.prototype.Xa;V.prototype.getPrimaryKey=V.prototype.jb;V.prototype.getKey=V.prototype.hb;
V.prototype.resume=V.prototype.nb;V.prototype.reset=V.prototype.mb;V.prototype.reverse=V.prototype.reverse;ne.where=function(a,b,c,d,e){return new ne(a,kd(b,c,d,e))};pe.where=function(a,b,c,d,e){return new pe(a,kd(b,c,d,e))};oe.where=function(a,b,c,d,e,f){return new oe(a,b,kd(c,d,e,f))};qe.where=function(a,b,c,d,e,f){return new qe(a,b,kd(c,d,e,f))};ka("ydn.db.Streamer",ve);ve.prototype.push=ve.prototype.push;ve.prototype.collect=ve.prototype.Sa;ve.prototype.setSink=ve.prototype.cb;function ih(a,b){ye.call(this,a,b)}C(ih,ye);ih.prototype.f=function(){return!1};ih.prototype.c=function(a,b){function c(b){q(a[b])?(e=!1,d[b]=!0):(d[b]=!1,0<=b-1&&c(b-1))}var d=[],e=!0;c(a.length-1);e&&(d=[]);return ze(this,d,b)};function jh(a,b){ye.call(this,a,b)}C(jh,ye);
jh.prototype.c=function(a,b){var c=[],d=b[0];if(null==d)return[];for(var e=!0,f=!1,g=d,k=[],l=1;l<a.length;l++)if(null!=b[l]){var n=Q(d,b[l]);k[l]=n;this.b?-1==n?e=!1:1==n&&(e=!1,f=!0,-1==Q(b[l],g)&&(g=b[l])):1==n?e=!1:-1==n&&(e=!1,f=!0,1==Q(b[l],g)&&(g=b[l]))}else e=!1,f=!0;if(e)for(f=0;f<a.length;f++)null!=b[f]&&(c[f]=!0);else if(f)for(f=0;f<a.length;f++)null!=b[f]&&(this.b?-1==Q(g,b[f])&&(c[f]=g):1==Q(g,b[f])&&(c[f]=g));else for(l=this.b?-1:1,f=1;f<a.length;f++)k[f]===l&&(c[f]=d);return e?(this.e++,
this.a&&this.a.push(g),c):{continuePrimary:c}};function kh(a,b){ye.call(this,a,b)}C(kh,ye);kh.prototype.logger=J("ydn.db.algo.ZigzagMerge");
kh.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}function d(a){return a[a.length-1]}var e=[];if(0==a.length||null==a[0]||null==a[0])return[];for(var f=!0,g=0,k=d(a[g]),l=[],n=1;n<a.length;n++)if(null!=a[n]){var t=d(a[n]),r=Q(k,t);l[n]=r;this.b?-1==r?f=!1:1==r&&(f=!1,k=t,g=1):1==r?f=!1:-1==r&&(f=!1,k=t,g=1)}else return[];n=this.b?-1:1;if(f){for(f=0;f<a.length;f++)null!=a[f]&&(e[f]=!0);this.a&&(this.d?this.a.push(b[0],k):this.a.push(b[0]));return e}if(0==g)for(f=
1;f<a.length;f++)l[f]==n&&(e[f]=c(a[f],k));else for(f=0;f<a.length;f++)f!=g&&null!=a[f]&&Q(k,d(a[f]))===n&&(e[f]=c(a[f],k));return{"continue":e}};ka("ydn.db.algo.NestedLoop",ih);ka("ydn.db.algo.ZigzagMerge",kh);ka("ydn.db.algo.SortedMerge",jh); 

//# sourceMappingURL=ydn.db-wu-core-cur-dev.js.map
return ydn;}, (this || {}));
            
(function (name, definition, context) {if (typeof context['module'] !== 'undefined' && context['module']['exports']) {context['module']['exports'] = definition.apply(context);}else if (typeof context['define'] !== 'undefined' && context['define'] === 'function' && context['define']['amd']) {define(name, [], definition);}else {context[name] = definition();}})('ydn', function () {var k,m=this;function q(a){return void 0!==a}
function aa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function u(a){return"array"==aa(a)}function w(a){var b=aa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function ba(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ca(a){return"function"==aa(a)}function z(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var da="closure_uid_"+(1E9*Math.random()>>>0),ea=0;
function fa(a,b,c){return a.call.apply(a.bind,arguments)}function ga(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function ha(a,b,c){ha=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?fa:ga;return ha.apply(null,arguments)}
function ia(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var ka=Date.now||function(){return+new Date};function ma(a,b){var c=a.split("."),d=m;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&q(b)?d[e]=b:d[e]?d=d[e]:d=d[e]={}}
function B(a,b){function c(){}c.prototype=b.prototype;a.p=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.hb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function na(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function oa(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function C(a){if(Error.captureStackTrace)Error.captureStackTrace(this,C);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}B(C,Error);C.prototype.name="CustomError";var pa;function qa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}var ra=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
function sa(a){if(!ta.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(ua,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(wa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(xa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(ya,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(za,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(Aa,"&#0;"));return a}
var ua=/&/g,wa=/</g,xa=/>/g,ya=/"/g,za=/'/g,Aa=/\x00/g,ta=/[\x00&<>"']/,Ba={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Da={"'":"\\'"};
function Ea(a){a=String(a);if(!a.quote){for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=c+1,g;if(!(g=Ba[d])){if(!(31<e&&127>e))if(d in Da)d=Da[d];else if(d in Ba)d=Da[d]=Ba[d];else{e=d;g=d.charCodeAt(0);if(31<g&&127>g)e=d;else{if(256>g){if(e="\\x",16>g||256<g)e+="0"}else e="\\u",4096>g&&(e+="0");e+=g.toString(16).toUpperCase()}d=Da[d]=e}g=d}b[f]=g}b.push('"')}}function Fa(a,b){return a<b?-1:a>b?1:0};function Ga(a,b){b.unshift(a);C.call(this,qa.apply(null,b));b.shift()}B(Ga,C);Ga.prototype.name="AssertionError";function Ha(a,b){throw new Ga("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Ia=Array.prototype,D=Ia.indexOf?function(a,b,c){return Ia.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ja=Ia.forEach?function(a,b,c){Ia.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ka=Ia.map?function(a,b,c){return Ia.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},La=Ia.some?function(a,b,c){return Ia.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function Ma(a,b){var c=Na(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}function Na(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function Oa(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Pa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Qa(a,b){if(!w(a)||!w(b)||a.length!=b.length)return!1;for(var c=a.length,d=Ra,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function Ra(a,b){return a===b};var Sa;a:{var Ta=m.navigator;if(Ta){var Ua=Ta.userAgent;if(Ua){Sa=Ua;break a}}Sa=""}function E(a){return-1!=Sa.indexOf(a)};function Va(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Wa(a,b){for(var c=w(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],q(a));c++);return a}var Xa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ya(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Xa.length;f++)c=Xa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}
function Za(a){var b=arguments.length;if(1==b&&u(arguments[0]))return Za.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};function bb(a){m.setTimeout(function(){throw a;},0)}var cb;
function db(){var a=m.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&(a=function(){var a=document.createElement("iframe");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=ha(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},
this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!E("Trident")&&!E("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(q(c.next)){c=c.next;var a=c.va;c.va=null;a()}};return function(a){d.next={va:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("script")?function(a){var b=document.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=
null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){m.setTimeout(a,0)}};function eb(a,b){fb||gb();hb||(fb(),hb=!0);ib.push(new jb(a,b))}var fb;function gb(){if(m.Promise&&m.Promise.resolve){var a=m.Promise.resolve();fb=function(){a.then(kb)}}else fb=function(){var a=kb;!ca(m.setImmediate)||m.Window&&m.Window.prototype.setImmediate==m.setImmediate?(cb||(cb=db()),cb(a)):m.setImmediate(a)}}var hb=!1,ib=[];[].push(function(){hb=!1;ib=[]});function kb(){for(;ib.length;){var a=ib;ib=[];for(var b=0;b<a.length;b++){var c=a[b];try{c.a.call(c.b)}catch(d){bb(d)}}}hb=!1}
function jb(a,b){this.a=a;this.b=b};function lb(a,b){this.b=mb;this.f=void 0;this.a=this.e=null;this.c=this.d=!1;try{var c=this;a.call(b,function(a){nb(c,ob,a)},function(a){try{if(a instanceof Error)throw a;throw Error("Promise rejected.");}catch(b){}nb(c,pb,a)})}catch(d){nb(this,pb,d)}}var mb=0,ob=2,pb=3;lb.prototype.then=function(a,b,c){return qb(this,ca(a)?a:null,ca(b)?b:null,c)};na(lb);function rb(a,b){a.a&&a.a.length||a.b!=ob&&a.b!=pb||sb(a);a.a||(a.a=[]);a.a.push(b)}
function qb(a,b,c,d){var e={Z:null,za:null,Aa:null};e.Z=new lb(function(a,g){e.za=b?function(c){try{var e=b.call(d,c);a(e)}catch(n){g(n)}}:a;e.Aa=c?function(b){try{var e=c.call(d,b);a(e)}catch(n){g(n)}}:g});e.Z.e=a;rb(a,e);return e.Z}lb.prototype.h=function(a){this.b=mb;nb(this,ob,a)};lb.prototype.i=function(a){this.b=mb;nb(this,pb,a)};
function nb(a,b,c){if(a.b==mb){if(a==c)b=pb,c=new TypeError("Promise cannot resolve to itself");else{if(oa(c)){a.b=1;c.then(a.h,a.i,a);return}if(z(c))try{var d=c.then;if(ca(d)){tb(a,c,d);return}}catch(e){b=pb,c=e}}a.f=c;a.b=b;sb(a);b!=pb||ub(a,c)}}function tb(a,b,c){function d(b){f||(f=!0,a.i(b))}function e(b){f||(f=!0,a.h(b))}a.b=1;var f=!1;try{c.call(b,e,d)}catch(g){d(g)}}function sb(a){a.d||(a.d=!0,eb(a.j,a))}
lb.prototype.j=function(){for(;this.a&&this.a.length;){var a=this.a;this.a=[];for(var b=0;b<a.length;b++){var c=a[b],d=this.f;if(this.b==ob)c.za(d);else{if(c.Z)for(var e=void 0,e=this;e&&e.c;e=e.e)e.c=!1;c.Aa(d)}}}this.d=!1};function ub(a,b){a.c=!0;eb(function(){a.c&&vb.call(null,b)})}var vb=bb;/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function G(a,b){this.h=[];this.K=b||null;this.b=this.c=!1;this.e=void 0;this.L=this.D=this.i=!1;this.f=0;this.d=null;this.o=0}k=G.prototype;k.aa=function(a,b){this.i=!1;wb(this,a,b)};function wb(a,b,c){a.c=!0;a.e=c;a.b=!b;a.ma()}function xb(a){if(a.c){if(!a.L)throw new yb;a.L=!1}}k.callback=function(a){xb(this);wb(this,!0,a)};k.k=function(a){xb(this);wb(this,!1,a)};k.t=function(a,b){return zb(this,a,null,b)};k.Ga=function(a,b){return zb(this,null,a,b)};k.ua=function(a,b){return zb(this,a,a,b)};
function zb(a,b,c,d){a.h.push([b,c,d]);a.c&&a.ma();return a}k.then=function(a,b,c){var d,e,f=new lb(function(a,b){d=a;e=b});zb(this,d,function(a){e(a)});return f.then(a,b,c)};na(G);function Ab(a,b){b instanceof G?a.t(ha(b.ra,b)):a.t(function(){return b})}G.prototype.ra=function(a){var b=new G;zb(this,b.callback,b.k,b);a&&(b.d=this,this.o++);return b};function Bb(a){return La(a.h,function(a){return ca(a[1])})}
G.prototype.ma=function(){this.f&&this.c&&Bb(this)&&(Cb(this.f),this.f=0);this.d&&(this.d.o--,delete this.d);for(var a=this.e,b=!1,c=!1;this.h.length&&!this.i;){var d=this.h.shift(),e=d[0],f=d[1],d=d[2];if(e=this.b?f:e)try{var g=e.call(d||this.K,a);q(g)&&(this.b=this.b&&(g==a||g instanceof Error),this.e=a=g);oa(a)&&(this.i=c=!0)}catch(h){a=h,this.b=!0,Bb(this)||(b=!0)}}this.e=a;c&&(c=ha(this.aa,this,!0),g=ha(this.aa,this,!1),a instanceof G?(zb(a,c,g),a.D=!0):a.then(c,g));b&&(a=new Db(a),Eb[a.da]=
a,this.f=a.da)};function Fb(a){var b=new G;b.callback(a);return b}function yb(){C.call(this)}B(yb,C);yb.prototype.message="Deferred has already fired";yb.prototype.name="AlreadyCalledError";function Db(a){this.da=m.setTimeout(ha(this.b,this),0);this.a=a}Db.prototype.b=function(){delete Eb[this.da];throw this.a;};var Eb={};function Cb(a){var b=Eb[a];b&&(m.clearTimeout(b.da),delete Eb[a])};function H(a){C.call(this,a);this.name="ydn.error.ArgumentException"}B(H,C);function Gb(a){C.call(this,a);this.name="ydn.error.TypeError"}B(Gb,C);function Hb(a){C.call(this,a);this.name="ydn.error.NotSupportedException"}B(Hb,C);function Ib(a){C.call(this,a);this.name="ydn.error.NotImplementedException"}B(Ib,C);function Jb(a){C.call(this,a);this.name="ydn.error.InvalidOperationException"}B(Jb,C);
function Kb(a){Error.captureStackTrace?Error.captureStackTrace(this,Kb):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}B(Kb,Error);Kb.prototype.name="ydn.error.InternalError";var Lb="StopIteration"in m?m.StopIteration:Error("StopIteration");function Mb(){}Mb.prototype.next=function(){throw Lb;};Mb.prototype.S=function(){return this};function Nb(a){if(a instanceof Mb)return a;if("function"==typeof a.S)return a.S(!1);if(w(a)){var b=0,c=new Mb;c.next=function(){for(;;){if(b>=a.length)throw Lb;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function Ob(a,b,c){if(w(a))try{Ja(a,b,c)}catch(d){if(d!==Lb)throw d;}else{a=Nb(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(e){if(e!==Lb)throw e;}}}function Pb(a){if(w(a))return Pa(a);a=Nb(a);var b=[];Ob(a,function(a){b.push(a)});return b};function Qb(a,b){this.b={};this.a=[];this.d=this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)Rb(this,arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof Qb)e=a.ca(),d=a.wa();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)Rb(this,e[c],d[c])}}k=Qb.prototype;k.wa=function(){Sb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};
k.ca=function(){Sb(this);return this.a.concat()};k.clear=function(){this.b={};this.d=this.c=this.a.length=0};function Sb(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Object.prototype.hasOwnProperty.call(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Object.prototype.hasOwnProperty.call(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}
function Rb(a,b,c){Object.prototype.hasOwnProperty.call(a.b,b)||(a.c++,a.a.push(b),a.d++);a.b[b]=c}k.forEach=function(a,b){for(var c=this.ca(),d=0;d<c.length;d++){var e=c[d];a.call(b,Object.prototype.hasOwnProperty.call(this.b,e)?this.b[e]:void 0,e,this)}};k.clone=function(){return new Qb(this)};
k.S=function(a){Sb(this);var b=0,c=this.a,d=this.b,e=this.d,f=this,g=new Mb;g.next=function(){for(;;){if(e!=f.d)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw Lb;var g=c[b++];return a?g:d[g]}};return g};var Tb=E("Opera")||E("OPR"),I=E("Trident")||E("MSIE"),Ub=E("Gecko")&&-1==Sa.toLowerCase().indexOf("webkit")&&!(E("Trident")||E("MSIE")),Vb=-1!=Sa.toLowerCase().indexOf("webkit");Vb&&E("Mobile");E("Macintosh");E("Windows");E("Linux");var Wb=m.navigator||null;Wb&&(Wb.appVersion||"").indexOf("X11");E("Android");!E("iPhone")||E("iPod")||E("iPad");E("iPad");function Xb(){var a=m.document;return a?a.documentMode:void 0}
var Yb=function(){var a="",b;if(Tb&&m.opera)return a=m.opera.version,ca(a)?a():a;Ub?b=/rv\:([^\);]+)(\)|;)/:I?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Vb&&(b=/WebKit\/(\S+)/);b&&(a=(a=b.exec(Sa))?a[1]:"");return I&&(b=Xb(),b>parseFloat(a))?String(b):a}(),Zb={};
function $b(a){var b;if(!(b=Zb[a])){b=0;for(var c=ra(String(Yb)).split("."),d=ra(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var t=l.exec(g)||["","",""],r=n.exec(h)||["","",""];if(0==t[0].length&&0==r[0].length)break;b=Fa(0==t[1].length?0:parseInt(t[1],10),0==r[1].length?0:parseInt(r[1],10))||Fa(0==t[2].length,0==r[2].length)||Fa(t[2],r[2])}while(0==b)}b=Zb[a]=0<=b}return b}
var ac=m.document,bc=ac&&I?Xb()||("CSS1Compat"==ac.compatMode?parseInt(Yb,10):5):void 0;function cc(a){var b;b||(b=dc(a||arguments.callee.caller,[]));return b}
function dc(a,b){var c=[];if(0<=D(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(ec(a)+"(");for(var d=a.arguments,e=0;d&&e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=ec(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(dc(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function ec(a){if(fc[a])return fc[a];a=String(a);if(!fc[a]){var b=/function ([^\(]+)/.exec(a);fc[a]=b?b[1]:"[Anonymous]"}return fc[a]}var fc={};function gc(a,b,c,d,e){"number"==typeof e||hc++;this.f=d||ka();this.e=a;this.d=b;this.c=c;delete this.b;delete this.a}gc.prototype.b=null;gc.prototype.a=null;var hc=0;function ic(a){this.e=a;this.a=this.d=this.b=this.c=null}function jc(a,b){this.name=a;this.value=b}jc.prototype.toString=function(){return this.name};var kc=new jc("SHOUT",1200),lc=new jc("SEVERE",1E3),mc=new jc("WARNING",900),nc=new jc("INFO",800),oc=new jc("CONFIG",700),pc=new jc("FINE",500),qc=new jc("FINER",400),rc=new jc("FINEST",300),sc=[new jc("OFF",Infinity),kc,lc,mc,nc,oc,pc,qc,rc,new jc("ALL",0)],tc=null;ic.prototype.getName=function(){return this.e};
function uc(a){if(a.b)return a.b;if(a.c)return uc(a.c);Ha("Root logger has no level set.");return null}ic.prototype.log=function(a,b,c){if(a.value>=uc(this).value)for(ca(b)&&(b=b()),a=this.f(a,b,c,ic.prototype.log),b="log:"+a.d,m.console&&(m.console.timeStamp?m.console.timeStamp(b):m.console.markTimeline&&m.console.markTimeline(b)),m.msWriteProfilerMark&&m.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=void 0;f=c.a[e];e++)f(d);b=b.c}};
ic.prototype.f=function(a,b,c,d){var e=new gc(a,String(b),this.e);if(c){var f;f=d||arguments.callee.caller;e.b=c;var g;try{var h;var l;c:{for(var n=["window","location","href"],t=m,r;r=n.shift();)if(null!=t[r])t=t[r];else{l=null;break c}l=t}if(x(c))h={message:c,name:"Unknown error",lineNumber:"Not available",fileName:l,stack:"Not available"};else{var p,v,n=!1;try{p=c.lineNumber||c.ib||"Not available"}catch(A){p="Not available",n=!0}try{v=c.fileName||c.filename||c.sourceURL||m.$googDebugFname||l}catch(F){v=
"Not available",n=!0}h=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||"Not available",name:c.name||"UnknownError",lineNumber:p,fileName:v,stack:c.stack||"Not available"}}g="Message: "+sa(h.message)+'\nUrl: <a href="view-source:'+h.fileName+'" target="_new">'+h.fileName+"</a>\nLine: "+h.lineNumber+"\n\nBrowser stack:\n"+sa(h.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+sa(cc(f)+"-> ")}catch(ja){g="Exception trying to expose exception! You win, we lose. "+ja}e.a=g}return e};
var vc={},wc=null;function xc(){wc||(wc=new ic(""),vc[""]=wc,wc.b=oc)}function yc(){xc();return wc}function J(a){xc();var b;if(!(b=vc[a])){b=new ic(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=J(a.substr(0,c));c.d||(c.d={});c.d[d]=b;b.c=c;vc[a]=b}return b};function zc(a,b){a&&a.log(mc,b,void 0)}function Ac(a,b){a&&a.log(pc,b,void 0)};function K(a,b){a&&a.log(rc,b,void 0)}function L(a,b){a&&a.log(qc,b,void 0)};function Bc(a,b){G.call(this,0,b);this.n=[]}B(Bc,G);Bc.prototype.qa=function(a,b){this.n.push([a,b]);return this};Bc.prototype.callback=function(a){this.n.length=0;Bc.p.callback.call(this,a)};Bc.prototype.k=function(a){this.n.length=0;Bc.p.k.call(this,a)};Bc.prototype.Ra=function(){return this};var Cc={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Dc=Cc.READ_ONLY,M=Cc.READ_WRITE,Ec=Cc.VERSION_CHANGE,Fc=m.indexedDB||m.mozIndexedDB||m.webkitIndexedDB||m.moz_indexedDB||m.msIndexedDB;G.prototype.done=G.prototype.t;G.prototype.fail=G.prototype.Ga;G.prototype.always=G.prototype.ua;Bc.prototype.then=Bc.prototype.then;function Gc(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=w(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],q(a));c++);return a}function Hc(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)z(a[e])||(a[e]={}),a=a[e];a[d]=c}}var Ic={};
function Jc(a){var b=[a];a=new Kc;for(var c=0,d,e;void 0!==(e=b.pop());){0===c%4&&12<c+4&&(a.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){b.push(Ic);for(d=e.length;d--;)b.push(e[d]);continue}else a.write(c);else if("number"===d)c+=1,a.write(c),Lc(a,e);else if(e instanceof Date)c+=2,a.write(c),Lc(a,e.valueOf());else if("string"===d){c+=3;a.write(c);c=a;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,
f>>2|255,(f|3)<<6)}c.write(0)}else if(e===Ic)a.write(0);else return"";c=0}for(b=a.a.length;"00"===a.a[--b];);a.a.length=++b;return a.toString()}
function Lc(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Nc(a){var b=Oc(a)|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=Oc(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(Oc(a)|0):Oc(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Pc(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=Oc(a);if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Qc(a){this.a=null;this.b=a;this.c=this.b.length-1;this.index=-1}function Oc(a){return a.a=a.index<a.c?parseInt(a.b.charAt(++a.index)+a.b.charAt(++a.index),16):null}
function Kc(){this.a=[];this.b=void 0}Kc.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};Kc.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Rc(a,b){var c=Jc(a),d=Jc(b);return c>d?1:c==d?0:-1};function N(a,b,c){Bc.call(this,0,c);this.w=a;this.n=[];this.j=[];this.ga=[];this.a=null;this.V=""}B(N,Bc);k=N.prototype;k.V="";k.logger=J("ydn.db.Request");function Sc(a,b,c){a.a=b;a.V=c;L(a.logger,a+" BEGIN");if(b){for(c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b);a.j.length=0}}function Tc(a){L(a.logger,a+" END");a.a=null}k.Ha=function(){return!!this.a};
k.abort=function(){L(this.logger,this+" aborting "+this.a);if(this.a)if(ca(this.a.abort))this.a.abort();else if(ca(this.a.executeSql))this.a.executeSql("ABORT",[],function(){},function(){return!0});else throw new Hb;else throw new Uc(this+" No active transaction");};function O(a,b,c){var d=a.ga.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){O(a,b,c)}):c?a.k(b):a.callback(b)}function Vc(a,b,c){a.ga.push([b,c])}function P(a,b,c){a.a?b.call(c,a.a):a.j.push([b,c])}
k.callback=function(a){L(this.logger,this+" SUCCESS");N.p.callback.call(this,a)};k.k=function(a){L(this.logger,this+" ERROR");N.p.k.call(this,a)};k.state=function(){return this.c?this.b?"rejected":"resolved":"pending"};function Wc(a){var b="";a.V&&(b=a.a?"*":"",b="["+a.V+b+"]");return a.w+b}function Xc(a,b){var c=new N(a);O(c,b);return c}k.toString=function(){return"Request:"+Wc(this)};
k.ma=function(){this.f&&this.c&&Bb(this)&&(Cb(this.f),this.f=0);this.d&&(this.d.o--,delete this.d);for(var a=this.e,b=!1;this.h.length&&!this.i;){var c=this.h.shift(),d=c[0],e=c[1],c=c[2];if(d=this.b?e:d)d=d.call(c||this.K,a),q(d)&&(this.b=this.b&&(d==a||d instanceof Error),this.e=a=d),oa(a)&&(this.i=b=!0)}this.e=a;b&&(b=ha(this.aa,this,!0),d=ha(this.aa,this,!1),a instanceof G?(zb(a,b,d),a.D=!0):a.then(b,d))};
k.toJSON=function(){var a=(this.V||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.w?this.w.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var Q=Fc&&Fc.cmp?ha(Fc.cmp,Fc):Rc,Yc=[];function Zc(){0!=$c&&(this[da]||(this[da]=++ea));this.D=this.D;this.ga=this.ga}var $c=0;Zc.prototype.D=!1;function ad(a,b){this.type=a;this.target=b};function bd(a,b){ad.call(this,a,b)}B(bd,ad);bd.prototype.a=function(){return this.m};function cd(a,b,c,d,e){ad.call(this,a,b);this.version=c;this.Ca=d;this.ya=e}B(cd,bd);k=cd.prototype;k.name="ReadyEvent";k.version=NaN;k.Ca=NaN;k.ya=null;k.eb=function(){return this.version};k.Ka=function(){return this.Ca};k.Ja=function(){return this.ya};function dd(a,b,c){ad.call(this,c||"error",a);this.error=b}B(dd,bd);dd.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};
dd.prototype.name="ErrorEvent";dd.prototype.error=null;dd.prototype.b=function(){return this.error};function ed(a,b){dd.call(this,a,b,"fail")}B(ed,dd);ed.prototype.name="FailEvent";function fd(a,b,c){var d;if(z(a))d=a.store,b=a.id,null!=a.parent&&(c=new fd(a.parent));else if(q(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new fd(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!q(b))throw Error("Invalid key value: "+a);this.m=d;this.a=b;this.parent=c||null}k=fd.prototype;k.toJSON=function(){var a={store:this.m,id:this.a};this.parent&&(a.parent=this.parent.toJSON());return a};
k.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.m+"^:"+this.a};k.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};k.Wa=function(){return this.m};k.Ia=function(){return this.a};k.Va=function(){return this.parent};function gd(a){if(w(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function R(a,b,c,d){a>b&&(b=a=void 0);null===a&&(a=void 0);null===b&&(b=void 0);this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d}R.prototype.lower=void 0;R.prototype.upper=void 0;R.prototype.toJSON=function(){return hd(this)};R.only=function(a){return new R(a,a,!1,!1)};R.bound=function(a,b,c,d){return new R(a,b,c,d)};R.upperBound=function(a,b){return new R(void 0,a,void 0,!!b)};R.lowerBound=function(a,b){return new R(a,void 0,!!b,void 0)};
function id(a){var b;if(u(a))b=Pa(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return R.only(a);return R.bound(a,b,!1,!0)}function hd(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function jd(a){return null!=a?null!=a.upper&&null!=a.lower?kd.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?kd.upperBound(a.upper,a.upperOpen):null!=a.lower?kd.lowerBound(a.lower,a.lowerOpen):null:null}function ld(a){if(a instanceof R)return"";if(null!=a){if(z(a)){for(var b in a){var c;if(c=a.hasOwnProperty(b))c=!(0<=D(["lower","upper","lowerOpen","upperOpen"],b));if(c)return'invalid attribute "'+b+'" in key range object'}return""}return"key range must be an object"}return""}
function md(a,b){var c=a.lower,d=a.upper,e=a.lowerOpen,f=a.upperOpen;null!=b.lower&&(null==a.lower||b.lower>=a.lower)&&(c=b.lower,e=b.lowerOpen||a.lowerOpen);null!=b.upper&&(null==a.upper||b.upper<=a.upper)&&(d=b.upper,f=b.upperOpen||a.upperOpen);return R.bound(c,d,e,f)}
function nd(a,b,c,d){var e,f,g,h;if("starts"==a||"^"==a)return id(b);if("<"==a||"<="==a)e=b,g="<"==a;else if(">"==a||">="==a)f=b,h=">"==a;else if("="==a||"=="==a)e=f=b;else throw new H("invalid op: "+a);if("<"==c||"<="==c)e=d,g="<"==c;else if(">"==c||">="==c)f=d,h=">"==c;else if(q(c))throw new H("invalid op2: "+c);return R.bound(f,e,h,g)}var kd=m.IDBKeyRange||m.webkitIDBKeyRange||R;function od(a,b,c,d,e,f){q(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!x(a)&&!w(a))throw new H("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!q(a)&&q(e)&&(a=e);this.keyPath=a;this.h=w(this.keyPath);this.b=e;this.type=pd(b);if(q(b)){if(!q(this.type))throw new H("type invalid in index: "+this.b);if(u(this.keyPath))throw new H('composite key for store "'+this.b+'" must not specified type');}this.d=!!c;this.c=!!d;this.f=x(e)?e:u(a)?this.keyPath.join(","):
a;Ea(this.f);this.a=this.h?null:this.keyPath.split(".");this.e=f||null}function qd(a,b){if(null!=b){if(w(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=Gc(b,a.keyPath[d]);c[d]=f}return c}return Gc(b,a.keyPath)}}var rd=["BLOB","DATE","INTEGER","NUMERIC","TEXT"];function pd(a){if(x(a))return a=D(rd,a),rd[a]}k=od.prototype;k.getName=function(){return this.b};k.toJSON=function(){return{name:this.b,keyPath:this.keyPath,type:this.type,unique:this.d,multiEntry:this.c}};
k.clone=function(){var a=u(this.keyPath)?Pa(this.keyPath):this.keyPath;return new od(a,this.type,this.d,this.c,this.b,this.e)};function sd(a,b){return null!=a||null!=b?null!=a?null!=b?w(a)&&w(b)?Qa(a,b)?null:"expect: "+a+", but: "+b:td(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}k.hint=function(a){if(!a)return this;var b=u(this.keyPath)?Pa(this.keyPath):this.keyPath,c=this.type;q(a.type)||"TEXT"!=c||(c=void 0);return new od(b,c,this.d,this.c,a.b)};
k.toString=function(){var a=this.c?"MultiEntry":"";this.a&&1<this.a.length&&(a+="Compound");return a+"Index:"+this.b};function ud(a,b,c,d,e,f,g,h){if(!x(a))throw new H("store name must be a string");this.b=a;this.keyPath=q(b)?b:null;this.e=w(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.e)throw new H("keyPath must be a string or array");if(null!=c&&!ba(c))throw new H('invalid autoIncrement value in store "'+a+'"');this.c=!!c;var l;if(null!=d){l=pd(d);if(!q(l))throw new H('type "'+d+'" for primary key in store "'+this.b+'" is invalid.');if(this.e)throw new H('composite key for store "'+this.b+'" must not specified type');
}this.type=null!=l?l:this.c?"INTEGER":void 0;this.d=x(this.keyPath)?this.keyPath.split("."):[];this.a=e||[];this.I=!!f;this.Da=!!g;this.i=u(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";Ea(this.i);if(this.h=!!h){if(this.keyPath)throw new H('encrypted store "'+this.b+'" must not use inline key');if(this.c)throw new H('encrypted store "'+this.b+'" must not use key generator');}this.f=[]}k=ud.prototype;k.I=!1;k.Da=!1;
k.toJSON=function(){for(var a=[],b=0;b<this.a.length;b++)a.push(this.a[b].toJSON());return{name:this.b,keyPath:this.keyPath,autoIncrement:this.c,type:this.type,indexes:a}};
function vd(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==D(b,c))throw new H('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==D(f,g))throw new H("Unknown field: "+g+" in "+S(e));e=new od(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
q(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new ud(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}k.clone=function(){return vd(this.toJSON())};k.index=function(a){return this.a[a]||null};function wd(a,b){return Ma(a.a,function(a){return a.getName()==b})}function xd(a,b){for(var c=0;c<a.a.length;c++)if(!sd(a.a[c].keyPath,b))return a.a[c];return null}
function yd(a,b){return b===a.keyPath?!0:La(a.a,function(a){return a.getName()==b})}k.getName=function(){return this.b};function zd(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.e){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(Gc(b,a.keyPath[d]));return c}if(a.keyPath)return Wa(b,a.d)}}function Ad(a,b,c){for(var d=0;d<a.d.length;d++){var e=a.d[d];if(d==a.d.length-1){b[e]=c;break}q(b[e])||(b[e]={});b=b[e]}}
function Bd(a,b){if(!b)return"missing store: "+a.b;if(a.b!=b.b)return"store name, expect: "+a.b+", but: "+b.b;var c=sd(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(q(a.c)&&q(b.c)&&a.c!=b.c)return"autoIncrement, expect:  "+a.c+", but: "+b.c;if(a.a.length!=b.a.length)return"indexes length, expect:  "+a.a.length+", but: "+b.a.length;if(q(a.type)&&q(b.type)&&(w(a.type)?!Qa(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.a.length;c++){var d=wd(b,a.a[c].getName()),
e;e=a.a[c];if(d)if(e.b!=d.b)e="name, expect: "+e.b+", but: "+d.b;else{var f=sd(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.d&&null!=d.d&&e.d!=d.d?"unique, expect: "+e.d+", but: "+d.d:null!=e.c&&null!=d.c&&e.c!=d.c?"multiEntry, expect: "+e.c+", but: "+d.c:q(e.type)&&q(d.type)&&(w(e.type)?!Qa(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.b;if(0<e.length)return'index "'+a.a[c].getName()+'" '+e}return""}
function Cd(a,b){if(b)for(var c=0;c<a.a.length;c++){var d=a.a[c],e=b;if(d.e){var f=d.e(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.a.length-1;g++)z(e[d.a[g]])||(e[d.a[g]]={});e[d.a[d.a.length-1]]=f}}}}function Dd(a,b,c,d,e){for(var f=0;f<a.f.length;f++)d!==f&&a.f[f].call(e,b,c)}k.toString=function(){return"Store:"+this.b+"["+this.a.length+"index]"};function Ed(a){return eval("("+a+")")}function Fd(){}
function Gd(a,b,c){switch(typeof b){case "string":Hd(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),Gd(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),Hd(e,c),c.push(":"),Gd(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var Id={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Jd=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Hd(a,b){b.push('"',a.replace(Jd,function(a){if(a in Id)return Id[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Id[a]=e+b.toString(16)}),'"')};J("ydn");function Kd(a){return!x(a)||/^[\s\xa0]*$/.test(a)?{}:"undefined"==typeof m.JSON?Ed(a):JSON.parse(a)}function Ld(a){var b;try{b=S(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function S(a){if("undefined"==typeof m.JSON){var b=[];Gd(new Fd,a,b);a=b.join("")}else a=JSON.stringify(a,void 0,void 0);return a};function Md(a,b){if(!a||/^[\s\xa0]*$/.test(a))throw new H("store_name must be provided for primary full text index");if(!b||/^[\s\xa0]*$/.test(b))throw new H("index_name must be provided for primary full text index");this.m=a};function Nd(a,b,c){this.name=a;this.a=b;this.b=c||"";if(-1==["","en","fr"].indexOf(this.b))throw new H('Unsupported lang "'+c+" for full text search index "+a);}Nd.prototype.getName=function(){return this.name};Nd.prototype.index=function(a){return this.a[a]};
function Od(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==D(b,c))throw new H("Unknown field: "+c+" in "+S(a));if(!u(a.sources))throw new H("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==D(b,c))throw new H("Unknown field: "+c+" in "+Ld(a));return new Md(a.storeName,a.keyPath)});return new Nd(a.name,
b,a.lang)};function Pd(a,b){var c,d,e=b;if(z(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==D(c,f))throw new H("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new H("stores must be array");for(f=0;f<g.length;f++){var h=vd(g[f]);if(-1!=Na(e,function(a){return a.name==h.getName()}))throw new H('duplicate store name "'+h.getName()+'".');e.push(h)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(q(c)){if(!y(c)||0>c)throw new H("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(q(b)&&(!u(b)||0<b.length&&!(b[0]instanceof ud)))throw new H("stores");this.version=c;this.b=!q(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Od(d.fullTextCatalogs[f]),c[f]=e,T(this,e.getName())||(g=[new od("k","TEXT"),new od("v","TEXT")],e=new ud(e.getName(),"id",!1,void 0,g,!1,!1,!1),this.stores.push(e));this.c=c}
Pd.prototype.toJSON=function(){var a=Ka(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;q(this.version)&&(b.version=this.version);return b};Pd.prototype.b=!1;Pd.prototype.a=function(){return!1};function Rd(a){return Ka(a.stores,function(a){return a.getName()})}function T(a,b){return Ma(a.stores,function(a){return a.getName()==b})}function Sd(a,b){return La(a.stores,function(a){return a.getName()==b})}
function Td(a,b){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var c=0;c<a.stores.length;c++){var d=T(b,a.stores[c].getName());if(d){if(d=Bd(a.stores[c],d),0<d.length)return'store: "'+a.stores[c].getName()+'" '+d}else return'missing object store "'+a.stores[c].getName()+'"'}return""};function Ud(a,b){Pd.call(this,a,b)}B(Ud,Pd);Ud.prototype.a=function(){return!0};function Vd(a){Error.captureStackTrace?Error.captureStackTrace(this,Vd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}B(Vd,Error);B(Vd,Error);function Wd(a){Error.captureStackTrace?Error.captureStackTrace(this,Wd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}B(Wd,Error);Wd.prototype.name="ydn.InternalError";
function Xd(a){Error.captureStackTrace?Error.captureStackTrace(this,Xd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}B(Xd,Error);Xd.prototype.name="ydn.error.ConstraintError";function Yd(a){Error.captureStackTrace?Error.captureStackTrace(this,Yd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}B(Vd,Error);
function Zd(a){Error.captureStackTrace?Error.captureStackTrace(this,Zd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}B(Zd,Error);function td(a,b){var c;c=c||{};if(null!=a&&null!=b){if(w(a)&&w(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Ma(b,function(b){return td(b,a[d])}))return!1;return!0}if(w(a))return 1==a.length&&td(a[0],b);if(w(b))return 1==b.length&&td(b[0],a);if(z(a)&&z(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=td(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=td(a[e],b[e]),!f))return!1;return!0}return a===b}return!1};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function U(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==D(d,e))throw new H('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new H("mechanisms attribute must be an array but "+aa(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!(0<=D($d,c.mechanisms[e])))throw new H('Invalid mechanism "'+c.mechanisms[e]+'"');}this.n=c.mechanisms||$d;this.a=null;this.d=
[];this.ea=!1;var f;if(b instanceof Pd)f=b;else if(z(b))for(c.autoSchema||!q(b.stores)?f=new Ud(b):f=new Pd(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=T(f,b.stores[e].name),b.stores[e].Sync&&zc(this.logger,"Synchronization option for "+d.getName()+" ignored.");else f=new Ud;this.b=f;for(e=0;e<this.b.stores.length;e++)if((this.b.stores[e]||null).h)throw Error("encryption option must be defined");q(a)&&this.j(a);this.e=new G}U.prototype.logger=J("ydn.db.con.Storage");
U.prototype.o=function(a){if(q(a)){var b=function(b){a(b.toJSON());a=void 0};if(this.a)ae(this.a,b);else{var c=this;this.X(function(){ae(c.a,b)},null,Dc)}}return this.b?this.b.toJSON():null};U.prototype.j=function(a){if(this.a)throw new Jb("Already connected with "+this.h);this.h=a;be(this)};U.prototype.getName=function(){return this.h};var $d="indexeddb sqlite websql localstorage sessionstorage userdata memory".split(" ");k=U.prototype;k.la=function(){return null};
function be(a){function b(b,e){b?(K(a.logger,a+": ready."),a.xa=NaN,d.ab=function(){},d.bb=function(){a.a=null},d.Na=function(){},setTimeout(function(){ce(a,e);de(a)},10),c.callback(e)):(zc(a.logger,a+": database connection fail "+e.name),setTimeout(function(){ce(a,new ed(a,e));if(a.d){var b=a.logger;for(b&&b.log(nc,"Purging "+a.d.length+" transactions request.",void 0);b=a.d.shift();)b.s&&b.s("error",e)}},10),c.k(e))}for(var c=new G,d=null,e=a.n,f=0;f<e.length;f++){var g=e[f].toLowerCase();if(d=
a.la(g)){d=a.la(g);break}}null===d?(e=new Xd("No storage mechanism found."),b(!1,new ed(a,e))):zb(ee(d,a.h,a.b),function(a){this.a=d;b(!0,new cd("ready",this,parseFloat(d.b),parseFloat(a),null))},function(a){zc(this.logger,this+": opening fail");b(!1,a)},a)}k.ia=function(){if(this.a)return this.a.W()};k.fa=function(a,b){this.e.ua(a,b)};function ce(a,b){setTimeout(function(){a.b.b&&a.e.c||(b instanceof dd?a.e.k(b.error):a.e.callback())},4)}function fe(a){return!!a.a&&!!a.a.c}
k.close=function(){this.a&&(this.a.close(),this.a=null,K(this.logger,this+" closed"))};k.cb=function(){return this.a?this.a.d||null:null};k.xa=NaN;function de(a){var b=a.d.shift();b&&(K(a.logger,"pop tx queue["+(a.d.length+1)+"]"),a.X(b.ba,b.Sa,b.mode,b.s));a.xa=ka()}
function ge(a,b,c,d,e){K(a.logger,"push tx queue["+a.d.length+"]");a.d.push({ba:b,Sa:c,mode:d,s:e});100<a.d.length&&0==a.d.length%100&&zc(a.logger,"Transaction queue stack size is "+a.d.length+". It is too large, possibility due to incorrect usage.")}k.ea=!1;
k.X=function(a,b,c,d){var e=b;if(x(b))e=[b];else if(null!=b)if(w(b)){if(0==b.length)throw new H("number of store names must more than 0");for(var f=0;f<b.length;f++)if(!x(b[f]))throw new H("store name at "+f+" must be string but found "+typeof b[f]);}else throw new H("store names must be an array");else e=null;if(this.a&&this.a.c&&!this.ea){var g=this,h=q(c)?c:Dc;h==Ec&&(this.ea=!0);he(this.a,function(b){a(b);a=null},function(a,b){ca(d)&&(d(a,b),d=void 0);h==Ec&&(g.ea=!1);de(g)})}else ge(this,a,e,
c,d)};k.toString=function(){return"Storage:"+this.a};U.prototype.close=U.prototype.close;U.prototype.getType=U.prototype.ia;U.prototype.getName=U.prototype.getName;U.prototype.getSchema=U.prototype.o;U.prototype.onReady=U.prototype.fa;U.prototype.setName=U.prototype.j;U.prototype.transaction=U.prototype.X;U.prototype.db=U.prototype.cb;ma("ydn.db.version","1.1.2");ma("ydn.db.cmp",Q);ma("ydn.db.deleteDatabase",function(a,b){for(var c,d=0;d<Yc.length;d++){var e=Yc[d](a,b);e&&(c=e)}return c||Xc("IDBVersionChangeEvent ",null)});cd.prototype.name=cd.prototype.name;
cd.prototype.getVersion=cd.prototype.eb;cd.prototype.getOldVersion=cd.prototype.Ka;cd.prototype.getOldSchema=cd.prototype.Ja;dd.prototype.getError=dd.prototype.b;N.prototype.abort=N.prototype.abort;N.prototype.canAbort=N.prototype.Ha;Bc.prototype.progress=Bc.prototype.qa;Bc.prototype.promise=Bc.prototype.Ra;function ie(a,b,c,d){Zc.call(this);this.ra=c;this.m=c.getName();this.T=void 0;this.e=!1;this.l=null;this.w=a;this.L=b;this.i=this.h=!1;this.qa=d||4;this.d=this.b=this.a=void 0;this.f=function(){throw new Kb;};this.j=function(){throw new Kb;};this.K=function(){}}B(ie,Zc);
function je(a,b,c,d,e){if(q(b)){var f=a.ra,g,h=b;u(b)?(g=xd(f,b),h=b.join(", ")):g=wd(f,b);if(!g)throw new H('require index "'+h+'" not found in store "'+f.getName()+'"');b=g.getName();a.T=b}a.e=x(a.T);a.l=c||null;a.h=!1;a.i=!1;a.reverse="prev"==d||"prevunique"==d;a.Ba="nextunique"==d||"prevunique"==d;a.pa=e;a.a=void 0;a.b=void 0;a.d=void 0}k=ie.prototype;k.l=null;k.Ba=!1;k.reverse=!1;k.pa=!0;k.logger=J("ydn.db.core.req.AbstractCursor");
k.toString=function(){return"Cursor:"+this.m+(q(this.T)?":"+this.T:"")+"["+(this.w?"":"~")+this.L+"]"};function ke(a){null!=a.b?a.b=gd(a.b):a.b=void 0;null!=a.a?a.a=gd(a.a):a.a=void 0;a.K(a.i,a.a,a.b)}k.open=function(a,b,c,d){this.w=a;this.L=b;this.h=this.i=!1;this.a=c;this.b=d;le(this,this.a,this.b)};function me(a){a.i=!0;K(a.logger,a+": exit");ke(a)}function ne(a){return a.e?a.b:a.a}function oe(a){return a.pa?ne(a):a.d}k.ta=function(){};k.Y=function(){};
function pe(a,b,c){K(a.logger,a+" restarting");a.h=!1;a.i=!1;le(a,c,b)};function qe(){};function re(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name must be a string, but "+a+" found.");this.b=a;this.d=b;this.f=g;this.n=!!this.d;if(q(d)&&!ba(d))throw new H("reverse value must be a boolean, but "+typeof d+" found");if(q(e)&&!ba(e))throw new H("unique value must be a boolean, but "+typeof e+" found");if(q(f)&&!ba(f))throw new H("key_only value must be a boolean, but "+typeof f+" found");this.c=q(f)?f:!!x(this.d);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.h=
a;if(d=ld(c))throw new H("Invalid key range: "+d);this.a=jd(c);this.e=se;this.o=NaN}B(re,qe);re.prototype.c=!0;var se="init";k=re.prototype;k.logger=J("ydn.db.Iterator");k.clone=function(){var a=new re(this.b,this.d,this.a,te(this),ue(this),this.c,this.f);a.o=this.o;return a};k.toJSON=function(){return{store:this.b,index:this.d,keyRange:this.a?hd(this.a):null,direction:this.h}};
k.toString=function(){var a=q(this.f)?":"+this.f.join(","):q(this.d)?":"+this.d:"",b;if(b=this.a){var c=b.lowerOpen?"(":"[";null!=b.lower&&(c+=b.lower+", ");null!=b.upper&&(c+=b.upper);b=c+=b.upperOpen?")":"]"}else b="";a+=b;this.e!=se&&(a+=this.e+"{"+this.i,this.n&&(a+=", "+this.j),a+="}");b=this.n?"Index":"";b+=this.c?"Key":"Value";return b+"Iterator:"+this.b+a};function ve(a,b,c){a=new re(a.b,a.d,a.a,te(a),ue(a),a.c,a.f);a.i=b;a.j=c;a.e="rest";return a}
k.reverse=function(){return new re(this.b,this.d,this.a,!te(this),ue(this),this.c,this.f)};function te(a){return"prev"===a.h||"prevunique"===a.h}function ue(a){return"nextunique"===a.h||"prevunique"===a.h}k.load=function(a){a=a[0];je(a,this.f||this.d,this.a,this.h,this.c);this.e="busy";var b=this;a.K=function(a,d,e){b.i=d;b.j=e;b.e=a?"rest":"done"};le(a,this.i,this.j);return a};
function we(a,b,c,d){b=b||se;"busy"==a.e?zc(a.logger,a+": resetting state to "+b+" ignore during iteration"):(a.i=c,a.j=d,a.e=b)}k.stores=function(){return[this.b]};function xe(a){if(null!=a&&!("push"in a))throw new Vd('output receiver object must have "push" method.');this.b=a||null;this.a=!1}xe.prototype.logger=J("ydn.db.algo.AbstractSolver");
function ye(a,b){a.a=te(b[0]);for(var c=0;c<b.length;c++){if(!(b[c]instanceof re))throw new Gb("item at iterators "+c+" is not an iterator.");if(0<c&&a.a!=te(b[c]))throw new Gb("iterator at "+c+" must "+(a.a?"be reverse":"not be reverse"));}for(var d="{",c=0;c<b.length;c++)0<c&&(d+=", "),d+=b.toString();d+="}";a.a&&(d+=" reverse");Ac(a.logger,a+" begin "+d);return!1}xe.prototype.c=function(){return[]};function ze(a){Error.captureStackTrace?Error.captureStackTrace(this,ze):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}B(ze,Error);ze.prototype.name="ConstraintError";ze.prototype.toString=function(){return this.name+": "+this.message};function Ae(a){Error.captureStackTrace?Error.captureStackTrace(this,Ae):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}B(Ae,Error);Ae.prototype.name="ydn.db.VersionError";
Ae.prototype.toString=function(){return this.name+": "+this.message};function Uc(a){Error.captureStackTrace?Error.captureStackTrace(this,Uc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}B(Uc,Error);function Be(a){Error.captureStackTrace?Error.captureStackTrace(this,Be):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}B(Be,Error);Be.prototype.name="NotFoundError";Be.prototype.toString=function(){return this.name+": "+this.message};
function Ce(a){Error.captureStackTrace?Error.captureStackTrace(this,Ce):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}B(Ce,Error);function De(a,b){this.a=b}De.prototype.logger=J("ydn.db.crud.req.RequestExecuto");De.prototype.toString=function(){return"RequestExecutor"};function Ee(a){this.c=a;this.a=null;this.b=0}Ee.prototype.logger=J("ydn.db.tr.Mutex");Ee.prototype.u=null;function Fe(a){return!!a.a&&!a.d}Ee.prototype.s=null;Ee.prototype.toString=function(){return"Mutex:"+("B"+this.c+"T"+this.b)+(this.a?"*":"")};function Ge(a,b,c,d,e,f){this.D=a;this.K=b;this.a=this.d=0;this.w=d;this.o=e;this.e=c||He;this.i=f||0}Ge.prototype.logger=J("ydn.db.tr.Thread");Ge.prototype.type=function(){return this.D.ia()};Ge.prototype.g=function(){return this.D};Ge.prototype.r=function(){return"B"+this.K+"T"+this.d};var He="single";function Ie(a){if(a)if(ca(a.abort))a.abort();else if(ca(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Hb;else throw new Uc("No active transaction");};function Je(a,b,c,d,e,f){Ge.call(this,a,b,c,d,e,f);this.c=[];this.f=[];this.h=null;this.b=new Ee(b);this.j=f||0;this.n=!1}B(Je,Ge);k=Je.prototype;k.logger=J("ydn.db.tr.Serial");
function Ke(a,b,c){if("multi"==a.e)a:if(a=a.b,!a.u||!a.mode||c!=a.mode&&(a.mode!=M||c!=Dc)||b.length>a.u.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.u.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.e)a:if(a=a.b,a.u&&a.mode&&c==a.mode&&a.u.length==b.length){for(c=0;c<b.length;c++)if(-1==a.u.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.e?!0:!1;return b}function Le(a){var b=0<a.c.length?a.c[0].u:null,c=0<a.c.length?a.c[0].mode:null;return null!=b&&null!=c?Ke(a,b,c):!1}
function Me(a,b,c,d,e){K(a.logger,"push tx queue["+a.c.length+"]");a.c.push({ba:b,u:c,mode:d,s:e})}k.abort=function(){L(this.logger,this+": aborting");Ie(this.h)};
k.M=function(a,b,c,d){var e=x(b)?[b]:b;if(w(e)){if(0==e.length)throw new H("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new H("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.L&&!(0<=D(this.L,e[f])))throw new H('store name "'+f+e[f]+'" in scope of '+this);}}else throw new H("store names must be an array");var g=q(c)?c:Dc,h=this;if(this.b.a||!fe(this.g())&&this.n)Me(this,a,b,g,d);else{var l=this.r();d&&this.f.push(d);if(this.j&&
this.d>=this.j)throw new Jb("Exceed maximum number of transactions of "+this.j);this.n=!0;this.g().X(function(c){var d=h.b;d.a=c;d.d=!1;d.u=b;d.mode=g;d.b++;d.s=null;l=h.r();Ac(h.logger,l+" BEGIN "+S(b)+" "+g);a(h);for(a=null;Le(h);)c=h.c.shift(),c.s&&h.f.push(c.s),K(h.logger,"pop tx queue"+(h.c.length+1)+" reusing T"+h.d),c.ba()},e,g,function(a,b){Ac(h.logger,l+" "+a);var c=h.b;c.a?(c.a=null,c.u=null,c.mode=null,ca(c.s)&&c.s(a,b),c.s=null):zc(c.logger,c+" has no TX to be unlocked for "+a);for(c=
0;c<h.f.length;c++)(0,h.f[c])(a,b);h.f.length=0;(c=h.c.shift())&&h.M(c.ba,c.u,c.mode,c.s);h.a=0})}};k.r=function(){var a=this.b;return"B"+a.c+"T"+a.b};k.request=function(a,b,c,d){function e(a,b){Tc(f);d&&d(a,b)}var f=new N(a);a=c||Dc;var g=this;Fe(this.b)&&Ke(this,b,a)?(b=this.b.a,this.a++,Sc(f,b,this.r()+"R"+this.a),this.f.push(e)):g.M(function(){var a=g.b.a;g.a++;Sc(f,a,g.r()+"R"+g.a)},b,a,e);return f};
k.G=function(a,b,c,d,e){d=d||Dc;var f=this,g;if(Fe(f.b)&&Ke(this,c,d)){var h=f.b.a;f.a++;g=f.r()+"R"+f.a;L(f.logger,g+" BEGIN");b(h,g,function(b,c){f.h=h;c?(L(f.logger,g+" ERROR"),a.k(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.h=null});L(f.logger,g+" END");b=null}else f.M(function(){var c=f.b.a;f.a++;g=f.r()+"R"+f.a;L(f.logger,g+" BEGIN");b(c,g,function(b,d){f.h=c;d?(L(f.logger,g+" ERROR"),a.k(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.h=null});L(f.logger,g+" END");b=null},c,d,e)};
k.getName=function(){return this.g().getName()};k.toString=function(){return"Serial:"+this.r()+(this.h?"*":"")};function Ne(a,b){Je.call(this,a,b)}B(Ne,Je);Ne.prototype.logger=J("ydn.db.tr.AtomicSerial");Ne.prototype.request=function(a,b,c){var d,e,f,g=Ne.p.request.call(this,a,b,c,function(a,b){Tc(g);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new Ce;O(g,c,!0)}});Vc(g,function(a,b,c){f=b;e=a;d=c});return g};
Ne.prototype.G=function(a,b,c,d,e){var f,g,h=new G;zb(h,function(a){g=!1;f=a},function(a){g=!0;f=a});Ne.p.G.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.k(c);else if(!0===g)a.k(f);else if(!1===g)a.callback(f);else{var d=new Ce;a.k(d)}e&&(e(b,c),e=void 0)})};Ne.prototype.toString=function(){return"Atomic"+Ne.p.toString.call(this)};function Oe(a,b,c){this.d=a;this.b=b;this.a=c;this.c=null}k=Oe.prototype;k.logger=J("ydn.db.tr.DbOperator");k.fb=function(){return this.a.d};k.abort=function(){this.a.abort()};function V(a){if(!a.c){var b;b=a.d;var c=b.ia();if("memory"==c||"localstorage"==c||"sessionstorage"==c)b=new Pe(0,b.b);else throw new Kb("No executor for "+c);a.c=b}return a.c}k.g=function(){return this.d};
function Qe(a,b){var c=a.g(),d=b instanceof ud?b:vd(b),e=b.name,f=T(c.b,e);if(0==Bd(d,f).length)Fb(!1);else if(f=f?"update":"add",c.b instanceof Ud)c.b.stores.push(d),c.a?(c.a.close(),c.a=null,be(c)):Fb(!1);else throw new Xd("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}k.toString=function(){return"TxStorage:"+this.g().getName()};function W(a,b,c){Oe.call(this,a,b,c)}B(W,Oe);k=W.prototype;k.logger=J("ydn.db.crud.DbOperator");
k.C=function(a,b,c,d){var e,f,g,h;if(null!=a)if(u(a)){if(q(c)||q(b))throw new H("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Sd(this.b,f[l]))throw new H('store name "'+f[l]+'" at '+l+" not found.");L(this.logger,"countStores: "+S(f));e=this.a.request("count",f);P(e,function(){Re(V(this),e,f)},this)}else if(x(a)){l=T(this.b,a);if(!l)throw new H('store name "'+a+'" not found.');if(q(d)&&!ba(d))throw new H('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,z(c)){var n=ld(c);if(n)throw new H("invalid key range: "+Ld(c)+" "+n);h=jd(c)}else{if(null!=c)throw new H("invalid key range: "+Ld(c)+" of type "+typeof c);h=null}else if(z(b)||null==b)if(z(b)){if(n=ld(b))throw new H("invalid key range: "+Ld(b)+" "+n);h=jd(b)}else{if(null!=b)throw new H("key range must be  an object but found "+Ld(b)+" of type "+typeof b);h=null}else throw new H('invalid second argument for count "'+Ld(c)+'" of type '+typeof b);L(this.logger,"countKeyRange: "+a+" "+(g?g:"")+S(h));
e=this.a.request("count",f);Dd(l,e,arguments);P(e,function(){Se(V(this),e,f[0],h,g)},this)}else throw new H("Invalid store name or store names.");else zc(this.logger,"count method requires store name(s)"),l=Rd(this.b),e=this.a.request("count",l),Vc(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),P(e,function(){Re(V(this),e,f)},this);return e};
k.F=function(a,b){var c=this,d;if(a instanceof fd){var e=a,f=e.m,g=T(this.b,f);if(!g){if(this.b.a()){if(fe(this.g()))return Xc("get",void 0);d=new N("get");this.g().fa(function(){zb(c.F(a,b),function(a){d.callback(a)},function(a){d.k(a)})});return d}throw new H("Store: "+f+" not found.");}var h=e.a;L(this.logger,"getByKey: "+f+":"+h);d=this.a.request("get:key",[f]);Dd(g,d,arguments,void 0,this);P(d,function(){Te(V(this),d,f,h)},this)}else if(x(a)&&q(b)){var l=a,g=T(this.b,l);if(!g){if(this.b.a()){if(fe(this.g()))return Xc("get",
void 0);d=new N("get");this.g().fa(function(){zb(c.F(a,b),function(a){d.callback(a)},function(a){d.k(a)})});return d}throw new H('Store name "'+l+'" not found.');}var n=b;L(this.logger,"getById: "+l+":"+n);d=this.a.request("get",[l]);Dd(g,d,arguments,void 0,this);P(d,function(){Te(V(this),d,l,n)},this)}else throw new H("get require valid input arguments.");return d};
k.Ma=function(a,b,c,d,e){var f=T(this.b,a),g,h,l,n=null;if(z(b)){var t=ld(b);if(t)throw new H("invalid key range: "+b+" "+t);n=jd(b)}else if(null!=b)throw new H('expect key range object, but found "'+Ld(b)+'" of type '+typeof b);if(q(c))if(y(c))g=c;else throw new H("limit must be a number, but "+c+" is "+typeof c);else g=100;if(q(d))if(y(d))h=d;else throw new H("offset must be a number, but "+d+" is "+typeof d);else h=0;if(q(e))if(ba(e))l=e;else throw new H("reverse must be a boolean, but "+e+" is "+
typeof e);L(this.logger,"keysByKeyRange: "+a);var r=this.a.request("keys",[a]);Dd(f,r,arguments);P(r,function(){Ue(V(this),r,2,a,null,n,g,h,l,!1)},this);return r};
k.La=function(a,b,c,d,e,f,g){var h,l,n,t,r,p=ld(c);if(p)throw new H("invalid key range: "+c+" "+p);p=T(this.b,a);h=jd(c);if(y(d))l=d;else{if(q(d))throw new H("limit must be a number");l=100}if(y(e))n=e;else{if(q(e))throw new H("offset must be a number");n=0}if(q(f))if(ba(f))t=f;else throw new H("reverse must be a boolean");if(q(g))if(ba(g))r=g;else throw new H("unique must be a boolean");L(this.logger,"keysByIndexKeyRange: "+a);var v=this.a.request("keys:iter:index",[a]);Dd(p,v,arguments);P(v,function(){Ue(V(this),
v,2,a,b,h,l,n,t,r)},this);return v};k.keys=function(a,b,c,d,e,f,g){var h=T(this.b,a);if(!x(a))throw new H("store name must be a string, but "+a+" of type "+typeof a+" is not.");if(!this.b.a()){if(!h)throw new H('store name "'+a+'" not found.');if(x(b)&&!wd(h,b))throw new H('index "'+b+'" not found in store "'+a+'".');}return this.b.a()&&!h?Xc("keys",[]):x(b)?this.La(a,b,c,d,e,f,g):this.Ma(a,b,c,d,e)};
k.N=function(a,b,c,d,e,f,g){var h=this,l;if(x(a)){var n=a,t=T(this.b,n);if(!t){if(this.b.a()){if(fe(this.g()))return Xc("values",[]);l=new N("values");this.g().fa(function(){zb(h.N(a,b,c,d,e,f),function(a){l.callback(a)},function(a){l.k(a)})});return l}throw new Be(n);}if(u(b)){if(q(c)||q(d))throw new H("too many input arguments");var r=b;L(this.logger,"listByIds: "+n+" "+r.length+" ids");l=this.a.request("values:array",[n]);Dd(t,l,arguments,void 0,this);P(l,function(){var a=V(this);Ve(a,l,n,r)},
this)}else l=x(b)?this.Ta(n,b,c,d,e,f,g):this.Ua(n,b,c,d,e)}else if(u(a))if(a[0]instanceof fd){for(var t=[],p=a,v=0;v<p.length;v++){var A=p[v].m;if(!Sd(this.b,A)){if(this.b.a())return t=[],t[p.length-1]=void 0,Xc("get",t);throw new H("Store: "+A+" not found.");}0<=D(t,A)||t.push(A)}L(this.logger,"listByKeys: "+S(t)+" "+p.length+" keys");l=this.a.request("values:keys",t);P(l,function(){var a=V(this);Ve(a,l,null,p)},this)}else throw new H("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+
typeof a[0]+" found.");else throw new H("first argument "+a+" is invalid.");return l};
k.Ua=function(a,b,c,d,e){var f=T(this.b,a),g,h,l,n=null;if(z(b)){var t=ld(b);if(t)throw new H("invalid key range: "+b+" "+t);n=jd(b)}else if(null!=b)throw new H('expect key range object, but found "'+Ld(b)+'" of type '+typeof b);if(q(c))if(y(c))g=c;else throw new H("limit must be a number, but "+c+" is "+typeof c);else g=100;if(q(d))if(y(d))h=d;else throw new H("offset must be a number, but "+d+" is "+typeof d);else h=0;if(q(e))if(ba(e))l=e;else throw new H("reverse must be a boolean, but "+e+" is "+
typeof e);L(this.logger,(n?"listByKeyRange: ":"listByStore: ")+a);var r=this.a.request("values",[a]);Dd(f,r,arguments);P(r,function(){Ue(V(this),r,4,a,null,n,g,h,l,!1)},this);return r};
k.Ta=function(a,b,c,d,e,f,g){var h=T(this.b,a),l,n,t,r;if(!yd(h,b))throw new H('index "'+b+'" not found in store "'+a+'"');var p=ld(c);if(p)throw new H("invalid key range: "+c+" "+p);var v=jd(c);if(q(d))if(y(d))l=d;else throw new H("limit must be a number.");else l=100;if(q(e))if(y(e))n=e;else throw new H("offset must be a number.");else n=0;if(ba(f))t=f;else if(q(f))throw new H("reverse must be a boolean, but "+f);if(q(g))if(ba(g))r=g;else throw new H("unique must be a boolean");L(this.logger,"listByIndexKeyRange: "+
a+":"+b);var A=this.a.request("values:iter:index",[a]);Dd(h,A,arguments);P(A,function(){Ue(V(this),A,4,a,b,v,l,n,t,r)},this);return A};
k.ja=function(a,b,c){var d=x(a)?a:z(a)?a.name:void 0;if(!x(d))throw new H("store name "+d+" must be a string, but "+typeof d);var e=T(this.b,d);if(!e){if(!this.b.a())throw new H('store name "'+d+'" not found.');e=vd(z(a)?a:{name:d});L(this.logger,"Adding object store: "+d);Qe(this,e)}else if(this.b.a()&&z(a)&&(a=vd(a),a=Bd(e,a)))throw new Hb(a);var f;if(!e)throw new H('store name "'+d+'" not found.');if(x(e.keyPath)&&q(c))throw new H("key must not be provided while the store uses in-line key.");if(!e.keyPath&&
!e.c&&!q(c))throw new H("out-of-line key must be provided.");if(u(b)){L(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Cd(e,b[a]);f=this.a.request("add:array",[d],M);P(f,function(){We(V(this),f,!1,!1,d,b,c)},this);e.I&&f.t(function(){this.g();e.getName();this.g()},this)}else if(z(b))a="store: "+d+" key: "+zd(e,b,c),L(this.logger,"addObject: "+a),Cd(e,b),f=this.a.request("add",[d],M),P(f,function(){We(V(this),f,!1,!0,d,[b],[c])},this),e.I&&f.t(function(){this.g();e.getName();
this.g()},this);else throw new H("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};function Xe(a,b){var c=x(b)?b:z(b)?b.name:void 0;if(!x(c))throw new H("store name must be a string");var d=T(a.b,c);if(!d){if(!a.b.a())throw new Be(c);d=vd(z(b)?b:{name:c});L(a.logger,"Adding object store: "+c);Qe(a,d)}else if(a.b.a()&&z(b)){var e=vd(b);if(e=Bd(d,e))throw new Hb(e);}if(!d)throw new Be(c);return d}
k.load=function(a){a=Xe(this,a).getName();var b=this.a.request("load",[a]),c=this;this.a.G(b,function(){V(c);throw new Ib("putData");},[a],M);return b};
k.R=function(a,b,c){var d,e=this;if(a instanceof fd){var f=a,g=f.m,h=T(this.b,g);if(!h)throw new H('store "'+g+'" not found.');if(h.keyPath){var l=zd(h,b);if(null!=l){if(0!=Q(l,f.a))throw new H("Inline key must be "+f+" but "+l+" found.");}else Ad(h,b,f.a);return this.R(g,b)}return this.R(g,b,f.a)}if(u(a)){if(q(c))throw new H("too many arguments");var n=a;if(!q(b))throw new H("record values required");for(var t=b,f=[],g=0,h=n.length;g<h;g++){l=n[g].m;-1==D(f,l)&&f.push(l);var r=T(this.b,l);if(!r)throw new H('store "'+
l+'" not found.');r.keyPath&&Ad(r,t[g],n[g].a)}L(this.logger,"putByKeys: to "+S(f)+" "+t.length+" objects");for(g=0;g<t.length;g++)Cd(r,t[g]);d=this.a.request("put:keys",f,M);Dd(r,d,arguments);P(d,function(){var a=V(e);We(a,d,!0,!1,null,t,n)},this)}else if(x(a)||z(a)){var r=Xe(this,a),p=r.getName();if(r.keyPath&&q(c))throw new H("key must not be provided while the store uses in-line key.");if(!r.keyPath&&!r.c&&!q(c))throw new H("out-of-line key must be provided.");if(u(b)){var v=b,A=c;L(this.logger,
"putObjects: "+p+" "+v.length+" objects");for(g=0;g<v.length;g++)Cd(r,v[g]);d=this.a.request("put:array",[p],M);Dd(r,d,arguments);P(d,function(){We(V(this),d,!0,!1,p,v,A)},this);r.I&&d.t(function(){this.g();this.g()},this)}else if(z(b)){var F=b,ja=c;L(this.logger,"putObject: "+p+" "+(q(ja)?ja:"(without-key)"));if(q(m.Blob)&&F instanceof Blob&&r.Da&&!r.keyPath&&0==r.a.length&&Vb)d=new N("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.a.request("put",[p],M);Dd(r,c,[p,F,ja]);P(c,
function(){We(V(e),c,!0,!0,p,[b],[ja])},this);zb(c,function(a){d.callback(a)},function(a){d.k(a)})},f.onerror=function(a){d.k(a)},f.onabort=function(a){d.k(a)},f.readAsDataURL(F);else{Cd(r,F);d=this.a.request("put",[p],M);var la=[p,F,ja];Dd(r,d,la);P(d,function(){var a=q(ja)?[la[2]]:void 0;We(V(e),d,!0,!0,p,[la[1]],a)},this)}r.I&&d.t(function(){this.g();this.g()},this)}else throw new H("put record value must be Object or array of Objects");}else throw new H("the first argument of put must be store name, store schema or array of keys.");
return d};
k.clear=function(a,b,c){if(q(c))throw new H("too many input arguments");var d;if(x(a)){c=T(this.b,a);if(!c)throw new H('store name "'+a+'" not found.');if(z(b)){var e=jd(b);if(null===e)throw new H("clear method requires a valid non-null KeyRange object.");L(this.logger,"clearByKeyRange: "+a+":"+S(e));d=this.a.request("clear",[a],M);Dd(c,d,[a,e]);P(d,function(){var b=V(this);Ye(b,d,a,e)},this)}else{if(q(b))throw new H("clear method requires a valid KeyRange object as second argument, but found "+b+
" of type "+typeof b);L(this.logger,"clearByStore: "+a);d=this.a.request("clear",[a],M);P(d,function(){Ze(V(this),d,[a])},this)}}else if(!q(a)||u(a)&&x(a[0])){var f=a||Rd(this.b);L(this.logger,"clearByStores: "+S(f));d=this.a.request("clear",f,M);P(d,function(){Ze(V(this),d,f)},this)}else throw new H('first argument "'+a+'" is invalid.');return d};
k.ka=function(a,b,c){var d;if(x(a)){var e=T(this.b,a);if(!e)throw new H('store name "'+a+'" not found.');if(q(c))if(x(b)){var f=wd(e,b);if(!f)throw new H("index: "+b+" not found in "+a);if(z(c)||null===c){var g=jd(c);L(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.a.request("rm:iter:index",[a],M);P(d,function(){$e(V(this),d,a,f.getName(),g)},this)}else throw new H("key range "+c+' is invalid type "'+typeof c+'".');}else throw new H('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(x(b)||y(b)||w(b)||b instanceof Date){L(this.logger,"removeById: "+a+":"+b);d=this.a.request("rm",[a],M);var h=[a,b];Dd(e,d,h);P(d,function(){af(V(this),d,a,h[1])},this);e.I&&d.t(function(){this.g();this.g()},this)}else if(z(b))g=jd(b),L(this.logger,"removeByKeyRange: "+a+":"+S(g)),d=this.a.request("rm:iter",[a],M),Dd(e,d,[a,g]),P(d,function(){Ye(V(this),d,a,g)},this),e.I&&d.t(function(){this.g();this.g()},this);else throw new H('Invalid key or key range "'+b+'" of type '+
typeof b);}else if(a instanceof fd){var l=a.m,e=T(this.b,l);d=this.a.request("rm",[l],M);var n=[l,a.a];Dd(e,d,n);P(d,function(){af(V(this),d,l,n[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof fd))throw new H("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+Ld(a[c])+'" ('+aa(a[c])+") is not ydn.db.Key.");var t=a[c].m;-1==D(b,t)&&b.push(t)}if(1>b.length)throw new H('at least one valid key required in key list "'+Ld(a)+'"');d=this.a.request("rm:keys",b,M);
P(d,function(){bf(V(this),d,a)},this)}else throw new H('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+Ld(a)+'" ('+aa(a)+") found.");return d};k.toString=function(){return"DbOperator:"+this.g().getName()};function cf(a,b,c){Oe.call(this,a,b,c)}B(cf,W);k=cf.prototype;k.logger=J("ydn.db.core.DbOperator");k.F=function(a,b){if(a instanceof re){var c=a.b,d=T(this.b,c);if(!d)throw new H('store "'+c+'" not found.');var e=a.d;if(q(e)&&!yd(d,e))throw new H('index "'+e+'" not found in store "'+c+'".');L(this.logger,"getByIterator:"+a);var f=this.a.request("get:iter",[c]);P(f,function(){df(this,5,f,a,1)},this);return f}return cf.p.F.call(this,a,b)};
k.keys=function(a,b,c,d,e,f,g){if(a instanceof re){var h=100;if(y(b)){if(h=b,1>h)throw new H("limit must be a positive value, but "+b);}else if(q(b))throw new H("limit must be a number,  but "+b);if(q(c))throw new H("offset must not be specified");L(this.logger,"keysByIterator:"+a);var l=this.a.request("keys:iter",[a.b]);P(l,function(){a.n?df(this,1,l,a,h):df(this,2,l,a,h)},this);return l}return cf.p.keys.call(this,a,b,c,d,e,f,g)};
k.C=function(a,b,c,d){if(a instanceof re){if(q(b)||q(c))throw new H("too many arguments.");L(this.logger,"countIterator:"+a);var e=this.a.request("count",[a.b]);P(e,function(){df(this,6,e,a)},this);return e}return cf.p.C.call(this,a,b,c,d)};
k.N=function(a,b,c,d,e,f){if(a instanceof re){var g;if(y(b)){if(g=b,1>g)throw new H("limit must be a positive value, but "+g);}else if(q(b))throw new H("limit must be a number, but "+b);if(q(c))throw new H("offset must not be specified");L(this.logger,"listByIterator:"+a);var h=this.a.request("values:iter",[a.b]);P(h,function(){a.c?df(this,2,h,a,g):df(this,4,h,a,g)},this);return h}return cf.p.N.call(this,a,b,c,d,e,f)};
function ef(a,b,c){if(!u(c))throw new H("iterators argument must be an array, but "+c+" of type "+typeof c+" found");for(var d=0;d<c.length;d++)if(!(c[d]instanceof re))throw new H("Iterator at "+d+" must be cursor range iterator.");for(var e=M||Dc,f=[],d=0;d<c.length;d++)for(var g=c[d].stores(),h=0;h<g.length;h++)0<=D(f,g[h])||f.push(g[h]);L(a.logger,a+": scan for "+c.length+" iterators on "+f);d=a.a.request("scan",f);a.a.G(d,function(d,e,f){function g(){for(var b=0,f=0;f<c.length;f++){var t=c[f],
r=[ff(V(a),d,e,t.b)],t=t.load(r);t.j=h;t.f=ia(v,b);Ca[f]=t;la[b]=f;b++}ja=c.length}function h(b){for(var c=0;c<Ca.length;c++)me(Ca[c]);Oa(Ca);L(a.logger,A+" error");f(b,!0)}function v(d,e){if(F)throw new Wd;Mc++;var g=Mc===ja,h=la[d],l=c[h],n=Ca[h],h=ne(n),n=oe(n);va[d]=e;$a[d]=l.n?l.c?h:n:l.c?e:n;if(g){var r;b instanceof xe?r=b.c(va,$a):r=b(va,$a);g=[];l=[];h=[];n=[];if(u(r))for(var p=0;p<r.length;p++)!0===r[p]?h[p]=1:!1===r[p]?n[p]=!0:l[p]=r[p];else if(null===r)g=[];else if(q(r))if(z(r)){g=["advance",
"continue","continuePrimary","restart"];for(p in r)if(!(0<=D(g,p)))throw new Jb('Unknown attribute "'+p+'" in cursor advancement object');g=r.continuePrimary||[];l=r["continue"]||[];h=r.advance||[];n=r.restart||[]}else throw new Jb("scan callback output");else for(g=[],p=0;p<c.length;p++)q(la[p])&&(h[p]=1);for(p=Mc=r=0;p<c.length;p++)null!=g[p]||q(l[p])||null!=n[p]||null!=h[p]||Mc++;for(p=0;p<c.length;p++)if(null!=g[p]||q(l[p])||null!=n[p]||null!=h[p]){var v=la[p];if(!q(v))throw new Yd(p+" is not an iterator.");
var v=c[v],ab=Ca[p];if(null==va[p]){var Qd=p+"/"+c.length;if(null!=h[p])throw new Zd(ab+" "+Qd+" must not advance "+h[p]+" steps");if(q(l[p]))throw new Zd(ab+" "+Qd+" must not continue to key "+l[p]);if(null!=g[p])throw new Zd(ab+" "+Qd+" must not continue to primary key "+g[p]);}va[p]=void 0;$a[p]=void 0;if(null!=n[p])pe(ab);else if(q(l[p]))ab.Y(l[p]);else if(null!=g[p])ab.ta(g[p]);else if(null!=h[p])gf(ab);else throw new Wd(v+": has no action");r++}if(0==r){for(r=0;r<Ca.length;r++)me(Ca[r]);F=!0;
Oa(Ca);L(a.logger,"success "+A);f(void 0)}}}var A=e+" "+a+" scanning";K(a.logger,A);var F=!1,ja,la=[],va=[],$a=[],Ca=[],Mc=0;b instanceof xe?ye(b,c)||g():g()},f,e);return d}
k.open=function(a,b,c,d){if(!(b instanceof re))throw new H("Second argument must be cursor range iterator.");for(var e=b.stores(),f=0;f<e.length;f++)if(!T(this.b,e[f]))throw new H('Store "'+e[f]+'" not found.');c=c||Dc;var g=this,h=this.a.request("open",b.stores(),c);L(this.logger,"open:"+c+" "+b);P(h,function(c){var e=Wc(h);L(g.logger,e+" iterating "+b);for(var f=b.stores(),r=[],p=0;p<f.length;p++)r[p]=ff(V(g),c,e,f[p]);var v=b.load(r);v.j=function(a){O(h,a,!0)};v.f=function(b){null!=b?(b=a.call(d,
v),!0===b?pe(v):z(b)?!0===b.restart?pe(v,b["continue"],b.continuePrimary):null!=b["continue"]?v.Y(b["continue"]):null!=b.continuePrimary?v.ta(b.continuePrimary):(me(v),O(h,void 0)):null===b?(me(v),O(h,void 0)):null!=b?v.Y(b):gf(v)):(me(v),O(h,void 0))}},this);return h};
k.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new H('Store "'+e+'" not found.');e=this.a.request("map",d);K(this.logger,"map:"+a);this.a.G(e,function(d,e,f){K(c.logger,e+" iterating "+a);for(var n=a.stores(),t=[],r=0;r<n.length;r++)t[r]=ff(V(c),d,e,n[r]);var p=a.load(t);p.j=function(a){f(a,!1)};p.f=function(c){if(null!=c){var d;a.n?a.c?d=c:d=ne(p):a.c?d=c:d=oe(p);b(d);gf(p)}else f(void 0),b=null}},d,Dc);return e};
function hf(a,b,c,d){var e=c.b,f=c.d||null,g=d||100;L(a.logger,"listIter:"+b+" "+c+(d?" limit="+g:"")+"");var h=a.a.request("values:iter:index",[e]),l="done"==c.e||c.e==se?[]:[c.i,c.j];P(h,function(){Ue(V(this),h,b,e,f,c.a?c.a instanceof kd?c.a:kd.bound(c.a.lower,c.a.upper,c.a.lowerOpen,c.a.upperOpen):null,g,0,te(c),ue(c),l)},a);h.t(function(){null!=l[0]?we(c,"rest",l[0],l[1]):we(c)});return h}
function df(a,b,c,d,e){var f=[],g=c.a,h=Wc(c),l=h+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);L(a.logger,l);for(var n=V(a),t=[],r=d.stores(),p=0;p<r.length;p++)t[p]=ff(n,g,h,r[p]);var v=d.load(t);v.j=function(a){me(v);O(c,a,!0)};var A=0,F=!1;v.f=function(d){F||(K(a.logger,l+" starting"),F=!0);null!=d?(A++,1==b?f.push(d):2==b?f.push(ne(v)):3==b?f.push([d,ne(v)]):6!=b&&f.push(oe(v)),5==b?(me(v),O(c,f[0])):6==b||!q(e)||A<e?v.Y():(L(a.logger,"success:"+l+" yields "+f.length+" records"),me(v),O(c,f))):
(L(a.logger,"success:"+l+" yields "+f.length+" records"),me(v),O(c,5==b?f[0]:6==b?A:f))}};function jf(a,b,c,d){this.d=a;this.e=b;this.a=Pa(c);this.b=d;this.c=[]}jf.prototype.d=null;function kf(a,b,c){if(a.d)c&&a.c.push(c),b(a.d);else throw new Kb("tx committed on ParallelTxExecutor");}jf.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.e+" mode:"+this.b+" scopes:"+S(this.a)};function lf(a,b,c,d,e,f){Ge.call(this,a,b,c,d,e,f);this.c=this.b=null}B(lf,Ge);k=lf.prototype;k.logger=J("ydn.db.tr.Parallel");k.abort=function(){L(this.logger,this+": aborting");Ie(this.c)};
k.Ea=function(a,b){var c;if("multi"==this.e)a:if(c=this.b,!c.a||!c.b||b!=c.b&&(c.b!=M||b!=Dc)||a.length>c.a.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.e)a:if(c=this.b,c.a&&c.b&&b==c.b&&c.a.length==a.length){for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.e?!0:!1;return c};
k.M=function(a,b,c,d){function e(c){l.d++;n=new jf(c,l.d,b,h);g=l.r();Ac(l.logger,g+" BEGIN "+S(b)+" "+h);l.b=n;kf(l.b,a,d)}function f(a,b){Ac(l.logger,g+" "+a);if(n){for(var c=n,d=0;d<c.c.length;d++)c.c[d](a,b);c.c.length=0;c.d=null;c.a=null;c.c=null}l.a=0}var g;this.w&&(b=this.w);this.o&&(c=this.o);var h=q(c)?c:Dc,l=this,n;if(this.b&&this.b.d&&this.Ea(b,h))kf(this.b,a,d);else{if(this.i&&this.d>=this.i)throw new Jb("Exceed maximum number of transactions of "+this.i);this.g().X(e,b,h,f)}};
k.request=function(a,b,c,d){var e=new N(a),f=this;this.M(function(a){f.a++;Sc(e,a,f.r()+"R"+f.a)},b,c||Dc,function(a,b){Tc(e);d&&d(a,b)});return e};k.G=function(a,b,c,d,e){var f=this,g;this.M(function(c){f.a++;g=f.r()+"R"+f.a;L(f.logger,g+" BEGIN");b(c,g,function(b,d){f.c=c;g=f.r()+"R"+f.a;d?(L(f.logger,g+" ERROR"),a.k(b)):(L(f.logger,g+" SUCCESS"),a.callback(b));f.c=null});b=null;L(f.logger,g+" END")},c,d,e)};k.toString=function(){return"Parallel:"+this.e+":"+this.r()+(this.c?"*":"")};function mf(a,b){lf.call(this,a,b,He)}B(mf,lf);k=mf.prototype;k.logger=J("ydn.db.tr.AtomicParallel");k.Ea=function(){return!1};k.request=function(a,b,c){var d,e,f,g=this,h=mf.p.request.call(this,a,b,c,function(a,b){Tc(h);L(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new Ce;O(h,c,!0)}});Vc(h,function(a,b,c){f=b;e=a;d=c});return h};
k.G=function(a,b,c,d,e){var f,g,h=new G;zb(h,function(a){g=!1;f=a},function(a){g=!0;f=a});mf.p.G.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.k(c);else if(!0===g)a.k(f);else if(!1===g)a.callback(f);else{var d=new Ce;a.k(d)}e&&(e(b,c),e=void 0)})};k.toString=function(){return"Atomic"+mf.p.toString.call(this)};function nf(a,b,c){U.call(this,a,b,c);this.Q=0;a=!0;b=He;c&&(q(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=of(this,b,a);this.i=of(this,"atomic",!1);this.c=this.U(c,this.i)}B(nf,U);k=nf.prototype;k.Q=0;k.Fa=function(a,b,c,d,e,f){a=a||He;var g;"readonly"==d?g=Dc:"readwrite"==d&&(g=M);a=of(this,a,b,c,g,e);return this.U(a,f?null:this.i)};k.U=function(a){return new Oe(this,this.b,a)};
function of(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==He)return new Je(a,a.Q++,b,d,e,f);if("atomic"==b)return new Ne(a,a.Q++);throw new H('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==He)return new lf(a,a.Q++,b,d,e,f);if("atomic"==b)return new mf(a,a.Q++);throw new H('Invalid requestType "'+b+'"');}
k.Qa=function(a,b,c){if(3<arguments.length)throw new H("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.Q++;var d=b||Rd(this.b),e=Dc;if(c)if("readwrite"==c)e=M;else if("readonly"!=c)throw new H('Invalid transaction mode "'+c+'"');var f=of(this,"all",!1,d,e,1),g=this.U(f,this.i),h=new N("run"),l=this;f.M(function(b){K(l.logger,"executing run in transaction on "+f);Sc(h,b,f.r()+"R0");a(g)},d,e,function(a){Tc(h);O(h,f.d,"complete"!==a)});return h};
k.gb=function(){return this.c?this.c.a.d:NaN};function X(a,b,c){nf.call(this,a,b,c);a=this.b;for(b=0;b<a.c.length;b++){c=a.c[b];var d=T(a,c.getName());if(d){if(!yd(d,"k"))throw new H('full text index store "'+d.getName()+'" must have "keyword" index');if(!yd(d,"v"))throw new H('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new H('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new H('full text index store "'+c.getName()+'" required.');for(d=0;d<c.a.length;d++){var e=
c.index(d),f=T(a,e.m);if(f)zc(this.logger,"Full text indexer option for "+f.getName()+" ignored.");else throw new H('full text source store "'+e.m+'" does not exist for full text index "'+c.getName()+'"');}}}B(X,nf);k=X.prototype;k.U=function(a){return new W(this,this.b,a)};k.ja=function(a,b,c){return this.c.ja(a,b,c)};k.C=function(a,b,c,d){return this.c.C(a,b,c,d)};k.F=function(a,b){return this.c.F(a,b)};k.keys=function(a,b,c,d,e,f,g){return this.c.keys(a,b,c,d,e,f,g)};
k.N=function(a,b,c,d,e,f){return this.c.N(a,b,c,d,e,f)};k.load=function(a,b,c){return this.c.load(a,b,c)};k.R=function(a,b,c){return this.c.R(a,b,c)};k.clear=function(a,b,c){return this.c.clear(a,b,c)};k.ka=function(a,b,c){return this.c.ka(a,b,c)};k.toString=function(){var a="Storage:"+this.getName();fe(this)&&(a+=" ["+this.ia()+"]");return a};function pf(a,b,c){X.call(this,a,b,c)}B(pf,X);pf.prototype.U=function(a){return new cf(this,this.b,a)};pf.prototype.open=function(a,b,c,d){return this.c.open(a,b,c,d)};pf.prototype.map=function(a,b){return this.c.map(a,b)};function qf(){this.a=!1}qf.prototype.a=!1;qf.prototype.state=function(){return this.a};function rf(a,b,c,d){ie.call(this,a,b,c,d);this.d=this.b=this.a=void 0;this.n=this.c=null;this.o=new qf;this.ha=this.H=null}B(rf,ie);k=rf.prototype;k.logger=J("ydn.db.core.req.SimpleCursor");function gf(a){function b(b){c++;if(!b||1<=c)return sf(a,b)}var c=a.c?-1:0;a.reverse?tf(a.H,b,a.c):uf(a.H,b,a.c)}
k.Y=function(a){if(null!=a){var b=this,c=new Y(a),d=function(c){b.c=c;if(!c)return sf(b,c);var d=Q(c.value.key,a);if(b.reverse){if(1!=d)return sf(b,c)}else if(-1!=d)return sf(b,c)};this.reverse?tf(this.H,d,c):uf(this.H,d,c)}else gf(this)};
function vf(a){setTimeout(function(){if(a.o.state()){a.o.a=!1;var b=a.a,c=a.b,d=a.d;null==b&&(L(a.logger,a+" finished."),a.h=!0);a.a=b;a.b=c;a.d=d;a.h?(K(a.logger,a+" DONE."),a.f(),ke(a)):(K(a.logger,a+" new cursor position {"+(a.e?a.a+", "+a.b:a.a)+"}"),a.f(a.a));vf(a)}else a.n(),a.n=null},4)}
function sf(a,b){if(a.c=b){var c=b.value;if(a.l)if(a.reverse||null==a.l.upper)a.reverse&&null!=a.l.lower&&(d=Q(c.key,a.l.lower),-1==d||0==d&&a.l.lowerOpen)&&(a.c=null);else{var d=Q(c.key,a.l.upper);if(1==d||0==d&&a.l.upperOpen)a.c=null}if(a.c){if(a.Ba&&null!=a.a&&null!=c.key&&0==Q(a.a,c.key))return;a.a=c.key;a.b=a.e?c.a:a.a;4==a.qa&&(a.pa?a.d=a.b:a.d=wf(a.ha,a.b))}}a.c||(a.a=void 0,a.b=void 0,a.d=void 0);return a.o.a=!0}
function le(a,b,c){var d=null;if(a.l)if(a.reverse){var e=a.e?"\uffff":void 0;null!=a.l.upper&&(d=new Y(a.l.upper,e))}else null!=a.l.lower&&(d=new Y(a.l.lower));null!=b&&(d=a.e?new Y(b,c):new Y(b));a.n=a.w.g(function(a){function c(a){var e=a.value,f=e.key;if(a&&null!=f)if(null!=b){if(0==xf(d,e))return}else if(this.l&&(!this.reverse&&this.l.lowerOpen&&null!=this.l.lower&&(e=Q(f,this.l.lower),0==e)||this.reverse&&this.l.upperOpen&&null!=this.l.upper&&(e=Q(f,this.l.upper),0==e)))return;return sf(this,
a)}this.ha=yf(a,this.m);this.H=zf(this.ha,this.T);this.reverse?tf(this.H,ha(c,this),d):uf(this.H,ha(c,this),d);vf(this)},a)}k.clear=function(){throw new Ib;};k.ta=function(){throw new Ib;};k.toString=function(){return"Simple"+rf.p.toString.call(this)};function Af(a,b,c){a=["ydn.db",a];q(b)&&(a.push(b),q(c)&&(a.push(c),q(void 0)&&a.push(Jc(void 0))));return a.join("^|")};function Y(a,b){this.key=a;this.a=b}Y.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.a?", "+this.a+")":")")};function xf(a,b){var c=Q(a.key,b.key);return 0===c?null!=a.a?null!=b.a?Q(a.a,b.a):1:null!=b.a?-1:0:c};function Bf(a){this.v=a||Cf}function Cf(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}k=Bf.prototype;k.q=null;k.v=null;k.B=null;k.A=null;
function Df(a,b){if(null==a.q)a.q=new Ef(b),a.B=a.q,a.A=a.q;else{var c=null;Ff(a,function(a){var e=null,f=this.v(a.value,b);0<f?(e=a.left,null==a.left&&(c=new Ef(b,a),a.left=c,a==this.B&&(this.B=c))):0>f&&(e=a.right,null==a.right&&(c=new Ef(b,a),a.right=c,a==this.A&&(this.A=c)));return e});c&&(Ff(a,function(a){a.a++;return a.parent},c.parent),Gf(a,c.parent))}}function Hf(a,b){Ff(a,function(a){var d=null,e=this.v(a.value,b);0<e?d=a.left:0>e?d=a.right:If(this,a);return d})}
k.clear=function(){this.A=this.B=this.q=null};k.contains=function(a){var b=!1;Ff(this,function(c){var d=null,e=this.v(c.value,a);0<e?d=c.left:0>e?d=c.right:b=!0;return d});return b};k.indexOf=function(a){var b=-1,c=0;Ff(this,function(d){var e=this.v(d.value,a);if(0<e)return d.left;d.left&&(c+=d.left.a);if(0>e)return c++,d.right;b=c;return null});return b};k.wa=function(){var a=[];Jf(this,function(b){a.push(b)});return a};
function Jf(a,b){if(a.q){var c,d=c=Kf(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Ff(a,b,c){for(c=c?c:a.q;c&&null!=c;)c=b.call(a,c)}
function Gf(a,b){Ff(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Lf(this,a.left),Mf(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Mf(this,a.right),Lf(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Lf(a,b){Nf(b)?(b.parent.left=b.right,b.right.parent=b.parent):Of(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.q=b.right,a.q.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.a=b.a;b.a-=(c.right?c.right.a:0)+1}
function Mf(a,b){Nf(b)?(b.parent.left=b.left,b.left.parent=b.parent):Of(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.q=b.left,a.q.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.a=b.a;b.a-=(c.left?c.left.a:0)+1}
function If(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Pf(a,b.left);Ff(a,function(a){a.a--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.A&&(a.A=d)}else{d=Kf(a,b.right);Ff(a,function(a){a.a--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=b.parent;
d.left=b.left;d.left&&(d.left.parent=d);b==a.B&&(a.B=d)}d.a=b.a;Nf(b)?b.parent.left=d:Of(b)?b.parent.right=d:a.q=d;Gf(a,c?c:d)}else Ff(a,function(a){a.a--;return a.parent},b.parent),Nf(b)?(b.parent.left=null,b==a.B&&(a.B=b.parent),Gf(a,b.parent)):Of(b)?(b.parent.right=null,b==a.A&&(a.A=b.parent),Gf(a,b.parent)):a.clear()}function Kf(a,b){if(!b)return a.B;var c=b;Ff(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Pf(a,b){if(!b)return a.A;var c=b;Ff(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Ef(a,b){this.value=a;this.parent=b?b:null;this.a=1}Ef.prototype.left=null;Ef.prototype.right=null;Ef.prototype.height=1;function Of(a){return!!a.parent&&a.parent.right==a}function Nf(a){return!!a.parent&&a.parent.left==a};function Qf(a){this.v=a||Cf}B(Qf,Bf);function uf(a,b,c){if(a.q){var d;if(c instanceof Ef)d=c;else if(c){if(Ff(a,function(a){var b=null;0<this.v(a.value,c)?(b=a.left,d=a):0>this.v(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Kf(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function tf(a,b,c){if(a.q){var d;if(c instanceof Ef)d=c;else if(c){if(Ff(a,ha(function(a){var b=null;0<this.v(a.value,c)?b=a.left:(0>this.v(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Pf(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Rf(a,b,c){this.e=a;this.storage=b;this.b=c;this.a={};a=this.b.keyPath;this.c=u(a)?a.join(","):a||"_ROWID_";this.a[this.c]=null;this.d=Af(this.e,this.b.getName(),this.c)+"^|"}
function zf(a,b){var c=b||a.c;if(!a.a[c]){a.a[c]=new Qf(xf);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&0==f.lastIndexOf(a.d,0)){for(var g,h=g=[],l=void 0,n=[],t=void 0,r=void 0,p=new Qc(f.substr(a.d.length));null!=Oc(p);)if(0===p.a)h=n.pop();else{if(null===p.a)break;do{for(var t=p.a/4|0,l=p.a%4,v=0;v<t;v++)r=[],h.push(r),n.push(h),h=r;if(0===l&&12<p.a+4)Oc(p);else break}while(1);1===l?h.push(Nc(p)):2===l?h.push(new Date(Nc(p))):3===l?h.push(Pc(p)):0===l&&(h=n.pop())}g=
g[0];if(c==a.c)Df(a.a[c],new Y(g));else if(h=a.storage.getItem(f),null!==h)if(f=wd(a.b,c),h=Kd(h),h=qd(f,h),f.c){if(u(h))for(f=0;f<h.length;f++)Df(a.a[c],new Y(h[f],g))}else Df(a.a[c],new Y(h,g))}}}return a.a[c]}function Sf(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.c)Hf(e,new Y(b));else{var f=wd(a.b,d),f=Gc(c,f.keyPath);Hf(e,new Y(b,f))}}}function Tf(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function Uf(a,b,c,d){if(null==b&&(a.b.keyPath&&(b=zd(a.b,c)),a.b.c&&null==b)){b=a.d+Jc(void 0);var e=Kd(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,S(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.d+Jc(b)));if(d)return null;a.storage.setItem(a.d+Jc(b),S(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.c)Df(e,new Y(d));else{var g=wd(a.b,f),g=Gc(c,g.keyPath);null!=g&&Df(e,new Y(d,g))}return b}
function Vf(a,b){var c=a.d+Jc(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=Kd(d);Sf(a,b,c);return 1}Rf.prototype.clear=function(){Tf(this);Wf(this)};function wf(a,b){var c=a.storage.getItem(a.d+Jc(b)),d=void 0;if(null!==c)for(var d=Kd(c),c=0,e=a.b.a.length;c<e;c++){var f=a.b.index(c);if("DATE"==f.type){var g=qd(f,d);if(g)for(var h=d,g=new Date(g),l=0;l<f.a.length;l++)l==f.a.length-1?h[f.a[l]]=g:z(h[f.a[l]])||(h[f.a[l]]={})}}return d}Rf.prototype.getName=function(){return this.b.getName()};
function Xf(a,b,c){b=b||a.c;a=zf(a,b);var d=null,e=null,f=0,g=!1,h=!1;null!=c&&(null!=c.lower&&(d=new Y(c.lower)),null!=c.upper&&(e=new Y(c.upper)),g=c.lowerOpen,h=c.upperOpen);uf(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=Q(a.key,d.key))){if(null!=e&&(a=Q(a.key,e.key),1===a||0===a&&h))return!0;f++}},d);return f}
function Wf(a,b){var c=zf(a,a.c),d=null,e=null,f=0,g=[],h=[],l=!1,n=!1;null!=b&&(null!=b.lower&&(d=new Y(b.lower)),null!=b.upper&&(e=new Y(b.upper)),l=b.lowerOpen,n=b.upperOpen);uf(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=xf(b,d))){if(null!=e){var c=xf(b,e);if(1===c||0===c&&n)return!0}var c=a.d+Jc(b.key),p=a.storage.getItem(c);null!==p&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),h.push(Kd(p))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Sf(a,g[c],h[c]);else Tf(a);return f}
function Yf(a,b,c,d,e,f,g,h,l){function n(c){if(c&&(ja++,!(ja<g))){var d=c.value;if(e){if(va&&null!=F&&(c=p?xf(d,F):Q(d.key,F.key),0==c))return;if(null!=A&&(c=p?xf(d,A):Q(d.key,A.key),-1==c||0==c&&la))return l&&(l[0]=void 0,l[1]=void 0),!0}else{if(la&&null!=A&&(c=p?xf(d,A):Q(d.key,A.key),0==c))return;if(null!=F&&(c=p?xf(d,F):Q(d.key,F.key),1==c||0==c&&va))return l&&(l[0]=void 0,l[1]=void 0),!0}c=d.key;if(!h||!v||null==r||0!=Q(r,c)){d=v?d.a:c;if(2==b)t.push(d);else if(1==b)t.push(c);else if(3==b)t.push([c,
d]);else if(4==b){var n=wf(a,d);t.push(n)}else t.push([c,d,wf(a,d)]);l&&(l[0]=c,l[1]=d)}r=c;if(q(f)&&t.length>=f)return!0}}var t=[],r,p=!!l&&null!=l[0];c=c||a.c;var v=c!=a.c;c=zf(a,c);var A=null,F=null;q(g)||(g=0);var ja=-1,la=!1,va=!1;null!=d&&(null!=d.lower&&(A=v&&e?new Y(d.lower,"\uffff"):new Y(d.lower)),null!=d.upper&&(F=v&&!e?new Y(d.upper,"\uffff"):new Y(d.upper)),la=!!d.lowerOpen,va=!!d.upperOpen);if(p){e?va=!0:la=!0;d=l[0];var $a=q(l[1])?l[1]:"\uffff";e?F=v?new Y(d,$a):new Y(d):A=v?new Y(d,
$a):new Y(d)}e?tf(c,n,F):uf(c,n,A);return t}Rf.prototype.ca=function(a,b,c,d,e){return Yf(this,2,a,b,c,d,e)};Rf.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.e+":"+this.b.getName()};function Zf(){this.clear()}k=Zf.prototype;k.$=function(){return this};k.setItem=function(a,b){q(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};k.getItem=function(a){return q(this.a[a])?this.a[a]:null};k.removeItem=function(a){delete this.a[a];var b=this.keys;a=D(b,a.toString());0<=a&&Ia.splice.call(b,a,1);this.length=this.keys.length};k.length=0;k.key=function(a){a=this.keys[a];return q(a)?this.a[a]:null};
k.clear=function(){this.a={};this.keys=[];this.length=0};function $f(a){this.f=a||new Zf;this.e={}}function yf(a,b){var c=T(a.a,b);if(c)a.e[b]||(a.e[b]=new Rf(a.c,a.d,c));else throw new Kb('store name "'+b+'" not found.');return a.e[b]}function ae(a,b){setTimeout(function(){var c=Af(a.c),c=a.d.getItem(c),c=new Pd(c);b(c)},10)};function ag(a,b){this.b=a;this.a=b}ag.prototype.g=function(a,b){var c=this.b;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.a("complete",null);d.a=null;d.b=null}};function bg(a,b){this.a=b}B(bg,De);bg.prototype.logger=J("ydn.db.crud.req.SimpleStore");
function We(a,b,c,d,e,f,g){K(a.logger,Wc(b)+" "+(c?"put":"add")+"Object"+(d?"":"s "+f.length+" objects"));var h=b.a.g(function(a){var n;if(d)n=yf(a,e),a=g?g[0]:void 0,a=Uf(n,a,f[0],!c),null!=a?O(b,a):(n=Ld(a),n=new ze(n),O(b,n,!0));else{for(var t=e,r=[],p=!1,v=g||{},A=0;A<f.length;A++){var F;e?F=v[A]:(t=g[A],F=t.a,t=t.m);n&&n.getName()==t||(n=yf(a,t));F=Uf(n,F,f[A],!c);null!=F?r.push(F):(p=!0,r.push(new ze))}O(b,r,p)}h();h=null},a)}
function Te(a,b,c,d){var e=b.a.g(function(a){a=wf(yf(a,c),d);O(b,a);e();e=null},a)}function Ve(a,b,c,d){var e=b.a.g(function(a){for(var g=[],h=c,l,n=0;n<d.length;n++){var t=d[n];t instanceof fd&&(h=t,t=h.a,h=h.m);l&&l.getName()==h||(l=yf(a,h));t=wf(l,t);g[n]=t}O(b,g,!1);e();e=null},a)}function af(a,b,c,d){var e=Wc(b)+" removeById "+c+" "+d;K(a.logger,e);var f=b.a.g(function(g){g=Vf(yf(g,c),d);L(a.logger,"success "+e+(0==g?" [not found]":""));O(b,g);f();f=null},a)}
function bf(a,b,c){K(a.logger,Wc(b)+" removeByKeys "+c.length+" keys");var d,e=0,f=b.a.g(function(a){for(var h=0;h<c.length;h++){var l=c[h].m,n=c[h].a;d&&d.getName()==l||(d=yf(a,l));e+=Vf(d,n)}O(b,e);f();f=null},a)}function Ye(a,b,c,d){var e=Wc(b)+" removeByKeyRange "+(d?S(d):"");K(a.logger,e);var f=b.a.g(function(g){g=Wf(yf(g,c),d);L(a.logger,e+" deleted "+g+" records.");O(b,g);f();f=null},a)}
function $e(a,b,c,d,e){var f=Wc(b)+" removeByIndexKeyRange "+(e?S(e):"");K(a.logger,f);var g=b.a.g(function(a){a=yf(a,c);for(var f=a.ca(d,e),n=f.length,t=0;t<n;t++)Vf(a,f[t]);O(b,n);g();g=null},a)}function Ze(a,b,c){var d=Wc(b)+" clearByStores";K(a.logger,d);var e=b.a.g(function(a){for(var g=0;g<c.length;g++)yf(a,c[g]).clear();L(this.logger,"success "+d);O(b,c.length);e();e=null},a)}
function Re(a,b,c){var d=b.a.g(function(a){for(var f=[],g=0;g<c.length;g++){var h=yf(a,c[g]);f.push(Xf(h))}O(b,f);d();d=null},a)}function Se(a,b,c,d,e){var f=Wc(b)+" count"+(null!=e?"Index":"")+(null!=d?"KeyRange":"Store");K(a.logger,f);var g=b.a.g(function(a){a=Xf(yf(a,c),e,d);L(this.logger,"success "+f);O(b,a);g();g=null},a)}
function Ue(a,b,c,d,e,f,g,h,l,n,t){var r=Wc(b)+" "+d+" "+(f?Ld(f):"");K(a.logger,r);var p=b.a.g(function(a){a=Yf(yf(a,d),c,e,f,l,g,h,n,t);L(this.logger,r+" "+a.length+" records found.");O(b,a);p();p=null},a)};function Pe(a,b){this.a=b}B(Pe,bg);function ff(a,b,c,d){a=T(a.a,d);return new rf(b,c,a,void 0)};function cg(a){$f.call(this,a);this.b=NaN}B(cg,$f);k=cg.prototype;k.logger=J("ydn.db.con.SimpleStorage");
function ee(a,b,c){function d(b,c){setTimeout(function(){c?(L(a.logger,a+" opening fail"),e.k(c)):(L(a.logger,a+" version "+a.b+" open"),e.callback(b))},10)}var e=new G;a.d=a.f.$(b);a.c=b;a.a=c;b=Af(a.c);a.b=NaN;var f=Kd(a.d.getItem(b));q(f.version)&&!y(f.version)&&(f.version=NaN);if(f)if(c=new Pd(f),Td(a.a,c))if(!a.a.b&&!isNaN(c.version)&&a.a.version>c.version)d(NaN,new Ae("existing version "+c.version+" is larger than "+a.a.version));else{f=a.a.version;a.b=q(f)?f:c.version+1;for(f=0;f<a.a.stores.length;f++)var g=
a.a.stores[f]||null;if(a.a instanceof Ud)for(f=0;f<c.stores.length;f++)g=c.stores[f]||null,a.a.stores.push(g);f=a.a.toJSON();f.version=a.b||NaN;a.d.setItem(b,S(f));d(c.version||NaN)}else{for(f=0;f<a.a.stores.length;f++)g=a.a.stores[f]||null;a.b=c.version||NaN;d(a.b)}else c=c.toJSON(),a.b=1,c.version=a.b,a.d.setItem(b,S(c)),d(NaN);return e}k.bb=function(){};k.ab=function(){};k.Na=function(){};k.W=function(){return"memory"};k.close=function(){};
function he(a,b,c){b(new ag(a,function(a,b){c(a,b)}))}k.toString=function(){return"SimpleStorage:"+this.W()+":"+(this.c+":"+this.b)};function dg(){cg.call(this,this)}B(dg,cg);dg.prototype.$=function(){return window.localStorage};dg.prototype.W=function(){return"localstorage"};Yc.push(function(a,b){if(!b||"localstorage"==b){var c=new dg,d=new Ud;ee(c,a,d);ae(c,function(a){for(var b=0;b<a.stores.length;b++)yf(c,a.stores[b].getName()).clear()})}});function eg(){cg.call(this,this)}B(eg,cg);eg.prototype.$=function(){return window.sessionStorage};eg.prototype.W=function(){return"sessionstorage"};
Yc.push(function(a,b){if(!b||"sessionstorage"==b){var c=new eg,d=new Ud;ee(c,a,d);ae(c,function(a){for(var b=0;b<a.stores.length;b++)yf(c,a.stores[b].getName()).clear()})}});function fg(){};function gg(){}B(gg,fg);gg.prototype.clear=function(){var a=Pb(this.S(!0)),b=this;Ja(a,function(a){b.a.removeAttribute(hg(a));ig(b)})};function jg(a,b){if(I&&!(I&&9<=bc)){kg||(kg=new Qb);this.a=Object.prototype.hasOwnProperty.call(kg.b,a)?kg.b[a]:void 0;this.a||(b?this.a=document.getElementById(b):(this.a=document.createElement("userdata"),this.a.addBehavior("#default#userData"),document.body.appendChild(this.a)),Rb(kg,a,this.a));this.b=a;try{this.a.load(this.b)}catch(c){this.a=null}}}B(jg,gg);var lg={".":".2E","!":".21","~":".7E","*":".2A","'":".27","(":".28",")":".29","%":"."},kg=null;jg.prototype.a=null;jg.prototype.b=null;
function hg(a){return"_"+encodeURIComponent(a).replace(/[.!~*'()%]/g,function(a){return lg[a]})}jg.prototype.S=function(a){var b=0,c=this.a.XMLDocument.documentElement.attributes,d=new Mb;d.next=function(){if(b>=c.length)throw Lb;var d=c[b++];if(a)return decodeURIComponent(d.nodeName.replace(/\./g,"%")).substr(1);d=d.nodeValue;if(!x(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};
jg.prototype.clear=function(){for(var a=this.a.XMLDocument.documentElement,b=a.attributes.length;0<b;b--)a.removeAttribute(a.attributes[b-1].nodeName);ig(this)};function ig(a){try{a.a.save(a.b)}catch(b){throw"Storage mechanism: Quota exceeded";}};function mg(){cg.call(this,this)}B(mg,cg);mg.prototype.$=function(a){return new ng(a)};mg.prototype.W=function(){return"userdata"};function ng(a){this.b=new jg(a);this.length=this.keys().length}k=ng.prototype;k.length=0;k.clear=function(){this.b.clear();this.a=[]};k.keys=function(){this.a||(this.a=[],Ob(this.b,function(a){this.a.push(a)},this));return this.a};k.key=function(a){return this.keys()[a]};k.setItem=function(a,b){this.a&&this.a.push(a);var c=this.b;c.a.setAttribute(hg(a),b);ig(c)};
k.getItem=function(a){a=this.b.a.getAttribute(hg(a));if(!x(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return q(a)?a:null};k.removeItem=function(a){this.a=null;var b=this.b;b.a.removeAttribute(hg(a));ig(b)};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
nf.prototype.la=function(a){return"localstorage"==a&&window.localStorage?new dg:"sessionstorage"==a&&window.sessionStorage?new eg:"memory"==a?new cg:"userdata"==a?new mg:null};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
nf.prototype.branch=nf.prototype.Fa;nf.prototype.getTxNo=nf.prototype.gb;Oe.prototype.getTxNo=Oe.prototype.fb;nf.prototype.run=nf.prototype.Qa;X.prototype.branch=X.prototype.Fa;X.prototype.add=X.prototype.ja;X.prototype.get=X.prototype.F;X.prototype.keys=X.prototype.keys;X.prototype.values=X.prototype.N;X.prototype.put=X.prototype.R;X.prototype.clear=X.prototype.clear;X.prototype.remove=X.prototype.ka;X.prototype.count=X.prototype.C;W.prototype.add=W.prototype.ja;W.prototype.get=W.prototype.F;W.prototype.keys=W.prototype.keys;W.prototype.values=W.prototype.N;W.prototype.put=W.prototype.R;W.prototype.clear=W.prototype.clear;
W.prototype.remove=W.prototype.ka;W.prototype.count=W.prototype.C;ma("ydn.db.Key",fd);fd.prototype.id=fd.prototype.Ia;fd.prototype.parent=fd.prototype.Va;fd.prototype.storeName=fd.prototype.Wa;ma("ydn.db.KeyRange",R);R.upperBound=R.upperBound;R.lowerBound=R.lowerBound;R.bound=R.bound;R.only=R.only;R.starts=id;bd.prototype.store_name=bd.prototype.m;bd.prototype.getStoreName=bd.prototype.a;function og(a,b,c){X.call(this,a,b,c)}B(og,pf);ma("ydn.db.Storage",og);var pg=new function(){this.a=ka()};var qg=Za("area base br col command embed hr img input keygen link meta param source track wbr".split(" "));function rg(){this.a=sg}rg.prototype.P=!0;rg.prototype.J=function(){return""};rg.prototype.toString=function(){return"Const{}"};function tg(a){if(a instanceof rg&&a.constructor===rg&&a.a===sg)return"";Ha("expected object of type Const, got '"+a+"'");return"type_error:Const"}var sg={};function ug(){this.a="";this.b=vg}ug.prototype.P=!0;var vg={};ug.prototype.J=function(){return this.a};ug.prototype.toString=function(){return"SafeStyle{"+this.a+"}"};function wg(a){var b=new ug;b.a=a;return b}var xg=wg(""),yg=/^[-.%_!# a-zA-Z0-9]+$/;function zg(){this.a=Ag}k=zg.prototype;k.P=!0;k.J=function(){return""};k.oa=!0;k.O=function(){return 1};k.toString=function(){return"SafeUrl{}"};var Ag={};function Bg(){this.a=Cg}k=Bg.prototype;k.P=!0;k.J=function(){return""};k.oa=!0;k.O=function(){return 1};k.toString=function(){return"TrustedResourceUrl{}"};var Cg={};function Dg(){this.a="";this.c=Eg;this.b=null}k=Dg.prototype;k.oa=!0;k.O=function(){return this.b};k.P=!0;k.J=function(){return this.a};k.toString=function(){return"SafeHtml{"+this.a+"}"};function Fg(a){if(a instanceof Dg&&a.constructor===Dg&&a.c===Eg)return a.a;Ha("expected object of type SafeHtml, got '"+a+"'");return"type_error:SafeHtml"}function Gg(a){if(a instanceof Dg)return a;var b=null;a.oa&&(b=a.O());return Hg(sa(a.P?a.J():String(a)),b)}
function Ig(a){if(a instanceof Dg)return a;a=Gg(a);var b;b=Fg(a).replace(/  /g," &#160;").replace(/(\r\n|\r|\n)/g,"<br>");return Hg(b,a.O())}var Jg=/^[a-zA-Z0-9-]+$/,Kg=Za("action","cite","data","formaction","href","manifest","poster","src"),Lg=Za("embed","iframe","link","script","style","template");
function Mg(a,b,c){if(!Jg.test(a))throw Error("Invalid tag name <"+a+">.");if(a.toLowerCase()in Lg)throw Error("Tag name <"+a+"> is not allowed for SafeHtml.");var d=null,e="<"+a;if(b)for(var f in b){if(!Jg.test(f))throw Error('Invalid attribute name "'+f+'".');var g=b[f];if(null!=g){var h,l=a;h=f;if(g instanceof rg)g=tg(g);else if("style"==h.toLowerCase()){if(!z(g))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof g+" given: "+g);if(!(g instanceof
ug)){var l="",n=void 0;for(n in g){if(!/^[-_a-zA-Z0-9]+$/.test(n))throw Error("Name allows only [-_a-zA-Z0-9], got: "+n);var t=g[n];null!=t&&(t instanceof rg?t=tg(t):yg.test(t)||(Ha("String value allows only [-.%_!# a-zA-Z0-9], got: "+t),t="zClosurez"),l+=n+":"+t+";")}g=l?wg(l):xg}g instanceof ug&&g.constructor===ug&&g.b===vg?g=g.a:(Ha("expected object of type SafeStyle, got '"+g+"'"),g="type_error:SafeStyle")}else{if(/^on/i.test(h))throw Error('Attribute "'+h+'" requires goog.string.Const value, "'+
g+'" given.');if(h.toLowerCase()in Kg)if(g instanceof Bg)g instanceof Bg&&g.constructor===Bg&&g.a===Cg?g="":(Ha("expected object of type TrustedResourceUrl, got '"+g+"'"),g="type_error:TrustedResourceUrl");else if(g instanceof zg)g instanceof zg&&g.constructor===zg&&g.a===Ag?g="":(Ha("expected object of type SafeUrl, got '"+g+"'"),g="type_error:SafeUrl");else throw Error('Attribute "'+h+'" on tag "'+l+'" requires goog.html.SafeUrl or goog.string.Const value, "'+g+'" given.');}g.P&&(g=g.J());h=h+'="'+
sa(String(g))+'"';e=e+(" "+h)}}q(c)?u(c)||(c=[c]):c=[];!0===qg[a.toLowerCase()]?e+=">":(d=Ng(c),e+=">"+Fg(d)+"</"+a+">",d=d.O());(a=b&&b.dir)&&(/^(ltr|rtl|auto)$/i.test(a)?d=0:d=null);return Hg(e,d)}function Ng(a){function b(a){u(a)?Ja(a,b):(a=Gg(a),d+=Fg(a),a=a.O(),0==c?c=a:0!=a&&c!=a&&(c=null))}var c=0,d="";Ja(arguments,b);return Hg(d,c)}var Eg={};function Hg(a,b){var c=new Dg;c.a=a;c.b=b;return c}var Og=Hg("",0);function Pg(a){this.e=a||"";this.f=pg}Pg.prototype.c=!0;Pg.prototype.a=!0;Pg.prototype.b=!1;function Qg(a){a=new Date(a.f);return Rg(a.getFullYear()-2E3)+Rg(a.getMonth()+1)+Rg(a.getDate())+" "+Rg(a.getHours())+":"+Rg(a.getMinutes())+":"+Rg(a.getSeconds())+"."+Rg(Math.floor(a.getMilliseconds()/10))}function Rg(a){return 10>a?"0"+a:String(a)}function Sg(a,b){var c=(a.f-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Tg(a){Pg.call(this,a)}B(Tg,Pg);
Tg.prototype.b=!0;Tg.prototype.d=function(a){return a?Ug(this,a).J():""};
function Ug(a,b){var c;switch(b.e.value){case kc.value:c="dbg-sh";break;case lc.value:c="dbg-sev";break;case mc.value:c="dbg-w";break;case nc.value:c="dbg-i";break;default:c="dbg-f"}var d=[];d.push(a.e," ");a.a&&d.push("[",Qg(b),"] ");d.push("[",Sg(b,a.f.a),"s] ");d.push("[",b.c,"] ");var d=Ig(d.join("")),e=Og;a.b&&b.b&&(e=Ng(Mg("br"),Ig(b.a||"")));var f=Ig(b.d);c=Mg("span",{"class":c},Ng(f,e));return a.c?Ng(d,c,Mg("br")):Ng(d,c)}function Vg(a){Pg.call(this,a)}B(Vg,Pg);
Vg.prototype.d=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Qg(a),"] ");b.push("[",Sg(a,this.f.a),"s] ");b.push("[",a.c,"] ");b.push(a.d);this.b&&a.b&&b.push("\n",a.a);this.c&&b.push("\n");return b.join("")};function Wg(){this.e=ha(this.f,this);this.a=new Vg;this.a.a=!1;this.a.b=!1;this.b=this.a.c=!1;this.c="";this.d={}}Wg.prototype.f=function(a){if(!this.d[a.c]){var b=this.a.d(a),c=Xg;if(c)switch(a.e){case kc:Yg(c,"info",b);break;case lc:Yg(c,"error",b);break;case mc:Yg(c,"warn",b);break;default:Yg(c,"debug",b)}else this.c+=b}};var Xg=m.console;function Yg(a,b,c){if(a[b])a[b](c);else a.log(c)};var Zg=!I||I&&9<=bc;!Ub&&!I||I&&I&&9<=bc||Ub&&$b("1.9.1");I&&$b("9");function $g(a,b){Va(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ah?a.setAttribute(ah[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var ah={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function bh(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!w(f)||z(f)&&0<f.nodeType?d(f):Ja(ch(f)?Pa(f):f,d)}}function ch(a){if(a&&"number"==typeof a.length){if(z(a))return"function"==typeof a.item||"string"==typeof a.item;if(ca(a))return"function"==typeof a.item}return!1}function dh(a){this.a=a||m.document||document}
function eh(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
dh.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Zg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',sa(g.name),'"');if(g.type){f.push(' type="',sa(g.type),'"');var h={};Ya(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:u(g)?f.className=g.join(" "):$g(f,g));2<e.length&&bh(d,f,e);return f};
dh.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function fh(a){I&&q(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"}
;function gh(a){this.e=ha(this.f,this);this.b=new Tg;this.c=this.b.a=!1;this.a=a;this.d=this.a.ownerDocument||this.a.document;a=(a=this.a)?new dh(9==a.nodeType?a:a.ownerDocument||a.document):pa||(pa=new dh);var b=null,c=a.a;I&&c.createStyleSheet?(b=c.createStyleSheet(),fh(b)):(c=eh(a,"head")[0],c||(b=eh(a,"body")[0],c=a.b("head"),b.parentNode.insertBefore(c,b)),b=a.b("style"),fh(b),c.appendChild(b));this.a.className+=" logdiv"}
gh.prototype.f=function(a){if(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.d.createElement("div");c.className="logmsg";a=Ug(this.b,a);c.innerHTML=Fg(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)}};gh.prototype.clear=function(){this.a&&(this.a.innerHTML=Fg(Og))};I&&$b("9");!Vb||$b("528");Ub&&$b("1.9b")||I&&$b("8")||Tb&&$b("9.5")||Vb&&$b("528");Ub&&!$b("8")||I&&$b("9");var hh=null,ih=null;J("ydn.debug");ma("ydn.debug.log",function(a,b,c){a=a||"ydn";if(y(b))b=new jc("log",b);else if(x(b)){b=b.toUpperCase();if(!tc){tc={};for(var d=0,e;e=sc[d];d++)tc[e.value]=e,tc[e.name]=e}b=tc[b]||null}else b=pc;(d=J(a))?d.b=b:window.console.log("logger "+a+" not available.");q(c)?!ih&&(a=ih=new gh(c),1!=a.c&&(c=yc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.c=!0),a=yc())&&(a.b=mc):!hh&&!ih&&(a=hh=new Wg,1!=a.b&&(c=yc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.b=!0),a=yc())&&(a.b=mc)});function jh(a,b,c){this.db=a;this.b=b;this.type=c||0;this.c=null};function kh(a){xe.call(this,a)}B(kh,xe);
kh.prototype.c=function(a,b){var c=[],d=b[0];if(null==d)return[];for(var e=!0,f=!1,g=d,h=[],l=1;l<a.length;l++)if(null!=b[l]){var n=Q(d,b[l]);h[l]=n;this.a?-1==n?e=!1:1==n&&(e=!1,f=!0,-1==Q(b[l],g)&&(g=b[l])):1==n?e=!1:-1==n&&(e=!1,f=!0,1==Q(b[l],g)&&(g=b[l]))}else e=!1,f=!0;if(e)for(f=0;f<a.length;f++)null!=b[f]&&(c[f]=!0);else if(f)for(f=0;f<a.length;f++)null!=b[f]&&(this.a?-1==Q(g,b[f])&&(c[f]=g):1==Q(g,b[f])&&(c[f]=g));else for(l=this.a?-1:1,f=1;f<a.length;f++)h[f]===l&&(c[f]=d);return e?(this.b&&
this.b.push(g),c):{continuePrimary:c}};function lh(a){xe.call(this,a)}B(lh,xe);lh.prototype.logger=J("ydn.db.algo.ZigzagMerge");
lh.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}function d(a){return a[a.length-1]}var e=[];if(0==a.length||null==a[0]||null==a[0])return[];for(var f=!0,g=0,h=d(a[g]),l=[],n=1;n<a.length;n++)if(null!=a[n]){var t=d(a[n]),r=Q(h,t);l[n]=r;this.a?-1==r?f=!1:1==r&&(f=!1,h=t,g=1):1==r?f=!1:-1==r&&(f=!1,h=t,g=1)}else return[];n=this.a?-1:1;if(f){for(f=0;f<a.length;f++)null!=a[f]&&(e[f]=!0);this.b&&this.b.push(b[0]);return e}if(0==g)for(f=1;f<a.length;f++)l[f]==
n&&(e[f]=c(a[f],h));else for(f=0;f<a.length;f++)f!=g&&null!=a[f]&&Q(h,d(a[f]))===n&&(e[f]=c(a[f],h));return{"continue":e}};function mh(a,b,c,d){this.c=a;this.a=b||null;this.f=!!c;this.e=!!d;this.b=[];this.d=[]}function nh(a,b){for(var c=b.length-1;0<=c;c--)if(b[c]==a.b[a.b.length-1])b=b.slice(0,c);else break;a.d=b;return null}function oh(a,b){if((0!=a.b.length||0!=a.d.length)&&ph(a)&&!qh(a))throw new ze('Require index "'+a.b.concat(a.d).join(", ")+'" not found in store "'+a.c.getName()+'"');var c=new re(a.c.getName(),rh(a),a.a,a.f,a.e,!!b);c.o=a.b.length;return c}
mh.prototype.clone=function(){var a=new mh(this.c,this.a,this.f,this.e);a.d=this.d.slice();a.b=this.b.slice();return a};function qh(a){var b=a.b.concat(a.d),c=xd(a.c,b);return c||b[b.length-1]==a.c.keyPath&&(c=xd(a.c,b.slice(0,b.length-1)))?c:null}function rh(a){return(a=qh(a))?a.getName():void 0}mh.prototype.reverse=function(){var a=this.clone();a.f=!this.f;return a};function ph(a){return 0<a.b.length?!0:1==a.d.length?a.d[0]!=a.c.keyPath:1<a.d.length?!0:!1}
mh.prototype.sa=function(a,b,c,d,e){c=nd(b,c,d,e);if(0<this.b.length)if(this.a)if(null!=this.a.lower&&null!=this.a.upper&&0==Q(this.a.lower,this.a.upper))a=u(this.a.lower)?this.a.lower.slice().push(b):[this.a.lower,b],d=null!=d?d:"\uffff",c=u(this.a.upper)?this.a.upper.slice().push(d):[this.a.upper,d],this.a=nd(b,a,d,c);else if(1==this.b.length&&this.b[0]==a||u(a)&&Qa(this.b,a))this.a=md(this.a,c);else return"cannot use where clause with existing filter";else return"cannot use where clause with existing filter";
else this.b=u(a)?a:[a],this.a=this.a?md(this.a,c):c;return null};function sh(a,b,c,d){jh.call(this,a,b,c);this.a=d}B(sh,jh);sh.prototype.open=function(){var a={push:function(){}},a=th(this)?new lh(a):new kh(a);return ef(this.db,a,uh(this))};function uh(a){for(var b=[],c=0;c<a.a.length;c++)b[c]=oh(a.a[c]);return b}function th(a){for(var b=0;b<a.a.length;b++)if(0<a.a[b].b.length)return!0;return!1}sh.prototype.na=function(){return this.a.slice()};sh.prototype.select=function(){throw Error("not impl");};
sh.prototype.reverse=function(){var a=this.a.map(function(a){return a.reverse()});return new sh(this.db,this.b,this.type,a)};function Z(a,b,c,d){jh.call(this,a,b,c);this.a=d}B(Z,jh);k=Z.prototype;k.Xa=function(){return new Z(this.db,this.b,this.type,this.a.clone())};k.reverse=function(){var a=this.a.reverse();return new Z(this.db,this.b,this.type,a)};k.$a=function(a){if(!ba(a))throw new H("unique value must be a boolean, but "+typeof a+" found");var b=this.a.clone();b.e=!!a;return new Z(this.db,this.b,this.type,b)};
k.Oa=function(a){var b=x(a)?[a]:a;a=this.a.clone();if(b=nh(a,b))throw Error(b);return new Z(this.db,this.b,this.type,a)};
k.sa=function(a,b,c,d,e){if(rh(this.a)&&rh(this.a)!=a){var f=nd(b,c,d,e),f=new mh(T(this.b,this.a.c.getName()),f,this.a.f,this.a.e),f=(new Z(this.db,this.b,this.type,f)).na().concat(this.na());return new sh(this.db,this.b,this.type,f)}if(!rh(this.a)&&!yd(T(this.b,this.a.c.getName()),a))throw new H('index "'+a+'" not exists in '+this.a.c.getName());f=this.a.clone();if(a=f.sa(a,b,c,d,e))throw new H(a);return new Z(this.db,this.b,this.type,f)};
k.select=function(a){var b=T(this.b,this.a.c.getName()),c=x(a)?[a]:a,d=this.type;a=this.a.clone();d=rh(this.a);if(1==c.length)if(d=c[0],"_ROWID_"==d||d==b.keyPath)d=2;else if(d&&"*"!=d)if(yd(b,d)){if(b=nh(a,c))throw new H(b);d=1}else throw new H('Invalid select "'+d+'", index not found in store "'+b.getName()+'"');else d=4;else if(2==c.length){if(!d)throw new H("Only primary key can be selected for this query.");for(var e=0;2>e;e++){var f;if(f="_ROWID_"!=c[e]){f=b;var g=c[e];f=!(q(f.keyPath)&&(1==
f.d.length?f.keyPath===g:w(g)&&Qa(f.d,g)))}if(f&&c[e]!=d)throw new H('select field name must be "'+d+'", but "'+c[e]+'" found.');}d=3}else throw new H("Selecting more than 2 field names is not supported, but "+c.length+" fields selected.");return new Z(this.db,this.b,d,a)};k.Za=function(a){a=a||100;var b=4,c=vh(this);this.c&&this.c[0]&&(c=ve(c,this.c[0],this.c[1]));if(2==this.type||3==this.type||1==this.type)b=this.type;a=hf(this.db,b,c,a);a.t(function(){"rest"==c.e&&(this.c=[c.i,c.j])},this);return a};
k.na=function(){return[this.a.clone()]};function vh(a){return oh(a.a,!(2==a.type||3==a.type||1==a.type))}
k.Pa=function(a,b){var c=vh(this);c.c&&(c=new re(c.b,c.d,c.a,te(c),ue(c),!1,c.f));if(1>arguments.length)throw new H("too few arguments");if(2==arguments.length){if(!x(a)&&u(a)){if(!u(b))throw new H("an array is expected for second argument but, "+Ld(b)+" of type "+typeof b+" found");if(a.length!=b.length)throw new H("length of two input arguments must be equal but, "+a.length+" and "+b.length+" found");}}else if(1==arguments.length){if(!z(a))throw new H("an object is expected but, "+Ld(a)+" of type "+
typeof a+" found");}else throw new H("too many arguments");var d=this.db.open(function(c){var f=oe(c);if(x(a))Hc(f,a,b);else if(u(a))for(var g=0;g<a.length;g++)Hc(f,a[g],b[g]);else if(z(a))for(g in a)a.hasOwnProperty(g)&&(f[g]=a[g]);g=d;Uf(c.ha,ne(c),f);c=Fb();Ab(g,c)},c,M,this);return d};k.open=function(a,b){return this.db.open(a,vh(this),M,b)};k.Ya=function(){return ph(this.a)?this.a.e?this.db.C(oh(this.a)):this.db.C(this.a.c.getName(),rh(this.a),this.a.a):this.db.C(this.a.c.getName(),this.a.a)};
k.clear=function(){return ph(this.a)?this.db.clear(this.a.c.getName(),rh(this.a),this.a.a):this.db.clear(this.a.c.getName(),this.a.a)};pf.prototype.f=function(a,b,c,d,e){if(!x(a))throw new TypeError('store name "'+a+'"');if(!Sd(this.b,a))throw new H('Store "'+a+'" not found.');var f=null;if(q(b)){if(!q(c))throw new H("boundary value must be defined.");f=nd(b,c,d,e)}else if(q(d))throw new H("second boundary must not be defined.");a=new mh(T(this.b,a),f);return new Z(this.c,this.b,null,a)};
cf.prototype.f=function(a,b,c,d,e){if(!x(a))throw new TypeError('store name "'+a+'"');if(!Sd(this.b,a))throw new H('Store "'+a+'" not found.');var f=null;if(q(b)){if(!q(c))throw new H("boundary value must be defined.");f=nd(b,c,d,e)}else if(q(d))throw new H("second boundary must not be defined.");a=new mh(T(this.b,a),f);return new Z(this,this.b,null,a)};J("ydn.db.query.ConjunctionCursor");Z.prototype.copy=Z.prototype.Xa;Z.prototype.count=Z.prototype.Ya;Z.prototype.list=Z.prototype.Za;Z.prototype.order=Z.prototype.Oa;Z.prototype.patch=Z.prototype.Pa;Z.prototype.reverse=Z.prototype.reverse;Z.prototype.unique=Z.prototype.$a;Z.prototype.where=Z.prototype.sa;pf.prototype.from=pf.prototype.f;cf.prototype.from=cf.prototype.f; 

//# sourceMappingURL=ydn.db-wu-core-qry-dev.js.map
return ydn;}, (this || {}));
            